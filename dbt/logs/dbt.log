[0m04:44:07.386254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab634150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf01510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf015d0>]}


============================== 04:44:07.389220 | 856759e2-7439-42ce-bf88-b491fb9ec7f5 ==============================
[0m04:44:07.389220 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:44:07.389654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/logs', 'profiles_dir': '/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:44:07.436052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa937e450>]}
[0m04:44:07.452161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac6c6290>]}
[0m04:44:07.452502 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:44:07.473160 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:44:07.473621 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m04:44:07.473870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa939bcd0>]}
[0m04:44:07.742384 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m04:44:07.742704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f95510>]}
[0m04:44:07.841317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa1bc850>]}
[0m04:44:07.882575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b57e610>]}
[0m04:44:07.882827 [info ] [MainThread]: Found 8 models, 25 data tests, 428 macros
[0m04:44:07.884290 [info ] [MainThread]: 
[0m04:44:07.884630 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:44:07.886253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m04:44:07.886522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m04:44:07.900341 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m04:44:07.900479 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m04:44:07.900648 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m04:44:07.900913 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m04:44:07.901142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:07.901330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:07.908287 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m04:44:07.908435 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m04:44:07.908970 [debug] [ThreadPool]: On list_threat_risk: Close
[0m04:44:07.909418 [debug] [ThreadPool]: On list_threat_risk: Close
[0m04:44:07.909999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now create_threat_risk_staging_staging)
[0m04:44:07.910157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now create_threat_risk_staging_marts)
[0m04:44:07.910373 [debug] [ThreadPool]: Creating schema "database: "threat_risk"
schema: "staging_staging"
"
[0m04:44:07.910610 [debug] [ThreadPool]: Creating schema "database: "threat_risk"
schema: "staging_marts"
"
[0m04:44:07.912639 [debug] [ThreadPool]: Using postgres connection "create_threat_risk_staging_staging"
[0m04:44:07.913367 [debug] [ThreadPool]: Using postgres connection "create_threat_risk_staging_marts"
[0m04:44:07.913578 [debug] [ThreadPool]: On create_threat_risk_staging_staging: BEGIN
[0m04:44:07.913765 [debug] [ThreadPool]: On create_threat_risk_staging_marts: BEGIN
[0m04:44:07.913980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:07.914144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:07.917871 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:44:07.918007 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:44:07.918173 [debug] [ThreadPool]: Using postgres connection "create_threat_risk_staging_staging"
[0m04:44:07.918324 [debug] [ThreadPool]: Using postgres connection "create_threat_risk_staging_marts"
[0m04:44:07.918503 [debug] [ThreadPool]: On create_threat_risk_staging_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "create_threat_risk_staging_staging"} */
create schema if not exists "staging_staging"
[0m04:44:07.918670 [debug] [ThreadPool]: On create_threat_risk_staging_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "create_threat_risk_staging_marts"} */
create schema if not exists "staging_marts"
[0m04:44:07.919352 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m04:44:07.919453 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m04:44:07.919876 [debug] [ThreadPool]: On create_threat_risk_staging_staging: COMMIT
[0m04:44:07.920212 [debug] [ThreadPool]: On create_threat_risk_staging_marts: COMMIT
[0m04:44:07.920397 [debug] [ThreadPool]: Using postgres connection "create_threat_risk_staging_staging"
[0m04:44:07.920561 [debug] [ThreadPool]: Using postgres connection "create_threat_risk_staging_marts"
[0m04:44:07.920762 [debug] [ThreadPool]: On create_threat_risk_staging_staging: COMMIT
[0m04:44:07.920920 [debug] [ThreadPool]: On create_threat_risk_staging_marts: COMMIT
[0m04:44:07.921654 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m04:44:07.921810 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m04:44:07.921968 [debug] [ThreadPool]: On create_threat_risk_staging_staging: Close
[0m04:44:07.922138 [debug] [ThreadPool]: On create_threat_risk_staging_marts: Close
[0m04:44:07.923191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_threat_risk_staging_staging, now list_threat_risk_staging_staging)
[0m04:44:07.923396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_threat_risk_staging_marts, now list_threat_risk_staging_marts)
[0m04:44:07.925662 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging_staging"
[0m04:44:07.926374 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging_marts"
[0m04:44:07.926553 [debug] [ThreadPool]: On list_threat_risk_staging_staging: BEGIN
[0m04:44:07.926715 [debug] [ThreadPool]: On list_threat_risk_staging_marts: BEGIN
[0m04:44:07.926892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:07.927057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:07.930707 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:44:07.930919 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging_marts"
[0m04:44:07.931091 [debug] [ThreadPool]: On list_threat_risk_staging_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m04:44:07.931385 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:44:07.931547 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging_staging"
[0m04:44:07.931726 [debug] [ThreadPool]: On list_threat_risk_staging_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m04:44:07.933342 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m04:44:07.933454 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m04:44:07.933967 [debug] [ThreadPool]: On list_threat_risk_staging_staging: ROLLBACK
[0m04:44:07.934367 [debug] [ThreadPool]: On list_threat_risk_staging_marts: ROLLBACK
[0m04:44:07.934599 [debug] [ThreadPool]: On list_threat_risk_staging_staging: Close
[0m04:44:07.934815 [debug] [ThreadPool]: On list_threat_risk_staging_marts: Close
[0m04:44:07.937049 [debug] [MainThread]: Using postgres connection "master"
[0m04:44:07.937223 [debug] [MainThread]: On master: BEGIN
[0m04:44:07.937365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:44:07.940148 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m04:44:07.940305 [debug] [MainThread]: Using postgres connection "master"
[0m04:44:07.940469 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:44:07.942426 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m04:44:07.942842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab06cb90>]}
[0m04:44:07.943038 [debug] [MainThread]: On master: ROLLBACK
[0m04:44:07.943236 [debug] [MainThread]: Using postgres connection "master"
[0m04:44:07.943369 [debug] [MainThread]: On master: BEGIN
[0m04:44:07.943622 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:44:07.943801 [debug] [MainThread]: On master: COMMIT
[0m04:44:07.943936 [debug] [MainThread]: Using postgres connection "master"
[0m04:44:07.944067 [debug] [MainThread]: On master: COMMIT
[0m04:44:07.944254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:44:07.944389 [debug] [MainThread]: On master: Close
[0m04:44:07.944597 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:44:07.944800 [info ] [MainThread]: 
[0m04:44:07.949050 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_date
[0m04:44:07.949202 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_product
[0m04:44:07.949337 [debug] [Thread-3 (]: Began running node model.threat_risk.dim_url
[0m04:44:07.949483 [debug] [Thread-4 (]: Began running node model.threat_risk.dim_vendor
[0m04:44:07.949665 [info ] [Thread-1 (]: 1 of 33 START sql table model staging_marts.dim_date ........................... [RUN]
[0m04:44:07.949993 [info ] [Thread-2 (]: 2 of 33 START sql table model staging_marts.dim_product ........................ [RUN]
[0m04:44:07.950372 [info ] [Thread-3 (]: 3 of 33 START sql table model staging_marts.dim_url ............................ [RUN]
[0m04:44:07.950735 [info ] [Thread-4 (]: 4 of 33 START sql table model staging_marts.dim_vendor ......................... [RUN]
[0m04:44:07.951128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging_marts, now model.threat_risk.dim_date)
[0m04:44:07.951367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging_staging, now model.threat_risk.dim_product)
[0m04:44:07.951615 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.threat_risk.dim_url'
[0m04:44:07.952474 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.threat_risk.dim_vendor'
[0m04:44:07.952675 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_date
[0m04:44:07.952964 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_product
[0m04:44:07.953156 [debug] [Thread-3 (]: Began compiling node model.threat_risk.dim_url
[0m04:44:07.953353 [debug] [Thread-4 (]: Began compiling node model.threat_risk.dim_vendor
[0m04:44:07.955651 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_date"
[0m04:44:07.956411 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_product"
[0m04:44:07.957110 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.dim_url"
[0m04:44:07.957796 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.dim_vendor"
[0m04:44:07.959266 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_date
[0m04:44:07.966185 [debug] [Thread-3 (]: Began executing node model.threat_risk.dim_url
[0m04:44:07.972861 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.dim_date"
[0m04:44:07.974038 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.dim_url"
[0m04:44:07.974249 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_product
[0m04:44:07.974167 [debug] [Thread-4 (]: Began executing node model.threat_risk.dim_vendor
[0m04:44:07.975454 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.dim_product"
[0m04:44:07.976576 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.dim_vendor"
[0m04:44:07.977274 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_date"
[0m04:44:07.977442 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_url"
[0m04:44:07.977596 [debug] [Thread-1 (]: On model.threat_risk.dim_date: BEGIN
[0m04:44:07.978146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:07.977886 [debug] [Thread-3 (]: On model.threat_risk.dim_url: BEGIN
[0m04:44:07.978019 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m04:44:07.977795 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m04:44:07.978419 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:44:07.978893 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: BEGIN
[0m04:44:07.979179 [debug] [Thread-2 (]: On model.threat_risk.dim_product: BEGIN
[0m04:44:07.979611 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:44:07.979862 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:44:07.986229 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m04:44:07.986405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:44:07.986811 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_date"
[0m04:44:07.986622 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_url"
[0m04:44:07.987475 [debug] [Thread-3 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */

  
    

  create  table "threat_risk"."staging_marts"."dim_url__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  url,
  host
from (
  select distinct url, host
  from staging.stg_urlhaus
  where url is not null
) u
  );
  
[0m04:44:07.987201 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m04:44:07.987321 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m04:44:07.987063 [debug] [Thread-1 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */

  
    

  create  table "threat_risk"."staging_marts"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with dates as (
  select distinct run_date as d from staging.stg_kev
  union
  select distinct run_date as d from staging.stg_urlhaus
),
final as (
  select
    d as date_day,
    extract(year from d)::int as year,
    extract(month from d)::int as month,
    extract(day from d)::int as day
  from dates
)
select * from final
  );
  
[0m04:44:07.987742 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m04:44:07.987992 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "staging.stg_urlhaus" does not exist
LINE 18:   from staging.stg_urlhaus
                ^

[0m04:44:07.988211 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m04:44:07.988495 [debug] [Thread-2 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */

  
    

  create  table "threat_risk"."staging_marts"."dim_product__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  md5(coalesce(vendor_project,'')) as vendor_key,
  vendor_project,
  product
from (
  select distinct vendor_project, product
  from staging.stg_kev
  where vendor_project is not null and product is not null
) p
  );
  
[0m04:44:07.988641 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.stg_kev" does not exist
LINE 13:   select distinct run_date as d from staging.stg_kev
                                              ^

[0m04:44:07.989259 [debug] [Thread-1 (]: On model.threat_risk.dim_date: ROLLBACK
[0m04:44:07.989005 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */

  
    

  create  table "threat_risk"."staging_marts"."dim_vendor__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project, '')) as vendor_key,
  vendor_project
from (
  select distinct vendor_project
  from staging.stg_kev
  where vendor_project is not null
) v
  );
  
[0m04:44:07.988812 [debug] [Thread-3 (]: On model.threat_risk.dim_url: ROLLBACK
[0m04:44:07.989374 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "staging.stg_kev" does not exist
LINE 19:   from staging.stg_kev
                ^

[0m04:44:07.989630 [debug] [Thread-1 (]: On model.threat_risk.dim_date: Close
[0m04:44:07.989932 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "staging.stg_kev" does not exist
LINE 17:   from staging.stg_kev
                ^

[0m04:44:07.990108 [debug] [Thread-3 (]: On model.threat_risk.dim_url: Close
[0m04:44:07.990275 [debug] [Thread-2 (]: On model.threat_risk.dim_product: ROLLBACK
[0m04:44:07.991070 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: ROLLBACK
[0m04:44:07.991971 [debug] [Thread-1 (]: Database Error in model dim_date (models/marts/dim_date.sql)
  relation "staging.stg_kev" does not exist
  LINE 13:   select distinct run_date as d from staging.stg_kev
                                                ^
  compiled code at target/run/threat_risk/models/marts/dim_date.sql
[0m04:44:07.992886 [debug] [Thread-3 (]: Database Error in model dim_url (models/marts/dim_url.sql)
  relation "staging.stg_urlhaus" does not exist
  LINE 18:   from staging.stg_urlhaus
                  ^
  compiled code at target/run/threat_risk/models/marts/dim_url.sql
[0m04:44:07.993104 [debug] [Thread-2 (]: On model.threat_risk.dim_product: Close
[0m04:44:07.993379 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: Close
[0m04:44:07.993993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a072d90>]}
[0m04:44:07.994180 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a07fb90>]}
[0m04:44:07.995113 [debug] [Thread-2 (]: Database Error in model dim_product (models/marts/dim_product.sql)
  relation "staging.stg_kev" does not exist
  LINE 19:   from staging.stg_kev
                  ^
  compiled code at target/run/threat_risk/models/marts/dim_product.sql
[0m04:44:07.995979 [debug] [Thread-4 (]: Database Error in model dim_vendor (models/marts/dim_vendor.sql)
  relation "staging.stg_kev" does not exist
  LINE 17:   from staging.stg_kev
                  ^
  compiled code at target/run/threat_risk/models/marts/dim_vendor.sql
[0m04:44:07.996205 [error] [Thread-1 (]: 1 of 33 ERROR creating sql table model staging_marts.dim_date .................. [[31mERROR[0m in 0.04s]
[0m04:44:07.997465 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_date
[0m04:44:07.996934 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a012850>]}
[0m04:44:07.997201 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99faf550>]}
[0m04:44:07.996604 [error] [Thread-3 (]: 3 of 33 ERROR creating sql table model staging_marts.dim_url ................... [[31mERROR[0m in 0.04s]
[0m04:44:07.997669 [debug] [Thread-1 (]: Began running node model.threat_risk.fact_kev
[0m04:44:07.998192 [error] [Thread-2 (]: 2 of 33 ERROR creating sql table model staging_marts.dim_product ............... [[31mERROR[0m in 0.05s]
[0m04:44:07.998562 [error] [Thread-4 (]: 4 of 33 ERROR creating sql table model staging_marts.dim_vendor ................ [[31mERROR[0m in 0.05s]
[0m04:44:07.998873 [debug] [Thread-3 (]: Finished running node model.threat_risk.dim_url
[0m04:44:07.999066 [info ] [Thread-1 (]: 5 of 33 START sql table model staging_marts.fact_kev ........................... [RUN]
[0m04:44:07.999357 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_product
[0m04:44:07.999593 [debug] [Thread-4 (]: Finished running node model.threat_risk.dim_vendor
[0m04:44:07.999799 [debug] [Thread-3 (]: Began running node model.threat_risk.fact_url_events
[0m04:44:08.001061 [info ] [Thread-3 (]: 6 of 33 START sql table model staging_marts.fact_url_events .................... [RUN]
[0m04:44:08.000428 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_kev
[0m04:44:08.000755 [debug] [Thread-4 (]: Began running node model.threat_risk.stg_urlhaus
[0m04:44:08.000186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_date, now model.threat_risk.fact_kev)
[0m04:44:08.001300 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_url, now model.threat_risk.fact_url_events)
[0m04:44:08.001565 [info ] [Thread-2 (]: 7 of 33 START sql view model staging_staging.stg_kev ........................... [RUN]
[0m04:44:08.001882 [info ] [Thread-4 (]: 8 of 33 START sql view model staging_staging.stg_urlhaus ....................... [RUN]
[0m04:44:08.002200 [debug] [Thread-1 (]: Began compiling node model.threat_risk.fact_kev
[0m04:44:08.002358 [debug] [Thread-3 (]: Began compiling node model.threat_risk.fact_url_events
[0m04:44:08.002556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_product, now model.threat_risk.stg_kev)
[0m04:44:08.002765 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_vendor, now model.threat_risk.stg_urlhaus)
[0m04:44:08.003635 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.fact_kev"
[0m04:44:08.004257 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.fact_url_events"
[0m04:44:08.004452 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_kev
[0m04:44:08.004644 [debug] [Thread-4 (]: Began compiling node model.threat_risk.stg_urlhaus
[0m04:44:08.006578 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_kev"
[0m04:44:08.006836 [debug] [Thread-1 (]: Began executing node model.threat_risk.fact_kev
[0m04:44:08.007417 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus"
[0m04:44:08.007613 [debug] [Thread-3 (]: Began executing node model.threat_risk.fact_url_events
[0m04:44:08.008758 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.fact_kev"
[0m04:44:08.010122 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.fact_url_events"
[0m04:44:08.010335 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_kev
[0m04:44:08.010497 [debug] [Thread-4 (]: Began executing node model.threat_risk.stg_urlhaus
[0m04:44:08.017017 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.stg_kev"
[0m04:44:08.017211 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m04:44:08.018504 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.stg_urlhaus"
[0m04:44:08.018654 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m04:44:08.018933 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: BEGIN
[0m04:44:08.019302 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: BEGIN
[0m04:44:08.019998 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:44:08.019653 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m04:44:08.019809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:08.019540 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m04:44:08.020280 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: BEGIN
[0m04:44:08.020701 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: BEGIN
[0m04:44:08.020893 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:44:08.021074 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:44:08.023892 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m04:44:08.024958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m04:44:08.026737 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m04:44:08.027812 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m04:44:08.028009 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */

  
    

  create  table "threat_risk"."staging_marts"."fact_url_events__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  run_date as date_day,
  url_status,
  threat,
  tags,
  date_added,
  reporter,
  larted
from staging.stg_urlhaus
where url is not null
  );
  
[0m04:44:08.028224 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */

  
    

  create  table "threat_risk"."staging_marts"."fact_kev__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(cve_id,'')) as cve_key,
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  run_date as date_day,
  cve_id,
  vulnerability_name,
  date_added,
  due_date,
  required_action,
  notes
from staging.stg_kev
where cve_id is not null
  );
  
[0m04:44:08.028561 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "staging.stg_urlhaus" does not exist
LINE 21: from staging.stg_urlhaus
              ^

[0m04:44:08.028726 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.stg_kev" does not exist
LINE 22: from staging.stg_kev
              ^

[0m04:44:08.028911 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: ROLLBACK
[0m04:44:08.029042 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m04:44:08.029196 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: ROLLBACK
[0m04:44:08.029446 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m04:44:08.030087 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m04:44:08.029723 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m04:44:08.029979 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: Close
[0m04:44:08.029572 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: Close
[0m04:44:08.030252 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */

  create view "threat_risk"."staging_staging"."stg_urlhaus__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.urlhaus_recent
),
clean as (
  select
    nullif(trim(url), '') as url,
    nullif(trim(url_status), '') as url_status,
    nullif(trim(host), '') as host,
    date_added,
    nullif(trim(threat), '') as threat,
    nullif(trim(tags), '') as tags,
    nullif(trim(urlhaus_link), '') as urlhaus_link,
    nullif(trim(reporter), '') as reporter,
    larted,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m04:44:08.030452 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */

  create view "threat_risk"."staging_staging"."stg_kev__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.kev
),
clean as (
  select
    nullif(trim(cve_id), '') as cve_id,
    nullif(trim(vendor_project), '') as vendor_project,
    nullif(trim(product), '') as product,
    nullif(trim(vulnerability_name), '') as vulnerability_name,
    date_added,
    short_description,
    required_action,
    due_date,
    notes,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m04:44:08.031847 [debug] [Thread-1 (]: Database Error in model fact_kev (models/marts/fact_kev.sql)
  relation "staging.stg_kev" does not exist
  LINE 22: from staging.stg_kev
                ^
  compiled code at target/run/threat_risk/models/marts/fact_kev.sql
[0m04:44:08.032333 [debug] [Thread-3 (]: Database Error in model fact_url_events (models/marts/fact_url_events.sql)
  relation "staging.stg_urlhaus" does not exist
  LINE 21: from staging.stg_urlhaus
                ^
  compiled code at target/run/threat_risk/models/marts/fact_url_events.sql
[0m04:44:08.032846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa452910>]}
[0m04:44:08.033086 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1000d0>]}
[0m04:44:08.033445 [error] [Thread-1 (]: 5 of 33 ERROR creating sql table model staging_marts.fact_kev .................. [[31mERROR[0m in 0.03s]
[0m04:44:08.033831 [error] [Thread-3 (]: 6 of 33 ERROR creating sql table model staging_marts.fact_url_events ........... [[31mERROR[0m in 0.03s]
[0m04:44:08.034221 [debug] [Thread-1 (]: Finished running node model.threat_risk.fact_kev
[0m04:44:08.034392 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m04:44:08.034551 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m04:44:08.034719 [debug] [Thread-3 (]: Finished running node model.threat_risk.fact_url_events
[0m04:44:08.034970 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m04:44:08.037472 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m04:44:08.038508 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m04:44:08.038721 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m04:44:08.039094 [info ] [Thread-1 (]: 9 of 33 SKIP test not_null_dim_url_url ......................................... [[33mSKIP[0m]
[0m04:44:08.039518 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging_staging"."stg_kev__dbt_tmp" rename to "stg_kev"
[0m04:44:08.039740 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging_staging"."stg_urlhaus__dbt_tmp" rename to "stg_urlhaus"
[0m04:44:08.039932 [info ] [Thread-3 (]: 10 of 33 SKIP test not_null_dim_url_url_key .................................... [[33mSKIP[0m]
[0m04:44:08.040228 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m04:44:08.040645 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m04:44:08.040819 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:44:08.040967 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:44:08.041177 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m04:44:08.041441 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m04:44:08.046444 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: COMMIT
[0m04:44:08.046972 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m04:44:08.047193 [info ] [Thread-1 (]: 11 of 33 SKIP test unique_dim_url_url .......................................... [[33mSKIP[0m]
[0m04:44:08.047467 [info ] [Thread-3 (]: 12 of 33 SKIP test unique_dim_url_url_key ...................................... [[33mSKIP[0m]
[0m04:44:08.047734 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m04:44:08.047937 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m04:44:08.048147 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m04:44:08.048338 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m04:44:08.048532 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: COMMIT
[0m04:44:08.048711 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m04:44:08.048950 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m04:44:08.049194 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m04:44:08.049641 [info ] [Thread-1 (]: 13 of 33 SKIP test not_null_dim_product_product ................................ [[33mSKIP[0m]
[0m04:44:08.049979 [info ] [Thread-3 (]: 14 of 33 SKIP test not_null_dim_product_product_key ............................ [[33mSKIP[0m]
[0m04:44:08.050163 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m04:44:08.050319 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m04:44:08.050488 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m04:44:08.050689 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m04:44:08.053050 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."staging_staging"."stg_kev__dbt_backup"
[0m04:44:08.054597 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."staging_staging"."stg_urlhaus__dbt_backup"
[0m04:44:08.054822 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m04:44:08.055030 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m04:44:08.056704 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m04:44:08.056967 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m04:44:08.057176 [info ] [Thread-1 (]: 15 of 33 SKIP test not_null_dim_product_vendor_key ............................. [[33mSKIP[0m]
[0m04:44:08.057438 [info ] [Thread-3 (]: 16 of 33 SKIP test not_null_dim_product_vendor_project ......................... [[33mSKIP[0m]
[0m04:44:08.057676 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
drop view if exists "threat_risk"."staging_staging"."stg_kev__dbt_backup" cascade
[0m04:44:08.057871 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
drop view if exists "threat_risk"."staging_staging"."stg_urlhaus__dbt_backup" cascade
[0m04:44:08.058073 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m04:44:08.058234 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m04:44:08.058539 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m04:44:08.058701 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m04:44:08.058837 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m04:44:08.059026 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m04:44:08.059964 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: Close
[0m04:44:08.060457 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: Close
[0m04:44:08.060663 [info ] [Thread-1 (]: 17 of 33 SKIP test unique_dim_product_product_key .............................. [[33mSKIP[0m]
[0m04:44:08.060944 [info ] [Thread-3 (]: 18 of 33 SKIP test not_null_dim_vendor_vendor_key .............................. [[33mSKIP[0m]
[0m04:44:08.061340 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8fa7dd0>]}
[0m04:44:08.061605 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856759e2-7439-42ce-bf88-b491fb9ec7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a25dc10>]}
[0m04:44:08.061799 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m04:44:08.062012 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m04:44:08.062353 [info ] [Thread-2 (]: 7 of 33 OK created sql view model staging_staging.stg_kev ...................... [[32mCREATE VIEW[0m in 0.06s]
[0m04:44:08.062714 [info ] [Thread-4 (]: 8 of 33 OK created sql view model staging_staging.stg_urlhaus .................. [[32mCREATE VIEW[0m in 0.06s]
[0m04:44:08.063033 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m04:44:08.063272 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m04:44:08.063538 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_kev
[0m04:44:08.063798 [debug] [Thread-4 (]: Finished running node model.threat_risk.stg_urlhaus
[0m04:44:08.064018 [info ] [Thread-1 (]: 19 of 33 SKIP test not_null_dim_vendor_vendor_project .......................... [[33mSKIP[0m]
[0m04:44:08.064271 [info ] [Thread-3 (]: 20 of 33 SKIP test unique_dim_vendor_vendor_key ................................ [[33mSKIP[0m]
[0m04:44:08.064566 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m04:44:08.064865 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m04:44:08.065158 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m04:44:08.065346 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m04:44:08.065550 [info ] [Thread-2 (]: 21 of 33 SKIP test unique_dim_vendor_vendor_project ............................ [[33mSKIP[0m]
[0m04:44:08.065847 [info ] [Thread-4 (]: 22 of 33 SKIP test not_null_fact_kev_cve_id .................................... [[33mSKIP[0m]
[0m04:44:08.066110 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m04:44:08.066334 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m04:44:08.066552 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m04:44:08.066734 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m04:44:08.066958 [info ] [Thread-1 (]: 23 of 33 SKIP test not_null_fact_kev_date_day .................................. [[33mSKIP[0m]
[0m04:44:08.067221 [info ] [Thread-3 (]: 24 of 33 SKIP test not_null_fact_url_events_date_day ........................... [[33mSKIP[0m]
[0m04:44:08.067495 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m04:44:08.067726 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m04:44:08.067962 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m04:44:08.068144 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m04:44:08.068344 [info ] [Thread-2 (]: 25 of 33 SKIP test not_null_fact_url_events_url_key ............................ [[33mSKIP[0m]
[0m04:44:08.068577 [info ] [Thread-4 (]: 26 of 33 START test not_null_stg_kev_cve_id .................................... [RUN]
[0m04:44:08.068899 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m04:44:08.069137 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m04:44:08.069359 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m04:44:08.069557 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus, now test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0)
[0m04:44:08.069787 [info ] [Thread-1 (]: 27 of 33 START test not_null_stg_kev_product ................................... [RUN]
[0m04:44:08.070071 [info ] [Thread-3 (]: 28 of 33 START test not_null_stg_kev_run_date .................................. [RUN]
[0m04:44:08.070382 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m04:44:08.070616 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m04:44:08.070850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_kev, now test.threat_risk.not_null_stg_kev_product.9b2d2b4877)
[0m04:44:08.071033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_url_events, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m04:44:08.071240 [info ] [Thread-2 (]: 29 of 33 START test not_null_stg_kev_vendor_project ............................ [RUN]
[0m04:44:08.074456 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m04:44:08.074665 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m04:44:08.074853 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m04:44:08.075079 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_kev, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m04:44:08.076574 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m04:44:08.078050 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m04:44:08.078401 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m04:44:08.078576 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m04:44:08.080359 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m04:44:08.080547 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m04:44:08.086372 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m04:44:08.086800 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m04:44:08.088471 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m04:44:08.088723 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m04:44:08.089779 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m04:44:08.090795 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m04:44:08.090942 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m04:44:08.091228 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m04:44:08.091780 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m04:44:08.091688 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m04:44:08.091509 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m04:44:08.091939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:08.092058 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m04:44:08.092222 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m04:44:08.092382 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:44:08.092710 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m04:44:08.092991 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:44:08.093334 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:44:08.101332 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m04:44:08.101493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m04:44:08.101725 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m04:44:08.101865 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m04:44:08.102001 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m04:44:08.102117 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m04:44:08.102282 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging_staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m04:44:08.102445 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m04:44:08.102580 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m04:44:08.102761 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging_staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m04:44:08.103091 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging_staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m04:44:08.103277 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging_staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m04:44:08.104787 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:44:08.104928 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:44:08.105047 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:44:08.105162 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:44:08.106564 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m04:44:08.107031 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m04:44:08.107553 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m04:44:08.108054 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m04:44:08.108314 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m04:44:08.108503 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m04:44:08.108708 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m04:44:08.108902 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m04:44:08.109142 [info ] [Thread-4 (]: 26 of 33 PASS not_null_stg_kev_cve_id .......................................... [[32mPASS[0m in 0.04s]
[0m04:44:08.109638 [info ] [Thread-3 (]: 28 of 33 PASS not_null_stg_kev_run_date ........................................ [[32mPASS[0m in 0.04s]
[0m04:44:08.110029 [info ] [Thread-2 (]: 29 of 33 PASS not_null_stg_kev_vendor_project .................................. [[32mPASS[0m in 0.03s]
[0m04:44:08.110430 [info ] [Thread-1 (]: 27 of 33 PASS not_null_stg_kev_product ......................................... [[32mPASS[0m in 0.04s]
[0m04:44:08.110779 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m04:44:08.111048 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m04:44:08.111322 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m04:44:08.111584 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m04:44:08.111803 [debug] [Thread-4 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m04:44:08.112057 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m04:44:08.112287 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m04:44:08.112512 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m04:44:08.112752 [info ] [Thread-4 (]: 30 of 33 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m04:44:08.112999 [info ] [Thread-3 (]: 31 of 33 START test not_null_stg_urlhaus_run_date .............................. [RUN]
[0m04:44:08.113313 [info ] [Thread-2 (]: 32 of 33 START test not_null_stg_urlhaus_url ................................... [RUN]
[0m04:44:08.113582 [info ] [Thread-1 (]: 33 of 33 START test not_null_stg_urlhaus_url_status ............................ [RUN]
[0m04:44:08.113941 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41)
[0m04:44:08.114762 [debug] [Thread-4 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m04:44:08.114361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m04:44:08.114576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m04:44:08.114129 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93)
[0m04:44:08.117179 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m04:44:08.116797 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m04:44:08.117010 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m04:44:08.116574 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m04:44:08.118508 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m04:44:08.120839 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m04:44:08.122248 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m04:44:08.122928 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m04:44:08.123085 [debug] [Thread-4 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m04:44:08.123830 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m04:44:08.123944 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m04:44:08.124754 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m04:44:08.124899 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m04:44:08.125732 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m04:44:08.125987 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m04:44:08.126853 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m04:44:08.127092 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m04:44:08.127252 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m04:44:08.127506 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m04:44:08.127675 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m04:44:08.128294 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:44:08.128052 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m04:44:08.128154 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m04:44:08.127879 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:44:08.128580 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m04:44:08.128821 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:44:08.129155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:08.135400 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m04:44:08.135585 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m04:44:08.135721 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m04:44:08.135885 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging_staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m04:44:08.136111 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m04:44:08.136372 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging_staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m04:44:08.136842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:44:08.137003 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m04:44:08.137179 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m04:44:08.137366 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m04:44:08.137528 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging_staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m04:44:08.137733 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging_staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m04:44:08.137931 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:44:08.138054 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:44:08.138838 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m04:44:08.139385 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m04:44:08.139529 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:44:08.140321 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m04:44:08.139890 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m04:44:08.139731 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m04:44:08.140439 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:44:08.140630 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m04:44:08.140861 [info ] [Thread-3 (]: 31 of 33 PASS not_null_stg_urlhaus_run_date .................................... [[32mPASS[0m in 0.03s]
[0m04:44:08.141193 [info ] [Thread-4 (]: 30 of 33 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown . [[32mPASS[0m in 0.03s]
[0m04:44:08.141858 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m04:44:08.142157 [error] [Thread-1 (]: 33 of 33 FAIL 21926 not_null_stg_urlhaus_url_status ............................ [[31mFAIL 21926[0m in 0.03s]
[0m04:44:08.142448 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m04:44:08.142730 [debug] [Thread-4 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m04:44:08.143044 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m04:44:08.143217 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m04:44:08.143781 [error] [Thread-2 (]: 32 of 33 FAIL 21926 not_null_stg_urlhaus_url ................................... [[31mFAIL 21926[0m in 0.03s]
[0m04:44:08.144232 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m04:44:08.145048 [debug] [MainThread]: Using postgres connection "master"
[0m04:44:08.145209 [debug] [MainThread]: On master: BEGIN
[0m04:44:08.145346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:44:08.148487 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m04:44:08.148649 [debug] [MainThread]: On master: COMMIT
[0m04:44:08.148802 [debug] [MainThread]: Using postgres connection "master"
[0m04:44:08.148954 [debug] [MainThread]: On master: COMMIT
[0m04:44:08.149149 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:44:08.149286 [debug] [MainThread]: On master: Close
[0m04:44:08.149461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:44:08.149610 [debug] [MainThread]: Connection 'test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd' was properly closed.
[0m04:44:08.149754 [debug] [MainThread]: Connection 'test.threat_risk.not_null_stg_urlhaus_url.8004f29367' was properly closed.
[0m04:44:08.149896 [debug] [MainThread]: Connection 'test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93' was properly closed.
[0m04:44:08.150037 [debug] [MainThread]: Connection 'test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41' was properly closed.
[0m04:44:08.150287 [info ] [MainThread]: 
[0m04:44:08.150458 [info ] [MainThread]: Finished running 6 table models, 25 data tests, 2 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m04:44:08.151444 [debug] [MainThread]: Command end result
[0m04:44:08.166453 [info ] [MainThread]: 
[0m04:44:08.166693 [info ] [MainThread]: [31mCompleted with 8 errors and 0 warnings:[0m
[0m04:44:08.166946 [info ] [MainThread]: 
[0m04:44:08.167278 [error] [MainThread]:   Database Error in model dim_date (models/marts/dim_date.sql)
  relation "staging.stg_kev" does not exist
  LINE 13:   select distinct run_date as d from staging.stg_kev
                                                ^
  compiled code at target/run/threat_risk/models/marts/dim_date.sql
[0m04:44:08.167471 [info ] [MainThread]: 
[0m04:44:08.167734 [error] [MainThread]:   Database Error in model dim_url (models/marts/dim_url.sql)
  relation "staging.stg_urlhaus" does not exist
  LINE 18:   from staging.stg_urlhaus
                  ^
  compiled code at target/run/threat_risk/models/marts/dim_url.sql
[0m04:44:08.167932 [info ] [MainThread]: 
[0m04:44:08.168160 [error] [MainThread]:   Database Error in model dim_product (models/marts/dim_product.sql)
  relation "staging.stg_kev" does not exist
  LINE 19:   from staging.stg_kev
                  ^
  compiled code at target/run/threat_risk/models/marts/dim_product.sql
[0m04:44:08.168312 [info ] [MainThread]: 
[0m04:44:08.168524 [error] [MainThread]:   Database Error in model dim_vendor (models/marts/dim_vendor.sql)
  relation "staging.stg_kev" does not exist
  LINE 17:   from staging.stg_kev
                  ^
  compiled code at target/run/threat_risk/models/marts/dim_vendor.sql
[0m04:44:08.168657 [info ] [MainThread]: 
[0m04:44:08.168860 [error] [MainThread]:   Database Error in model fact_kev (models/marts/fact_kev.sql)
  relation "staging.stg_kev" does not exist
  LINE 22: from staging.stg_kev
                ^
  compiled code at target/run/threat_risk/models/marts/fact_kev.sql
[0m04:44:08.169045 [info ] [MainThread]: 
[0m04:44:08.169264 [error] [MainThread]:   Database Error in model fact_url_events (models/marts/fact_url_events.sql)
  relation "staging.stg_urlhaus" does not exist
  LINE 21: from staging.stg_urlhaus
                ^
  compiled code at target/run/threat_risk/models/marts/fact_url_events.sql
[0m04:44:08.169426 [info ] [MainThread]: 
[0m04:44:08.169614 [error] [MainThread]: [31mFailure in test not_null_stg_urlhaus_url_status (models/staging/schema.yml)[0m
[0m04:44:08.169809 [error] [MainThread]:   Got 21926 results, configured to fail if != 0
[0m04:44:08.169946 [info ] [MainThread]: 
[0m04:44:08.170183 [info ] [MainThread]:   compiled code at target/compiled/threat_risk/models/staging/schema.yml/not_null_stg_urlhaus_url_status.sql
[0m04:44:08.170400 [info ] [MainThread]: 
[0m04:44:08.170606 [error] [MainThread]: [31mFailure in test not_null_stg_urlhaus_url (models/staging/schema.yml)[0m
[0m04:44:08.170772 [error] [MainThread]:   Got 21926 results, configured to fail if != 0
[0m04:44:08.170924 [info ] [MainThread]: 
[0m04:44:08.171160 [info ] [MainThread]:   compiled code at target/compiled/threat_risk/models/staging/schema.yml/not_null_stg_urlhaus_url.sql
[0m04:44:08.171320 [info ] [MainThread]: 
[0m04:44:08.171524 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=8 SKIP=17 TOTAL=33
[0m04:44:08.172015 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.80304784, "process_user_time": 1.177758, "process_kernel_time": 0.092294, "process_mem_max_rss": "125672", "process_out_blocks": "4818", "command_success": false, "process_in_blocks": "0"}
[0m04:44:08.172225 [debug] [MainThread]: Command `dbt build` failed at 04:44:08.172186 after 0.80 seconds
[0m04:44:08.172402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf015d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee61250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0ff790>]}
[0m04:44:08.172569 [debug] [MainThread]: Flushing usage events
[0m04:48:52.744369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825dd890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825dddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825dce90>]}


============================== 04:48:52.746840 | a38c13de-ec5a-458e-bf9a-38f01e656c1f ==============================
[0m04:48:52.746840 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:48:52.747164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:48:52.791447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818bf5d0>]}
[0m04:48:52.807512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b56050>]}
[0m04:48:52.807834 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:48:52.827442 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:48:52.867230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:48:52.867494 [debug] [MainThread]: Partial parsing: added file: threat_risk://macros/generate_schema_name.sql
[0m04:48:52.868270 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m04:48:53.112120 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m04:48:53.112490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81359510>]}
[0m04:48:53.204228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8183e0d0>]}
[0m04:48:53.244186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb42bd0>]}
[0m04:48:53.244411 [info ] [MainThread]: Found 8 models, 25 data tests, 429 macros
[0m04:48:53.245828 [info ] [MainThread]: 
[0m04:48:53.246232 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:48:53.247886 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m04:48:53.248138 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m04:48:53.260796 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m04:48:53.260936 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m04:48:53.261125 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m04:48:53.261366 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m04:48:53.261537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:48:53.261722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:48:53.267450 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m04:48:53.267575 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m04:48:53.268055 [debug] [ThreadPool]: On list_threat_risk: Close
[0m04:48:53.268580 [debug] [ThreadPool]: On list_threat_risk: Close
[0m04:48:53.269502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_staging)
[0m04:48:53.269780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_marts)
[0m04:48:53.271768 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m04:48:53.272457 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m04:48:53.272634 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m04:48:53.272799 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m04:48:53.272959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:48:53.273146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:48:53.276596 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:48:53.276723 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m04:48:53.276875 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m04:48:53.277055 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m04:48:53.277281 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m04:48:53.277485 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m04:48:53.279334 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m04:48:53.279422 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m04:48:53.279800 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m04:48:53.280203 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m04:48:53.280482 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m04:48:53.280616 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m04:48:53.282588 [debug] [MainThread]: Using postgres connection "master"
[0m04:48:53.282760 [debug] [MainThread]: On master: BEGIN
[0m04:48:53.282892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:48:53.285688 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m04:48:53.285860 [debug] [MainThread]: Using postgres connection "master"
[0m04:48:53.286049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:48:53.288337 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m04:48:53.288784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8149a150>]}
[0m04:48:53.288992 [debug] [MainThread]: On master: ROLLBACK
[0m04:48:53.289203 [debug] [MainThread]: Using postgres connection "master"
[0m04:48:53.289345 [debug] [MainThread]: On master: BEGIN
[0m04:48:53.289649 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:48:53.289807 [debug] [MainThread]: On master: COMMIT
[0m04:48:53.289940 [debug] [MainThread]: Using postgres connection "master"
[0m04:48:53.290071 [debug] [MainThread]: On master: COMMIT
[0m04:48:53.290284 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:48:53.290439 [debug] [MainThread]: On master: Close
[0m04:48:53.290642 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:48:53.290962 [info ] [MainThread]: 
[0m04:48:53.294754 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_date
[0m04:48:53.294909 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_product
[0m04:48:53.295039 [debug] [Thread-3 (]: Began running node model.threat_risk.dim_url
[0m04:48:53.295180 [debug] [Thread-4 (]: Began running node model.threat_risk.dim_vendor
[0m04:48:53.295362 [info ] [Thread-1 (]: 1 of 33 START sql table model marts.dim_date ................................... [RUN]
[0m04:48:53.295720 [info ] [Thread-2 (]: 2 of 33 START sql table model marts.dim_product ................................ [RUN]
[0m04:48:53.296092 [info ] [Thread-3 (]: 3 of 33 START sql table model marts.dim_url .................................... [RUN]
[0m04:48:53.296490 [info ] [Thread-4 (]: 4 of 33 START sql table model marts.dim_vendor ................................. [RUN]
[0m04:48:53.296780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now model.threat_risk.dim_date)
[0m04:48:53.297006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now model.threat_risk.dim_product)
[0m04:48:53.297279 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.threat_risk.dim_url'
[0m04:48:53.297518 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.threat_risk.dim_vendor'
[0m04:48:53.297697 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_date
[0m04:48:53.297886 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_product
[0m04:48:53.298077 [debug] [Thread-3 (]: Began compiling node model.threat_risk.dim_url
[0m04:48:53.298287 [debug] [Thread-4 (]: Began compiling node model.threat_risk.dim_vendor
[0m04:48:53.300663 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_date"
[0m04:48:53.301392 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_product"
[0m04:48:53.302052 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.dim_url"
[0m04:48:53.302721 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.dim_vendor"
[0m04:48:53.305066 [debug] [Thread-3 (]: Began executing node model.threat_risk.dim_url
[0m04:48:53.305212 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_date
[0m04:48:53.305340 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_product
[0m04:48:53.311694 [debug] [Thread-4 (]: Began executing node model.threat_risk.dim_vendor
[0m04:48:53.318777 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.dim_url"
[0m04:48:53.319835 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.dim_date"
[0m04:48:53.320830 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.dim_product"
[0m04:48:53.321941 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.dim_vendor"
[0m04:48:53.322852 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_url"
[0m04:48:53.323025 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_date"
[0m04:48:53.323219 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m04:48:53.323442 [debug] [Thread-3 (]: On model.threat_risk.dim_url: BEGIN
[0m04:48:53.323356 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m04:48:53.324095 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: BEGIN
[0m04:48:53.323779 [debug] [Thread-2 (]: On model.threat_risk.dim_product: BEGIN
[0m04:48:53.323958 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:48:53.323618 [debug] [Thread-1 (]: On model.threat_risk.dim_date: BEGIN
[0m04:48:53.324650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:48:53.324367 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:48:53.324213 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:48:53.329544 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m04:48:53.329759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m04:48:53.329894 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m04:48:53.330069 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_url"
[0m04:48:53.330251 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_date"
[0m04:48:53.330944 [debug] [Thread-1 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */

  
    

  create  table "threat_risk"."marts"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with dates as (
  select distinct run_date as d from staging.stg_kev
  union
  select distinct run_date as d from staging.stg_urlhaus
),
final as (
  select
    d as date_day,
    extract(year from d)::int as year,
    extract(month from d)::int as month,
    extract(day from d)::int as day
  from dates
)
select * from final
  );
  
[0m04:48:53.330623 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m04:48:53.330798 [debug] [Thread-3 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */

  
    

  create  table "threat_risk"."marts"."dim_url__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  url,
  host
from (
  select distinct url, host
  from staging.stg_urlhaus
  where url is not null
) u
  );
  
[0m04:48:53.330429 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m04:48:53.331180 [debug] [Thread-2 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */

  
    

  create  table "threat_risk"."marts"."dim_product__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  md5(coalesce(vendor_project,'')) as vendor_key,
  vendor_project,
  product
from (
  select distinct vendor_project, product
  from staging.stg_kev
  where vendor_project is not null and product is not null
) p
  );
  
[0m04:48:53.331337 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.stg_kev" does not exist
LINE 13:   select distinct run_date as d from staging.stg_kev
                                              ^

[0m04:48:53.331972 [debug] [Thread-1 (]: On model.threat_risk.dim_date: ROLLBACK
[0m04:48:53.331721 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "staging.stg_urlhaus" does not exist
LINE 18:   from staging.stg_urlhaus
                ^

[0m04:48:53.331559 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m04:48:53.332097 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "staging.stg_kev" does not exist
LINE 19:   from staging.stg_kev
                ^

[0m04:48:53.332440 [debug] [Thread-1 (]: On model.threat_risk.dim_date: Close
[0m04:48:53.332665 [debug] [Thread-3 (]: On model.threat_risk.dim_url: ROLLBACK
[0m04:48:53.332862 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */

  
    

  create  table "threat_risk"."marts"."dim_vendor__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project, '')) as vendor_key,
  vendor_project
from (
  select distinct vendor_project
  from staging.stg_kev
  where vendor_project is not null
) v
  );
  
[0m04:48:53.333079 [debug] [Thread-2 (]: On model.threat_risk.dim_product: ROLLBACK
[0m04:48:53.334241 [debug] [Thread-3 (]: On model.threat_risk.dim_url: Close
[0m04:48:53.335013 [debug] [Thread-1 (]: Database Error in model dim_date (models/marts/dim_date.sql)
  relation "staging.stg_kev" does not exist
  LINE 13:   select distinct run_date as d from staging.stg_kev
                                                ^
  compiled code at target/run/threat_risk/models/marts/dim_date.sql
[0m04:48:53.336945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bab00d0>]}
[0m04:48:53.335483 [debug] [Thread-2 (]: On model.threat_risk.dim_product: Close
[0m04:48:53.336392 [debug] [Thread-3 (]: Database Error in model dim_url (models/marts/dim_url.sql)
  relation "staging.stg_urlhaus" does not exist
  LINE 18:   from staging.stg_urlhaus
                  ^
  compiled code at target/run/threat_risk/models/marts/dim_url.sql
[0m04:48:53.335329 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "staging.stg_kev" does not exist
LINE 17:   from staging.stg_kev
                ^

[0m04:48:53.338668 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: ROLLBACK
[0m04:48:53.338327 [debug] [Thread-2 (]: Database Error in model dim_product (models/marts/dim_product.sql)
  relation "staging.stg_kev" does not exist
  LINE 19:   from staging.stg_kev
                  ^
  compiled code at target/run/threat_risk/models/marts/dim_product.sql
[0m04:48:53.338479 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818bbed0>]}
[0m04:48:53.337273 [error] [Thread-1 (]: 1 of 33 ERROR creating sql table model marts.dim_date .......................... [[31mERROR[0m in 0.04s]
[0m04:48:53.339773 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_date
[0m04:48:53.339068 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81832ed0>]}
[0m04:48:53.339377 [error] [Thread-3 (]: 3 of 33 ERROR creating sql table model marts.dim_url ........................... [[31mERROR[0m in 0.04s]
[0m04:48:53.338931 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: Close
[0m04:48:53.340034 [debug] [Thread-1 (]: Began running node model.threat_risk.fact_kev
[0m04:48:53.340516 [error] [Thread-2 (]: 2 of 33 ERROR creating sql table model marts.dim_product ....................... [[31mERROR[0m in 0.04s]
[0m04:48:53.340877 [debug] [Thread-3 (]: Finished running node model.threat_risk.dim_url
[0m04:48:53.341768 [debug] [Thread-4 (]: Database Error in model dim_vendor (models/marts/dim_vendor.sql)
  relation "staging.stg_kev" does not exist
  LINE 17:   from staging.stg_kev
                  ^
  compiled code at target/run/threat_risk/models/marts/dim_vendor.sql
[0m04:48:53.342777 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818737d0>]}
[0m04:48:53.342239 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_product
[0m04:48:53.342470 [debug] [Thread-3 (]: Began running node model.threat_risk.fact_url_events
[0m04:48:53.341944 [info ] [Thread-1 (]: 5 of 33 START sql table model marts.fact_kev ................................... [RUN]
[0m04:48:53.344024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_date, now model.threat_risk.fact_kev)
[0m04:48:53.343373 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_kev
[0m04:48:53.343730 [info ] [Thread-3 (]: 6 of 33 START sql table model marts.fact_url_events ............................ [RUN]
[0m04:48:53.343009 [error] [Thread-4 (]: 4 of 33 ERROR creating sql table model marts.dim_vendor ........................ [[31mERROR[0m in 0.05s]
[0m04:48:53.344957 [debug] [Thread-4 (]: Finished running node model.threat_risk.dim_vendor
[0m04:48:53.344448 [info ] [Thread-2 (]: 7 of 33 START sql view model staging.stg_kev ................................... [RUN]
[0m04:48:53.344737 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_url, now model.threat_risk.fact_url_events)
[0m04:48:53.344200 [debug] [Thread-1 (]: Began compiling node model.threat_risk.fact_kev
[0m04:48:53.345148 [debug] [Thread-4 (]: Began running node model.threat_risk.stg_urlhaus
[0m04:48:53.345464 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_product, now model.threat_risk.stg_kev)
[0m04:48:53.345665 [debug] [Thread-3 (]: Began compiling node model.threat_risk.fact_url_events
[0m04:48:53.346542 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.fact_kev"
[0m04:48:53.346733 [info ] [Thread-4 (]: 8 of 33 START sql view model staging.stg_urlhaus ............................... [RUN]
[0m04:48:53.347008 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_kev
[0m04:48:53.347723 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.fact_url_events"
[0m04:48:53.348127 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_vendor, now model.threat_risk.stg_urlhaus)
[0m04:48:53.348857 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_kev"
[0m04:48:53.349013 [debug] [Thread-1 (]: Began executing node model.threat_risk.fact_kev
[0m04:48:53.349341 [debug] [Thread-4 (]: Began compiling node model.threat_risk.stg_urlhaus
[0m04:48:53.349560 [debug] [Thread-3 (]: Began executing node model.threat_risk.fact_url_events
[0m04:48:53.350707 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.fact_kev"
[0m04:48:53.351459 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus"
[0m04:48:53.353274 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.fact_url_events"
[0m04:48:53.353448 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_kev
[0m04:48:53.353874 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m04:48:53.359979 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.stg_kev"
[0m04:48:53.360172 [debug] [Thread-4 (]: Began executing node model.threat_risk.stg_urlhaus
[0m04:48:53.360314 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m04:48:53.361958 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: BEGIN
[0m04:48:53.361758 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.stg_urlhaus"
[0m04:48:53.360447 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: BEGIN
[0m04:48:53.362138 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m04:48:53.362230 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:48:53.362503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:48:53.362670 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: BEGIN
[0m04:48:53.362779 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m04:48:53.363309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:48:53.363519 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: BEGIN
[0m04:48:53.363945 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:48:53.367473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m04:48:53.367662 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m04:48:53.367842 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m04:48:53.368030 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m04:48:53.368293 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */

  
    

  create  table "threat_risk"."marts"."fact_kev__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(cve_id,'')) as cve_key,
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  run_date as date_day,
  cve_id,
  vulnerability_name,
  date_added,
  due_date,
  required_action,
  notes
from staging.stg_kev
where cve_id is not null
  );
  
[0m04:48:53.368427 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m04:48:53.368635 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */

  
    

  create  table "threat_risk"."marts"."fact_url_events__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  run_date as date_day,
  url_status,
  threat,
  tags,
  date_added,
  reporter,
  larted
from staging.stg_urlhaus
where url is not null
  );
  
[0m04:48:53.368775 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m04:48:53.369371 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m04:48:53.369160 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.stg_kev" does not exist
LINE 22: from staging.stg_kev
              ^

[0m04:48:53.369023 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m04:48:53.369481 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "staging.stg_urlhaus" does not exist
LINE 21: from staging.stg_urlhaus
              ^

[0m04:48:53.369618 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */

  create view "threat_risk"."staging"."stg_kev__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.kev
),
clean as (
  select
    nullif(trim(cve_id), '') as cve_id,
    nullif(trim(vendor_project), '') as vendor_project,
    nullif(trim(product), '') as product,
    nullif(trim(vulnerability_name), '') as vulnerability_name,
    date_added,
    short_description,
    required_action,
    due_date,
    notes,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m04:48:53.369802 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: ROLLBACK
[0m04:48:53.369946 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */

  create view "threat_risk"."staging"."stg_urlhaus__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.urlhaus_recent
),
clean as (
  select
    nullif(trim(url), '') as url,
    nullif(trim(url_status), '') as url_status,
    nullif(trim(host), '') as host,
    date_added,
    nullif(trim(threat), '') as threat,
    nullif(trim(tags), '') as tags,
    nullif(trim(urlhaus_link), '') as urlhaus_link,
    nullif(trim(reporter), '') as reporter,
    larted,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m04:48:53.370126 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: ROLLBACK
[0m04:48:53.370441 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: Close
[0m04:48:53.370784 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: Close
[0m04:48:53.371750 [debug] [Thread-1 (]: Database Error in model fact_kev (models/marts/fact_kev.sql)
  relation "staging.stg_kev" does not exist
  LINE 22: from staging.stg_kev
                ^
  compiled code at target/run/threat_risk/models/marts/fact_kev.sql
[0m04:48:53.372354 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m04:48:53.372886 [debug] [Thread-3 (]: Database Error in model fact_url_events (models/marts/fact_url_events.sql)
  relation "staging.stg_urlhaus" does not exist
  LINE 21: from staging.stg_urlhaus
                ^
  compiled code at target/run/threat_risk/models/marts/fact_url_events.sql
[0m04:48:53.373005 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m04:48:53.373200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a72c450>]}
[0m04:48:53.375602 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m04:48:53.375806 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8146a190>]}
[0m04:48:53.376744 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m04:48:53.377023 [error] [Thread-1 (]: 5 of 33 ERROR creating sql table model marts.fact_kev .......................... [[31mERROR[0m in 0.03s]
[0m04:48:53.377337 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus__dbt_tmp" rename to "stg_urlhaus"
[0m04:48:53.377612 [error] [Thread-3 (]: 6 of 33 ERROR creating sql table model marts.fact_url_events ................... [[31mERROR[0m in 0.03s]
[0m04:48:53.377844 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev__dbt_tmp" rename to "stg_kev"
[0m04:48:53.378101 [debug] [Thread-1 (]: Finished running node model.threat_risk.fact_kev
[0m04:48:53.378433 [debug] [Thread-3 (]: Finished running node model.threat_risk.fact_url_events
[0m04:48:53.378563 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:48:53.378836 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m04:48:53.379038 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:48:53.379279 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m04:48:53.384375 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m04:48:53.384608 [info ] [Thread-1 (]: 9 of 33 SKIP test not_null_dim_url_url ......................................... [[33mSKIP[0m]
[0m04:48:53.385164 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: COMMIT
[0m04:48:53.385401 [info ] [Thread-3 (]: 10 of 33 SKIP test not_null_dim_url_url_key .................................... [[33mSKIP[0m]
[0m04:48:53.385712 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m04:48:53.385986 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m04:48:53.386174 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m04:48:53.386407 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m04:48:53.386583 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m04:48:53.386815 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m04:48:53.387019 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: COMMIT
[0m04:48:53.387242 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m04:48:53.387599 [info ] [Thread-1 (]: 11 of 33 SKIP test unique_dim_url_url .......................................... [[33mSKIP[0m]
[0m04:48:53.388077 [info ] [Thread-3 (]: 12 of 33 SKIP test unique_dim_url_url_key ...................................... [[33mSKIP[0m]
[0m04:48:53.388445 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m04:48:53.388303 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m04:48:53.388614 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m04:48:53.388819 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m04:48:53.390903 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."staging"."stg_urlhaus__dbt_backup"
[0m04:48:53.391668 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."staging"."stg_kev__dbt_backup"
[0m04:48:53.391877 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m04:48:53.392103 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m04:48:53.393796 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m04:48:53.394002 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m04:48:53.394209 [info ] [Thread-1 (]: 13 of 33 SKIP test not_null_dim_product_product ................................ [[33mSKIP[0m]
[0m04:48:53.394443 [info ] [Thread-3 (]: 14 of 33 SKIP test not_null_dim_product_product_key ............................ [[33mSKIP[0m]
[0m04:48:53.394683 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
drop view if exists "threat_risk"."staging"."stg_urlhaus__dbt_backup" cascade
[0m04:48:53.394853 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
drop view if exists "threat_risk"."staging"."stg_kev__dbt_backup" cascade
[0m04:48:53.395050 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m04:48:53.395228 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m04:48:53.395506 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m04:48:53.396904 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus: Close
[0m04:48:53.395768 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m04:48:53.395989 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m04:48:53.395637 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m04:48:53.397156 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816d9410>]}
[0m04:48:53.397334 [info ] [Thread-1 (]: 15 of 33 SKIP test not_null_dim_product_vendor_key ............................. [[33mSKIP[0m]
[0m04:48:53.397678 [info ] [Thread-3 (]: 16 of 33 SKIP test not_null_dim_product_vendor_project ......................... [[33mSKIP[0m]
[0m04:48:53.398329 [debug] [Thread-2 (]: On model.threat_risk.stg_kev: Close
[0m04:48:53.399342 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a38c13de-ec5a-458e-bf9a-38f01e656c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a735b10>]}
[0m04:48:53.398850 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m04:48:53.399073 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m04:48:53.398586 [info ] [Thread-4 (]: 8 of 33 OK created sql view model staging.stg_urlhaus .......................... [[32mCREATE VIEW[0m in 0.05s]
[0m04:48:53.400406 [debug] [Thread-4 (]: Finished running node model.threat_risk.stg_urlhaus
[0m04:48:53.399856 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m04:48:53.400152 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m04:48:53.399587 [info ] [Thread-2 (]: 7 of 33 OK created sql view model staging.stg_kev .............................. [[32mCREATE VIEW[0m in 0.05s]
[0m04:48:53.401473 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_kev
[0m04:48:53.400891 [info ] [Thread-1 (]: 17 of 33 SKIP test unique_dim_product_product_key .............................. [[33mSKIP[0m]
[0m04:48:53.401158 [info ] [Thread-3 (]: 18 of 33 SKIP test not_null_dim_vendor_vendor_key .............................. [[33mSKIP[0m]
[0m04:48:53.400589 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m04:48:53.402388 [info ] [Thread-4 (]: 19 of 33 SKIP test not_null_dim_vendor_vendor_project .......................... [[33mSKIP[0m]
[0m04:48:53.401945 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m04:48:53.402163 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m04:48:53.401670 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m04:48:53.402611 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m04:48:53.402856 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m04:48:53.403081 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m04:48:53.403309 [info ] [Thread-2 (]: 20 of 33 SKIP test unique_dim_vendor_vendor_key ................................ [[33mSKIP[0m]
[0m04:48:53.404418 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m04:48:53.403864 [info ] [Thread-1 (]: 21 of 33 SKIP test unique_dim_vendor_vendor_project ............................ [[33mSKIP[0m]
[0m04:48:53.404155 [info ] [Thread-3 (]: 22 of 33 SKIP test not_null_fact_kev_cve_id .................................... [[33mSKIP[0m]
[0m04:48:53.403632 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m04:48:53.405237 [info ] [Thread-4 (]: 23 of 33 SKIP test not_null_fact_kev_date_day .................................. [[33mSKIP[0m]
[0m04:48:53.404849 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m04:48:53.405047 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m04:48:53.404629 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m04:48:53.406400 [info ] [Thread-2 (]: 24 of 33 SKIP test not_null_fact_url_events_date_day ........................... [[33mSKIP[0m]
[0m04:48:53.405909 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m04:48:53.406169 [debug] [Thread-3 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m04:48:53.405610 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m04:48:53.406610 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m04:48:53.406866 [info ] [Thread-1 (]: 25 of 33 SKIP test not_null_fact_url_events_url_key ............................ [[33mSKIP[0m]
[0m04:48:53.407141 [info ] [Thread-3 (]: 26 of 33 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m04:48:53.407410 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m04:48:53.407613 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m04:48:53.407835 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m04:48:53.408051 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_url_events, now test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41)
[0m04:48:53.408229 [info ] [Thread-4 (]: 27 of 33 START test not_null_stg_urlhaus_run_date .............................. [RUN]
[0m04:48:53.409161 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus, now test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93)
[0m04:48:53.408732 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m04:48:53.408979 [debug] [Thread-3 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m04:48:53.408466 [info ] [Thread-2 (]: 28 of 33 START test not_null_stg_urlhaus_url ................................... [RUN]
[0m04:48:53.411503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_kev, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m04:48:53.409548 [info ] [Thread-1 (]: 29 of 33 START test not_null_stg_urlhaus_url_status ............................ [RUN]
[0m04:48:53.411298 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m04:48:53.409351 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m04:48:53.411661 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m04:48:53.411866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_kev, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m04:48:53.414840 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m04:48:53.416433 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m04:48:53.416690 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m04:48:53.416846 [debug] [Thread-3 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m04:48:53.419207 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m04:48:53.419386 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m04:48:53.424376 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m04:48:53.424560 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m04:48:53.425500 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m04:48:53.425762 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m04:48:53.426678 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m04:48:53.427684 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m04:48:53.427860 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m04:48:53.428147 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m04:48:53.428417 [debug] [Thread-3 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m04:48:53.428542 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m04:48:53.428718 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m04:48:53.428832 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m04:48:53.429446 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m04:48:53.429129 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m04:48:53.429299 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:48:53.428956 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:48:53.429577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:48:53.429716 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:48:53.434826 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m04:48:53.435094 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m04:48:53.435275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m04:48:53.435393 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m04:48:53.435578 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m04:48:53.435721 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m04:48:53.436276 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m04:48:53.436029 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m04:48:53.435855 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m04:48:53.436824 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m04:48:53.436654 [debug] [Thread-3 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m04:48:53.436444 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m04:48:53.437619 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:48:53.439081 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m04:48:53.439239 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:48:53.439367 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:48:53.439473 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:48:53.439684 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m04:48:53.440267 [debug] [Thread-3 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m04:48:53.440728 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m04:48:53.441196 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m04:48:53.441502 [info ] [Thread-4 (]: 27 of 33 PASS not_null_stg_urlhaus_run_date .................................... [[32mPASS[0m in 0.03s]
[0m04:48:53.441812 [debug] [Thread-3 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m04:48:53.441994 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m04:48:53.442175 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m04:48:53.442362 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m04:48:53.442658 [info ] [Thread-3 (]: 26 of 33 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown . [[32mPASS[0m in 0.03s]
[0m04:48:53.443898 [debug] [Thread-3 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m04:48:53.443339 [error] [Thread-2 (]: 28 of 33 FAIL 21926 not_null_stg_urlhaus_url ................................... [[31mFAIL 21926[0m in 0.03s]
[0m04:48:53.443624 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m04:48:53.442981 [error] [Thread-1 (]: 29 of 33 FAIL 21926 not_null_stg_urlhaus_url_status ............................ [[31mFAIL 21926[0m in 0.03s]
[0m04:48:53.444089 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m04:48:53.444368 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m04:48:53.444580 [info ] [Thread-4 (]: 30 of 33 START test not_null_stg_kev_cve_id .................................... [RUN]
[0m04:48:53.444910 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m04:48:53.445133 [info ] [Thread-3 (]: 31 of 33 START test not_null_stg_kev_product ................................... [RUN]
[0m04:48:53.445390 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m04:48:53.445666 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0)
[0m04:48:53.445875 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m04:48:53.446133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now test.threat_risk.not_null_stg_kev_product.9b2d2b4877)
[0m04:48:53.446325 [info ] [Thread-2 (]: 32 of 33 START test not_null_stg_kev_run_date .................................. [RUN]
[0m04:48:53.446613 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m04:48:53.446824 [info ] [Thread-1 (]: 33 of 33 START test not_null_stg_kev_vendor_project ............................ [RUN]
[0m04:48:53.447070 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m04:48:53.447305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m04:48:53.448981 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m04:48:53.449186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m04:48:53.450560 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m04:48:53.450753 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m04:48:53.451180 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m04:48:53.451567 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m04:48:53.452832 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m04:48:53.453022 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m04:48:53.454216 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m04:48:53.455016 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m04:48:53.455939 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m04:48:53.456139 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m04:48:53.456613 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m04:48:53.456770 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m04:48:53.458612 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m04:48:53.458833 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m04:48:53.459561 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m04:48:53.459732 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m04:48:53.460030 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m04:48:53.460284 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m04:48:53.460524 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:48:53.460713 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m04:48:53.461231 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m04:48:53.460967 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m04:48:53.460808 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:48:53.461433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:48:53.461600 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:48:53.467725 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m04:48:53.467926 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m04:48:53.468085 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m04:48:53.468970 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m04:48:53.469213 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m04:48:53.469388 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m04:48:53.470060 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:48:53.470231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:48:53.470906 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m04:48:53.471065 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m04:48:53.471195 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:48:53.471303 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m04:48:53.471530 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m04:48:53.471633 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m04:48:53.472122 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m04:48:53.472297 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m04:48:53.472468 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m04:48:53.472755 [info ] [Thread-4 (]: 30 of 33 PASS not_null_stg_kev_cve_id .......................................... [[32mPASS[0m in 0.03s]
[0m04:48:53.473042 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m04:48:53.473558 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m04:48:53.473870 [info ] [Thread-3 (]: 31 of 33 PASS not_null_stg_kev_product ......................................... [[32mPASS[0m in 0.03s]
[0m04:48:53.474408 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m04:48:53.474540 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:48:53.474796 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:48:53.475777 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m04:48:53.475295 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m04:48:53.476012 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m04:48:53.476376 [info ] [Thread-2 (]: 32 of 33 PASS not_null_stg_kev_run_date ........................................ [[32mPASS[0m in 0.03s]
[0m04:48:53.476167 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m04:48:53.476946 [info ] [Thread-1 (]: 33 of 33 PASS not_null_stg_kev_vendor_project .................................. [[32mPASS[0m in 0.03s]
[0m04:48:53.476662 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m04:48:53.477224 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m04:48:53.478070 [debug] [MainThread]: Using postgres connection "master"
[0m04:48:53.478239 [debug] [MainThread]: On master: BEGIN
[0m04:48:53.478393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:48:53.481479 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m04:48:53.481647 [debug] [MainThread]: On master: COMMIT
[0m04:48:53.481782 [debug] [MainThread]: Using postgres connection "master"
[0m04:48:53.481917 [debug] [MainThread]: On master: COMMIT
[0m04:48:53.482141 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:48:53.482285 [debug] [MainThread]: On master: Close
[0m04:48:53.482475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:48:53.482624 [debug] [MainThread]: Connection 'test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89' was properly closed.
[0m04:48:53.482768 [debug] [MainThread]: Connection 'test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe' was properly closed.
[0m04:48:53.482911 [debug] [MainThread]: Connection 'test.threat_risk.not_null_stg_kev_product.9b2d2b4877' was properly closed.
[0m04:48:53.483051 [debug] [MainThread]: Connection 'test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0' was properly closed.
[0m04:48:53.483258 [info ] [MainThread]: 
[0m04:48:53.483459 [info ] [MainThread]: Finished running 6 table models, 25 data tests, 2 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m04:48:53.484474 [debug] [MainThread]: Command end result
[0m04:48:53.498841 [info ] [MainThread]: 
[0m04:48:53.499040 [info ] [MainThread]: [31mCompleted with 8 errors and 0 warnings:[0m
[0m04:48:53.499233 [info ] [MainThread]: 
[0m04:48:53.499559 [error] [MainThread]:   Database Error in model dim_date (models/marts/dim_date.sql)
  relation "staging.stg_kev" does not exist
  LINE 13:   select distinct run_date as d from staging.stg_kev
                                                ^
  compiled code at target/run/threat_risk/models/marts/dim_date.sql
[0m04:48:53.499827 [info ] [MainThread]: 
[0m04:48:53.500010 [error] [MainThread]:   Database Error in model dim_url (models/marts/dim_url.sql)
  relation "staging.stg_urlhaus" does not exist
  LINE 18:   from staging.stg_urlhaus
                  ^
  compiled code at target/run/threat_risk/models/marts/dim_url.sql
[0m04:48:53.500246 [info ] [MainThread]: 
[0m04:48:53.500416 [error] [MainThread]:   Database Error in model dim_product (models/marts/dim_product.sql)
  relation "staging.stg_kev" does not exist
  LINE 19:   from staging.stg_kev
                  ^
  compiled code at target/run/threat_risk/models/marts/dim_product.sql
[0m04:48:53.500543 [info ] [MainThread]: 
[0m04:48:53.500679 [error] [MainThread]:   Database Error in model dim_vendor (models/marts/dim_vendor.sql)
  relation "staging.stg_kev" does not exist
  LINE 17:   from staging.stg_kev
                  ^
  compiled code at target/run/threat_risk/models/marts/dim_vendor.sql
[0m04:48:53.500791 [info ] [MainThread]: 
[0m04:48:53.500923 [error] [MainThread]:   Database Error in model fact_kev (models/marts/fact_kev.sql)
  relation "staging.stg_kev" does not exist
  LINE 22: from staging.stg_kev
                ^
  compiled code at target/run/threat_risk/models/marts/fact_kev.sql
[0m04:48:53.501034 [info ] [MainThread]: 
[0m04:48:53.501169 [error] [MainThread]:   Database Error in model fact_url_events (models/marts/fact_url_events.sql)
  relation "staging.stg_urlhaus" does not exist
  LINE 21: from staging.stg_urlhaus
                ^
  compiled code at target/run/threat_risk/models/marts/fact_url_events.sql
[0m04:48:53.501285 [info ] [MainThread]: 
[0m04:48:53.501466 [error] [MainThread]: [31mFailure in test not_null_stg_urlhaus_url (models/staging/schema.yml)[0m
[0m04:48:53.501709 [error] [MainThread]:   Got 21926 results, configured to fail if != 0
[0m04:48:53.501910 [info ] [MainThread]: 
[0m04:48:53.502133 [info ] [MainThread]:   compiled code at target/compiled/threat_risk/models/staging/schema.yml/not_null_stg_urlhaus_url.sql
[0m04:48:53.502301 [info ] [MainThread]: 
[0m04:48:53.502527 [error] [MainThread]: [31mFailure in test not_null_stg_urlhaus_url_status (models/staging/schema.yml)[0m
[0m04:48:53.502725 [error] [MainThread]:   Got 21926 results, configured to fail if != 0
[0m04:48:53.502907 [info ] [MainThread]: 
[0m04:48:53.503137 [info ] [MainThread]:   compiled code at target/compiled/threat_risk/models/staging/schema.yml/not_null_stg_urlhaus_url_status.sql
[0m04:48:53.503328 [info ] [MainThread]: 
[0m04:48:53.503521 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=8 SKIP=17 TOTAL=33
[0m04:48:53.504019 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.7761069, "process_user_time": 1.125984, "process_kernel_time": 0.082538, "process_mem_max_rss": "126612", "process_out_blocks": "4813", "command_success": false, "process_in_blocks": "0"}
[0m04:48:53.504222 [debug] [MainThread]: Command `dbt build` failed at 04:48:53.504190 after 0.78 seconds
[0m04:48:53.504390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829482d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b8bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872f1250>]}
[0m04:48:53.504540 [debug] [MainThread]: Flushing usage events
[0m23:42:02.318817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb98e9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbab6ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb98b5c10>]}


============================== 23:42:02.321686 | eebcb8f6-d2fd-499e-a6d4-2492a46ef295 ==============================
[0m23:42:02.321686 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:42:02.321975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/app', 'log_path': '/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m23:42:02.368838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eebcb8f6-d2fd-499e-a6d4-2492a46ef295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a8dc50>]}
[0m23:42:02.385114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eebcb8f6-d2fd-499e-a6d4-2492a46ef295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbdba6d0>]}
[0m23:42:02.385452 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:42:02.405560 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:42:02.446241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m23:42:02.446525 [debug] [MainThread]: Partial parsing: updated file: threat_risk://models/marts/dim_url.sql
[0m23:42:02.446689 [debug] [MainThread]: Partial parsing: updated file: threat_risk://models/marts/dim_product.sql
[0m23:42:02.446842 [debug] [MainThread]: Partial parsing: updated file: threat_risk://models/marts/dim_vendor.sql
[0m23:42:02.446977 [debug] [MainThread]: Partial parsing: updated file: threat_risk://models/marts/dim_date.sql
[0m23:42:02.447118 [debug] [MainThread]: Partial parsing: updated file: threat_risk://models/marts/fact_kev.sql
[0m23:42:02.447253 [debug] [MainThread]: Partial parsing: updated file: threat_risk://models/marts/fact_url_events.sql
[0m23:42:02.516040 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:42:02.516349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eebcb8f6-d2fd-499e-a6d4-2492a46ef295', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb887b2d0>]}
[0m23:42:02.572294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eebcb8f6-d2fd-499e-a6d4-2492a46ef295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb85daa10>]}
[0m23:42:02.612100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eebcb8f6-d2fd-499e-a6d4-2492a46ef295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69af550>]}
[0m23:42:02.612371 [info ] [MainThread]: Found 8 models, 25 data tests, 429 macros
[0m23:42:02.613891 [info ] [MainThread]: 
[0m23:42:02.614240 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:02.615911 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m23:42:02.616184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m23:42:02.651133 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m23:42:02.651317 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m23:42:02.651528 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m23:42:02.651744 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m23:42:02.651931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:02.652113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:02.658893 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m23:42:02.659033 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m23:42:02.659559 [debug] [ThreadPool]: On list_threat_risk: Close
[0m23:42:02.660039 [debug] [ThreadPool]: On list_threat_risk: Close
[0m23:42:02.661004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_marts)
[0m23:42:02.661250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_staging)
[0m23:42:02.663375 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m23:42:02.664069 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m23:42:02.664264 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m23:42:02.664455 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m23:42:02.664630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:02.664791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:02.668641 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:42:02.668848 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m23:42:02.668984 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:42:02.669137 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:42:02.669329 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m23:42:02.669681 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m23:42:02.671509 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:42:02.671635 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m23:42:02.672099 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m23:42:02.672561 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m23:42:02.672813 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m23:42:02.672947 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m23:42:02.675288 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:02.675460 [debug] [MainThread]: On master: BEGIN
[0m23:42:02.675611 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:02.678600 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:42:02.678758 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:02.678928 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:42:02.681119 [debug] [MainThread]: SQL status: SELECT 4 in 0.002 seconds
[0m23:42:02.681589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eebcb8f6-d2fd-499e-a6d4-2492a46ef295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a8ee50>]}
[0m23:42:02.681787 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:02.681980 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:02.682115 [debug] [MainThread]: On master: BEGIN
[0m23:42:02.682373 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:42:02.682528 [debug] [MainThread]: On master: COMMIT
[0m23:42:02.682664 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:02.682790 [debug] [MainThread]: On master: COMMIT
[0m23:42:02.682976 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:02.683113 [debug] [MainThread]: On master: Close
[0m23:42:02.683325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:42:02.683555 [info ] [MainThread]: 
[0m23:42:02.687996 [debug] [Thread-1 (]: Began running node model.threat_risk.stg_kev
[0m23:42:02.688151 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_urlhaus
[0m23:42:02.688419 [info ] [Thread-1 (]: 1 of 33 START sql view model staging.stg_kev ................................... [RUN]
[0m23:42:02.688734 [info ] [Thread-2 (]: 2 of 33 START sql view model staging.stg_urlhaus ............................... [RUN]
[0m23:42:02.689042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now model.threat_risk.stg_kev)
[0m23:42:02.689262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now model.threat_risk.stg_urlhaus)
[0m23:42:02.689463 [debug] [Thread-1 (]: Began compiling node model.threat_risk.stg_kev
[0m23:42:02.689672 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_urlhaus
[0m23:42:02.692025 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.stg_kev"
[0m23:42:02.692760 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus"
[0m23:42:02.694414 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_urlhaus
[0m23:42:02.694558 [debug] [Thread-1 (]: Began executing node model.threat_risk.stg_kev
[0m23:42:02.705928 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.stg_urlhaus"
[0m23:42:02.707087 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.stg_kev"
[0m23:42:02.707788 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:42:02.707940 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:42:02.708069 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: BEGIN
[0m23:42:02.708220 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: BEGIN
[0m23:42:02.708381 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:02.708540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:02.711875 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m23:42:02.712045 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:42:02.712198 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */

  create view "threat_risk"."staging"."stg_urlhaus__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.urlhaus_recent
),
clean as (
  select
    nullif(trim(url), '') as url,
    nullif(trim(url_status), '') as url_status,
    nullif(trim(host), '') as host,
    date_added,
    nullif(trim(threat), '') as threat,
    nullif(trim(tags), '') as tags,
    nullif(trim(urlhaus_link), '') as urlhaus_link,
    nullif(trim(reporter), '') as reporter,
    larted,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m23:42:02.712656 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:42:02.712829 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:42:02.712994 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */

  create view "threat_risk"."staging"."stg_kev__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.kev
),
clean as (
  select
    nullif(trim(cve_id), '') as cve_id,
    nullif(trim(vendor_project), '') as vendor_project,
    nullif(trim(product), '') as product,
    nullif(trim(vulnerability_name), '') as vulnerability_name,
    date_added,
    short_description,
    required_action,
    due_date,
    notes,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m23:42:02.714095 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:42:02.716303 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:42:02.716539 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus" rename to "stg_urlhaus__dbt_backup"
[0m23:42:02.716418 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:42:02.717593 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:42:02.717686 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:02.717810 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev" rename to "stg_kev__dbt_backup"
[0m23:42:02.718692 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:42:02.719014 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus__dbt_tmp" rename to "stg_urlhaus"
[0m23:42:02.719300 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:02.720429 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:42:02.720533 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:02.720688 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev__dbt_tmp" rename to "stg_kev"
[0m23:42:02.725861 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m23:42:02.726123 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:42:02.726353 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m23:42:02.726230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:02.726922 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m23:42:02.727208 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:42:02.727065 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:42:02.727355 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m23:42:02.729976 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."staging"."stg_urlhaus__dbt_backup"
[0m23:42:02.731909 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:42:02.732132 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
drop view if exists "threat_risk"."staging"."stg_urlhaus__dbt_backup" cascade
[0m23:42:02.732020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:42:02.733055 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."staging"."stg_kev__dbt_backup"
[0m23:42:02.733268 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:42:02.733530 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
drop view if exists "threat_risk"."staging"."stg_kev__dbt_backup" cascade
[0m23:42:02.733417 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:42:02.734539 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: Close
[0m23:42:02.735179 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebcb8f6-d2fd-499e-a6d4-2492a46ef295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb56f9f10>]}
[0m23:42:02.734652 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:42:02.736019 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: Close
[0m23:42:02.735471 [info ] [Thread-2 (]: 2 of 33 OK created sql view model staging.stg_urlhaus .......................... [[32mCREATE VIEW[0m in 0.05s]
[0m23:42:02.736445 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_urlhaus
[0m23:42:02.736238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebcb8f6-d2fd-499e-a6d4-2492a46ef295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbcd74a50>]}
[0m23:42:02.736868 [info ] [Thread-1 (]: 1 of 33 OK created sql view model staging.stg_kev .............................. [[32mCREATE VIEW[0m in 0.05s]
[0m23:42:02.737092 [debug] [Thread-4 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:42:02.737236 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:42:02.737431 [debug] [Thread-1 (]: Finished running node model.threat_risk.stg_kev
[0m23:42:02.737531 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:42:02.737721 [info ] [Thread-4 (]: 3 of 33 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m23:42:02.737921 [info ] [Thread-3 (]: 4 of 33 START test not_null_stg_urlhaus_run_date ............................... [RUN]
[0m23:42:02.738271 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:42:02.738562 [info ] [Thread-2 (]: 5 of 33 START test not_null_stg_urlhaus_url .................................... [RUN]
[0m23:42:02.738955 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41'
[0m23:42:02.739180 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93'
[0m23:42:02.739356 [info ] [Thread-1 (]: 6 of 33 START test not_null_stg_urlhaus_url_status ............................. [RUN]
[0m23:42:02.740114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_kev, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m23:42:02.739775 [debug] [Thread-4 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:42:02.739945 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:42:02.739593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m23:42:02.747585 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:42:02.744571 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:42:02.747392 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:42:02.740266 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:42:02.748808 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:42:02.750665 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:42:02.750912 [debug] [Thread-4 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:42:02.751098 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:42:02.751302 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:42:02.756028 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:42:02.756246 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:42:02.756952 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:42:02.757775 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:42:02.758626 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:42:02.759028 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:42:02.759272 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:42:02.759458 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m23:42:02.759649 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:42:02.759739 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m23:42:02.759850 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:42:02.760427 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m23:42:02.760109 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m23:42:02.760259 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:42:02.759973 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:42:02.760561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:02.760697 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:02.768877 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:42:02.769066 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:42:02.769341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:42:02.769477 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:42:02.769599 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:42:02.769776 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:42:02.769927 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:42:02.770122 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m23:42:02.770277 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:42:02.770465 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m23:42:02.770642 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m23:42:02.770951 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m23:42:02.772546 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:42:02.772665 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:42:02.774110 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m23:42:02.774373 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:42:02.774262 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:42:02.774855 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m23:42:02.775126 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m23:42:02.775620 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m23:42:02.776088 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m23:42:02.776346 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m23:42:02.776600 [info ] [Thread-3 (]: 4 of 33 PASS not_null_stg_urlhaus_run_date ..................................... [[32mPASS[0m in 0.04s]
[0m23:42:02.776850 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m23:42:02.777128 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m23:42:02.777352 [info ] [Thread-4 (]: 3 of 33 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown .. [[32mPASS[0m in 0.04s]
[0m23:42:02.777632 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:42:02.777927 [error] [Thread-2 (]: 5 of 33 FAIL 21930 not_null_stg_urlhaus_url .................................... [[31mFAIL 21930[0m in 0.04s]
[0m23:42:02.778277 [error] [Thread-1 (]: 6 of 33 FAIL 21930 not_null_stg_urlhaus_url_status ............................. [[31mFAIL 21930[0m in 0.04s]
[0m23:42:02.778669 [debug] [Thread-4 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:42:02.778979 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:42:02.779258 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:42:02.779471 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:42:02.779775 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:42:02.780010 [info ] [Thread-3 (]: 7 of 33 START test not_null_stg_kev_cve_id ..................................... [RUN]
[0m23:42:02.780277 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:42:02.780661 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:42:02.780970 [info ] [Thread-4 (]: 8 of 33 START test not_null_stg_kev_product .................................... [RUN]
[0m23:42:02.781235 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0)
[0m23:42:02.781442 [info ] [Thread-2 (]: 9 of 33 START test not_null_stg_kev_run_date ................................... [RUN]
[0m23:42:02.781722 [info ] [Thread-1 (]: 10 of 33 START test not_null_stg_kev_vendor_project ............................ [RUN]
[0m23:42:02.782080 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now test.threat_risk.not_null_stg_kev_product.9b2d2b4877)
[0m23:42:02.782328 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:42:02.782522 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m23:42:02.785660 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:42:02.782915 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:42:02.785475 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:42:02.782714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m23:42:02.788738 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:42:02.788323 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:42:02.786961 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:42:02.790038 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:42:02.790254 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:42:02.790851 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:42:02.791133 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:42:02.791841 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:42:02.792015 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:42:02.792743 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:42:02.793479 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:42:02.794355 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:42:02.794601 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:42:02.794955 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:42:02.795149 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:42:02.795242 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m23:42:02.795414 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:42:02.795495 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m23:42:02.796081 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:02.795788 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:02.795947 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m23:42:02.795636 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m23:42:02.796507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:02.796673 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:02.803515 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:02.803793 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:42:02.803972 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:02.804117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:02.804283 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m23:42:02.804434 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:02.805020 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:42:02.804788 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:42:02.804586 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:42:02.805520 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m23:42:02.805355 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:42:02.805159 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m23:42:02.809315 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:42:02.809474 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:42:02.809593 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:42:02.809729 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:42:02.810279 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m23:42:02.810780 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m23:42:02.811209 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m23:42:02.811726 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m23:42:02.812010 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m23:42:02.812189 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m23:42:02.812376 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m23:42:02.812556 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m23:42:02.812782 [info ] [Thread-3 (]: 7 of 33 PASS not_null_stg_kev_cve_id ........................................... [[32mPASS[0m in 0.03s]
[0m23:42:02.813089 [info ] [Thread-2 (]: 9 of 33 PASS not_null_stg_kev_run_date ......................................... [[32mPASS[0m in 0.03s]
[0m23:42:02.813414 [info ] [Thread-4 (]: 8 of 33 PASS not_null_stg_kev_product .......................................... [[32mPASS[0m in 0.03s]
[0m23:42:02.813730 [info ] [Thread-1 (]: 10 of 33 PASS not_null_stg_kev_vendor_project .................................. [[32mPASS[0m in 0.03s]
[0m23:42:02.814074 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:42:02.814379 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:42:02.814600 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:42:02.814835 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:42:02.815091 [debug] [Thread-3 (]: Began running node model.threat_risk.dim_url
[0m23:42:02.815340 [debug] [Thread-2 (]: Began running node model.threat_risk.fact_url_events
[0m23:42:02.816427 [info ] [Thread-2 (]: 12 of 33 SKIP relation marts.fact_url_events ................................... [[33mSKIP[0m]
[0m23:42:02.816066 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_product
[0m23:42:02.816202 [info ] [Thread-3 (]: 11 of 33 SKIP relation marts.dim_url ........................................... [[33mSKIP[0m]
[0m23:42:02.815915 [debug] [Thread-4 (]: Began running node model.threat_risk.dim_date
[0m23:42:02.817482 [info ] [Thread-4 (]: 13 of 33 SKIP relation marts.dim_date .......................................... [[33mSKIP[0m]
[0m23:42:02.817024 [info ] [Thread-1 (]: 14 of 33 START sql table model marts.dim_product ............................... [RUN]
[0m23:42:02.817279 [debug] [Thread-3 (]: Finished running node model.threat_risk.dim_url
[0m23:42:02.816758 [debug] [Thread-2 (]: Finished running node model.threat_risk.fact_url_events
[0m23:42:02.818616 [debug] [Thread-2 (]: Began running node model.threat_risk.fact_kev
[0m23:42:02.818040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now model.threat_risk.dim_product)
[0m23:42:02.818293 [debug] [Thread-3 (]: Began running node model.threat_risk.dim_vendor
[0m23:42:02.817758 [debug] [Thread-4 (]: Finished running node model.threat_risk.dim_date
[0m23:42:02.818900 [info ] [Thread-2 (]: 16 of 33 START sql table model marts.fact_kev .................................. [RUN]
[0m23:42:02.819151 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_product
[0m23:42:02.819402 [info ] [Thread-3 (]: 15 of 33 START sql table model marts.dim_vendor ................................ [RUN]
[0m23:42:02.819685 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:42:02.821606 [info ] [Thread-4 (]: 17 of 33 SKIP test not_null_dim_url_url ........................................ [[33mSKIP[0m]
[0m23:42:02.821158 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_product"
[0m23:42:02.821394 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now model.threat_risk.dim_vendor)
[0m23:42:02.819925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now model.threat_risk.fact_kev)
[0m23:42:02.821826 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:42:02.822244 [debug] [Thread-3 (]: Began compiling node model.threat_risk.dim_vendor
[0m23:42:02.822502 [debug] [Thread-2 (]: Began compiling node model.threat_risk.fact_kev
[0m23:42:02.822707 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_product
[0m23:42:02.822863 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:42:02.823857 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.dim_vendor"
[0m23:42:02.824853 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.fact_kev"
[0m23:42:02.833408 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.dim_product"
[0m23:42:02.833690 [info ] [Thread-4 (]: 18 of 33 SKIP test not_null_dim_url_url_key .................................... [[33mSKIP[0m]
[0m23:42:02.834438 [debug] [Thread-3 (]: Began executing node model.threat_risk.dim_vendor
[0m23:42:02.834697 [debug] [Thread-2 (]: Began executing node model.threat_risk.fact_kev
[0m23:42:02.837138 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.fact_kev"
[0m23:42:02.835986 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.dim_vendor"
[0m23:42:02.836203 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:42:02.834903 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:42:02.837545 [debug] [Thread-1 (]: On model.threat_risk.dim_product: BEGIN
[0m23:42:02.837659 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:42:02.837874 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:42:02.837995 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:42:02.838735 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: BEGIN
[0m23:42:02.838346 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: BEGIN
[0m23:42:02.838524 [info ] [Thread-4 (]: 19 of 33 SKIP test unique_dim_url_url .......................................... [[33mSKIP[0m]
[0m23:42:02.838179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:02.838887 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:02.839039 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:02.839209 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:42:02.839865 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:42:02.840097 [info ] [Thread-4 (]: 20 of 33 SKIP test unique_dim_url_url_key ...................................... [[33mSKIP[0m]
[0m23:42:02.840364 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:42:02.841467 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:42:02.841678 [info ] [Thread-4 (]: 21 of 33 SKIP test not_null_fact_url_events_date_day ........................... [[33mSKIP[0m]
[0m23:42:02.841901 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:42:02.842125 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:42:02.842296 [info ] [Thread-4 (]: 22 of 33 SKIP test not_null_fact_url_events_url_key ............................ [[33mSKIP[0m]
[0m23:42:02.842524 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:42:02.843020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:42:02.843169 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:42:02.843323 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */

  
    

  create  table "threat_risk"."marts"."dim_product__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  md5(coalesce(vendor_project,'')) as vendor_key,
  vendor_project,
  product
from (
  select distinct vendor_project, product
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null and product is not null
) p
  );
  
[0m23:42:02.845179 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m23:42:02.845553 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:42:02.845760 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:42:02.846122 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:42:02.845981 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */

  
    

  create  table "threat_risk"."marts"."dim_vendor__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project, '')) as vendor_key,
  vendor_project
from (
  select distinct vendor_project
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null
) v
  );
  
[0m23:42:02.846254 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */

  
    

  create  table "threat_risk"."marts"."fact_kev__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(cve_id,'')) as cve_key,
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  run_date as date_day,
  cve_id,
  vulnerability_name,
  date_added,
  due_date,
  required_action,
  notes
from "threat_risk"."staging"."stg_kev"
where cve_id is not null
  );
  
[0m23:42:02.850391 [debug] [Thread-3 (]: SQL status: SELECT 245 in 0.004 seconds
[0m23:42:02.851732 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:42:02.851865 [debug] [Thread-1 (]: SQL status: SELECT 625 in 0.008 seconds
[0m23:42:02.852016 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor__dbt_tmp" rename to "dim_vendor"
[0m23:42:02.853075 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:42:02.853348 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m23:42:02.853470 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:02.855477 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: COMMIT
[0m23:42:02.855623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:42:02.855808 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:42:02.856409 [debug] [Thread-1 (]: On model.threat_risk.dim_product: COMMIT
[0m23:42:02.856586 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: COMMIT
[0m23:42:02.856756 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:42:02.856998 [debug] [Thread-1 (]: On model.threat_risk.dim_product: COMMIT
[0m23:42:02.858778 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:42:02.859759 [debug] [Thread-3 (]: Applying DROP to: "threat_risk"."marts"."dim_vendor__dbt_backup"
[0m23:42:02.859932 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:42:02.860993 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:42:02.861844 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."marts"."dim_product__dbt_backup"
[0m23:42:02.862027 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
drop table if exists "threat_risk"."marts"."dim_vendor__dbt_backup" cascade
[0m23:42:02.862280 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:42:02.862536 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
drop table if exists "threat_risk"."marts"."dim_product__dbt_backup" cascade
[0m23:42:02.862667 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:42:02.863256 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: Close
[0m23:42:02.863407 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:42:02.863708 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebcb8f6-d2fd-499e-a6d4-2492a46ef295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69a3210>]}
[0m23:42:02.864195 [debug] [Thread-1 (]: On model.threat_risk.dim_product: Close
[0m23:42:02.864475 [info ] [Thread-3 (]: 15 of 33 OK created sql table model marts.dim_vendor ........................... [[32mSELECT 245[0m in 0.04s]
[0m23:42:02.864841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebcb8f6-d2fd-499e-a6d4-2492a46ef295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8744ed0>]}
[0m23:42:02.864985 [debug] [Thread-2 (]: SQL status: SELECT 7440 in 0.018 seconds
[0m23:42:02.865145 [debug] [Thread-3 (]: Finished running node model.threat_risk.dim_vendor
[0m23:42:02.865401 [info ] [Thread-1 (]: 14 of 33 OK created sql table model marts.dim_product .......................... [[32mSELECT 625[0m in 0.05s]
[0m23:42:02.866535 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:42:02.866965 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:42:02.867123 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:42:02.867296 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_product
[0m23:42:02.867460 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev__dbt_tmp" rename to "fact_kev"
[0m23:42:02.867652 [info ] [Thread-4 (]: 23 of 33 START test not_null_dim_vendor_vendor_key ............................. [RUN]
[0m23:42:02.867893 [info ] [Thread-3 (]: 24 of 33 START test not_null_dim_vendor_vendor_project ......................... [RUN]
[0m23:42:02.868157 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:42:02.868545 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m23:42:02.868676 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:02.869807 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: COMMIT
[0m23:42:02.869068 [info ] [Thread-1 (]: 25 of 33 START test unique_dim_vendor_vendor_key ............................... [RUN]
[0m23:42:02.869314 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:42:02.868820 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_vendor, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m23:42:02.871768 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:42:02.870175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_product, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m23:42:02.871590 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:42:02.869966 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:42:02.873072 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:42:02.873280 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:42:02.873625 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: COMMIT
[0m23:42:02.875836 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:42:02.876173 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:42:02.876345 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:42:02.878340 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:42:02.878496 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:42:02.879272 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:42:02.879413 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:42:02.880298 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."marts"."fact_kev__dbt_backup"
[0m23:42:02.881226 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:42:02.881398 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:42:02.881669 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:42:02.881785 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:42:02.881998 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: BEGIN
[0m23:42:02.882194 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
drop table if exists "threat_risk"."marts"."fact_kev__dbt_backup" cascade
[0m23:42:02.882339 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:42:02.882822 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: BEGIN
[0m23:42:02.882603 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:02.882457 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: BEGIN
[0m23:42:02.882924 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:42:02.883046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:02.883296 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:02.883934 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: Close
[0m23:42:02.884475 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebcb8f6-d2fd-499e-a6d4-2492a46ef295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8aeff90>]}
[0m23:42:02.884849 [info ] [Thread-2 (]: 16 of 33 OK created sql table model marts.fact_kev ............................. [[32mSELECT 7440[0m in 0.06s]
[0m23:42:02.885206 [debug] [Thread-2 (]: Finished running node model.threat_risk.fact_kev
[0m23:42:02.885528 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:42:02.885909 [info ] [Thread-2 (]: 26 of 33 START test unique_dim_vendor_vendor_project ........................... [RUN]
[0m23:42:02.887639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_kev, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m23:42:02.888467 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:42:02.890088 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:42:02.890463 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:02.890728 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:42:02.890865 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:42:02.890979 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:02.891173 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_vendor"
where vendor_key is null



      
    ) dbt_internal_test
[0m23:42:02.891299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:02.892068 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:42:02.892257 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:42:02.892517 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:42:02.892825 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_vendor"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:42:02.892970 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:42:02.893148 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_key is not null
group by vendor_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:42:02.893291 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:42:02.893945 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: ROLLBACK
[0m23:42:02.894044 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:42:02.894314 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: BEGIN
[0m23:42:02.894525 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: Close
[0m23:42:02.894920 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: ROLLBACK
[0m23:42:02.895044 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:42:02.895187 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:02.895439 [info ] [Thread-4 (]: 23 of 33 PASS not_null_dim_vendor_vendor_key ................................... [[32mPASS[0m in 0.03s]
[0m23:42:02.895733 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: Close
[0m23:42:02.896267 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: ROLLBACK
[0m23:42:02.896669 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:42:02.897392 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:42:02.897238 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: Close
[0m23:42:02.896930 [info ] [Thread-3 (]: 24 of 33 PASS not_null_dim_vendor_vendor_project ............................... [[32mPASS[0m in 0.03s]
[0m23:42:02.898128 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:42:02.897883 [info ] [Thread-1 (]: 25 of 33 PASS unique_dim_vendor_vendor_key ..................................... [[32mPASS[0m in 0.03s]
[0m23:42:02.897569 [info ] [Thread-4 (]: 27 of 33 START test not_null_dim_product_product ............................... [RUN]
[0m23:42:02.898709 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m23:42:02.898529 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:42:02.898292 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:42:02.898848 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:42:02.899052 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:42:02.899233 [info ] [Thread-3 (]: 28 of 33 START test not_null_dim_product_product_key ........................... [RUN]
[0m23:42:02.901661 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.not_null_dim_product_product_key.f0e1d838d3)
[0m23:42:02.901251 [info ] [Thread-1 (]: 29 of 33 START test not_null_dim_product_vendor_key ............................ [RUN]
[0m23:42:02.901427 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:42:02.900957 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:42:02.901818 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:42:02.902009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68, now test.threat_risk.not_null_dim_product_vendor_key.78836999d2)
[0m23:42:02.902200 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:42:02.904193 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_project as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_project is not null
group by vendor_project
having count(*) > 1



      
    ) dbt_internal_test
[0m23:42:02.903912 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:42:02.904041 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:42:02.903692 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:42:02.905657 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:42:02.905789 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:42:02.906592 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:42:02.907380 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: ROLLBACK
[0m23:42:02.907601 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:42:02.907738 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:42:02.908024 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: Close
[0m23:42:02.908780 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:42:02.908937 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:42:02.909681 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:42:02.909940 [info ] [Thread-2 (]: 26 of 33 PASS unique_dim_vendor_vendor_project ................................. [[32mPASS[0m in 0.02s]
[0m23:42:02.910285 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: BEGIN
[0m23:42:02.910548 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:42:02.911188 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m23:42:02.910936 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:02.911072 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:42:02.910754 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:42:02.911324 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:02.911595 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: BEGIN
[0m23:42:02.911847 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:42:02.912159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:02.912364 [info ] [Thread-2 (]: 30 of 33 START test not_null_dim_product_vendor_project ........................ [RUN]
[0m23:42:02.912809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m23:42:02.913011 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:42:02.915823 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:42:02.916071 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m23:42:02.916381 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:42:02.916819 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product.56a877bc84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."marts"."dim_product"
where product is null



      
    ) dbt_internal_test
[0m23:42:02.917010 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:42:02.917155 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m23:42:02.918109 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:42:02.918221 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:42:02.918341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:42:02.918532 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:42:02.919789 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "threat_risk"."marts"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m23:42:02.919460 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:42:02.919639 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:42:02.919203 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: ROLLBACK
[0m23:42:02.920029 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_product"
where vendor_key is null



      
    ) dbt_internal_test
[0m23:42:02.920208 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: BEGIN
[0m23:42:02.920331 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m23:42:02.920500 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: Close
[0m23:42:02.920679 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:02.921137 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m23:42:02.921235 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:42:02.921500 [info ] [Thread-4 (]: 27 of 33 PASS not_null_dim_product_product ..................................... [[32mPASS[0m in 0.02s]
[0m23:42:02.921948 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: Close
[0m23:42:02.922404 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: ROLLBACK
[0m23:42:02.922669 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:42:02.922900 [info ] [Thread-3 (]: 28 of 33 PASS not_null_dim_product_product_key ................................. [[32mPASS[0m in 0.02s]
[0m23:42:02.923699 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:42:02.923449 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:42:02.923202 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: Close
[0m23:42:02.923874 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:42:02.924059 [info ] [Thread-4 (]: 31 of 33 START test unique_dim_product_product_key ............................. [RUN]
[0m23:42:02.924394 [info ] [Thread-1 (]: 29 of 33 PASS not_null_dim_product_vendor_key .................................. [[32mPASS[0m in 0.02s]
[0m23:42:02.925213 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:42:02.924886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m23:42:02.925018 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:42:02.924602 [info ] [Thread-3 (]: 32 of 33 START test not_null_fact_kev_cve_id ................................... [RUN]
[0m23:42:02.925901 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m23:42:02.925551 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:42:02.925736 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:42:02.925374 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:42:02.928059 [info ] [Thread-1 (]: 33 of 33 START test not_null_fact_kev_date_day ................................. [RUN]
[0m23:42:02.927625 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:42:02.927879 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_product"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:42:02.926038 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:42:02.928235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m23:42:02.930268 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:42:02.929996 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:42:02.930159 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:42:02.929840 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:42:02.931551 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:42:02.932101 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: ROLLBACK
[0m23:42:02.932932 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:42:02.933412 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:42:02.933524 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: Close
[0m23:42:02.934405 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:42:02.934532 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:42:02.934783 [info ] [Thread-2 (]: 30 of 33 PASS not_null_dim_product_vendor_project .............................. [[32mPASS[0m in 0.02s]
[0m23:42:02.934973 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:42:02.935866 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:42:02.936111 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:42:02.936245 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:42:02.936389 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: BEGIN
[0m23:42:02.936796 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: BEGIN
[0m23:42:02.936942 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:42:02.937065 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:02.937209 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:02.937367 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: BEGIN
[0m23:42:02.937859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:02.941698 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:42:02.941931 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:42:02.942071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:42:02.942182 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m23:42:02.942666 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:42:02.942507 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:42:02.942322 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."marts"."fact_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m23:42:02.942810 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:42:02.942977 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_kev"
where date_day is null



      
    ) dbt_internal_test
[0m23:42:02.943920 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:42:02.944595 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m23:42:02.944738 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:42:02.944868 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:42:02.945953 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: ROLLBACK
[0m23:42:02.945459 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: ROLLBACK
[0m23:42:02.945020 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: Close
[0m23:42:02.946553 [info ] [Thread-4 (]: 31 of 33 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.02s]
[0m23:42:02.946336 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: Close
[0m23:42:02.946144 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: Close
[0m23:42:02.946820 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:42:02.947156 [info ] [Thread-1 (]: 33 of 33 PASS not_null_fact_kev_date_day ....................................... [[32mPASS[0m in 0.02s]
[0m23:42:02.947445 [info ] [Thread-3 (]: 32 of 33 PASS not_null_fact_kev_cve_id ......................................... [[32mPASS[0m in 0.02s]
[0m23:42:02.947895 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:42:02.948107 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:42:02.949012 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:02.949174 [debug] [MainThread]: On master: BEGIN
[0m23:42:02.949300 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:02.952565 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:42:02.952720 [debug] [MainThread]: On master: COMMIT
[0m23:42:02.952859 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:02.952998 [debug] [MainThread]: On master: COMMIT
[0m23:42:02.953196 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:02.953333 [debug] [MainThread]: On master: Close
[0m23:42:02.953524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:02.953676 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_kev_date_day.64362f7a33' was properly closed.
[0m23:42:02.953820 [debug] [MainThread]: Connection 'test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15' was properly closed.
[0m23:42:02.953963 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_product_product_key.1753236bd0' was properly closed.
[0m23:42:02.954104 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8' was properly closed.
[0m23:42:02.954324 [info ] [MainThread]: 
[0m23:42:02.954562 [info ] [MainThread]: Finished running 2 view models, 25 data tests, 6 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m23:42:02.955853 [debug] [MainThread]: Command end result
[0m23:42:02.971832 [info ] [MainThread]: 
[0m23:42:02.972110 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m23:42:02.972297 [info ] [MainThread]: 
[0m23:42:02.972682 [error] [MainThread]: [31mFailure in test not_null_stg_urlhaus_url (models/staging/schema.yml)[0m
[0m23:42:02.972878 [error] [MainThread]:   Got 21930 results, configured to fail if != 0
[0m23:42:02.973032 [info ] [MainThread]: 
[0m23:42:02.973249 [info ] [MainThread]:   compiled code at target/compiled/threat_risk/models/staging/schema.yml/not_null_stg_urlhaus_url.sql
[0m23:42:02.973437 [info ] [MainThread]: 
[0m23:42:02.973629 [error] [MainThread]: [31mFailure in test not_null_stg_urlhaus_url_status (models/staging/schema.yml)[0m
[0m23:42:02.973813 [error] [MainThread]:   Got 21930 results, configured to fail if != 0
[0m23:42:02.973949 [info ] [MainThread]: 
[0m23:42:02.974118 [info ] [MainThread]:   compiled code at target/compiled/threat_risk/models/staging/schema.yml/not_null_stg_urlhaus_url_status.sql
[0m23:42:02.974267 [info ] [MainThread]: 
[0m23:42:02.974446 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=2 SKIP=9 TOTAL=33
[0m23:42:02.974898 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.6731463, "process_user_time": 1.050582, "process_kernel_time": 0.109414, "process_mem_max_rss": "126948", "process_out_blocks": "4880", "command_success": false, "process_in_blocks": "0"}
[0m23:42:02.975135 [debug] [MainThread]: Command `dbt build` failed at 23:42:02.975104 after 0.67 seconds
[0m23:42:02.975284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb459cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb459c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb459cb50>]}
[0m23:42:02.975452 [debug] [MainThread]: Flushing usage events
[0m23:46:35.205216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50d5890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50d1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50d6210>]}


============================== 23:46:35.207928 | 5f7b75da-f452-4b0a-afe7-9396267bca66 ==============================
[0m23:46:35.207928 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:46:35.208344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:46:35.254683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb42b9350>]}
[0m23:46:35.271014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75d25d0>]}
[0m23:46:35.271392 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:46:35.292028 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:46:35.333514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:35.333685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:35.346523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5362cd0>]}
[0m23:46:35.386775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e0f850>]}
[0m23:46:35.387026 [info ] [MainThread]: Found 8 models, 25 data tests, 429 macros
[0m23:46:35.388526 [info ] [MainThread]: 
[0m23:46:35.388862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:46:35.390513 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m23:46:35.390785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m23:46:35.404362 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m23:46:35.404501 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m23:46:35.404684 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m23:46:35.404941 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m23:46:35.405103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:35.405319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:35.411479 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m23:46:35.411628 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m23:46:35.412136 [debug] [ThreadPool]: On list_threat_risk: Close
[0m23:46:35.412602 [debug] [ThreadPool]: On list_threat_risk: Close
[0m23:46:35.413641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_staging)
[0m23:46:35.413897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_marts)
[0m23:46:35.415877 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m23:46:35.416602 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m23:46:35.416781 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m23:46:35.416948 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m23:46:35.417130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:35.417312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:35.421150 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:46:35.421306 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:46:35.421458 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m23:46:35.421637 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m23:46:35.421833 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:46:35.422028 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m23:46:35.424018 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m23:46:35.424119 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m23:46:35.424538 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m23:46:35.424955 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m23:46:35.425224 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m23:46:35.425356 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m23:46:35.427572 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:35.427746 [debug] [MainThread]: On master: BEGIN
[0m23:46:35.427879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:35.431031 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:46:35.431227 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:35.431447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:35.433852 [debug] [MainThread]: SQL status: SELECT 4 in 0.002 seconds
[0m23:46:35.434356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb407efd0>]}
[0m23:46:35.434582 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:35.434781 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:35.434933 [debug] [MainThread]: On master: BEGIN
[0m23:46:35.435188 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:46:35.435357 [debug] [MainThread]: On master: COMMIT
[0m23:46:35.435500 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:35.435635 [debug] [MainThread]: On master: COMMIT
[0m23:46:35.435834 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:35.435981 [debug] [MainThread]: On master: Close
[0m23:46:35.436204 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:35.436437 [info ] [MainThread]: 
[0m23:46:35.440652 [debug] [Thread-1 (]: Began running node model.threat_risk.stg_kev
[0m23:46:35.440811 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_urlhaus
[0m23:46:35.441046 [info ] [Thread-1 (]: 1 of 33 START sql view model staging.stg_kev ................................... [RUN]
[0m23:46:35.441483 [info ] [Thread-2 (]: 2 of 33 START sql view model staging.stg_urlhaus ............................... [RUN]
[0m23:46:35.441798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now model.threat_risk.stg_kev)
[0m23:46:35.442033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now model.threat_risk.stg_urlhaus)
[0m23:46:35.442226 [debug] [Thread-1 (]: Began compiling node model.threat_risk.stg_kev
[0m23:46:35.442458 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_urlhaus
[0m23:46:35.444875 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.stg_kev"
[0m23:46:35.445620 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus"
[0m23:46:35.446431 [debug] [Thread-1 (]: Began executing node model.threat_risk.stg_kev
[0m23:46:35.446576 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_urlhaus
[0m23:46:35.458447 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.stg_kev"
[0m23:46:35.459565 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.stg_urlhaus"
[0m23:46:35.460266 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:46:35.460550 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: BEGIN
[0m23:46:35.460416 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:46:35.460857 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: BEGIN
[0m23:46:35.460710 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:35.460997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:35.464214 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m23:46:35.464369 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:46:35.464508 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */

  create view "threat_risk"."staging"."stg_urlhaus__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.urlhaus_recent
),
clean as (
  select
    nullif(trim(url), '') as url,
    nullif(trim(url_status), '') as url_status,
    nullif(trim(host), '') as host,
    date_added,
    nullif(trim(threat), '') as threat,
    nullif(trim(tags), '') as tags,
    nullif(trim(urlhaus_link), '') as urlhaus_link,
    nullif(trim(reporter), '') as reporter,
    larted,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m23:46:35.465598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:46:35.465742 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:46:35.465899 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */

  create view "threat_risk"."staging"."stg_kev__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.kev
),
clean as (
  select
    nullif(trim(cve_id), '') as cve_id,
    nullif(trim(vendor_project), '') as vendor_project,
    nullif(trim(product), '') as product,
    nullif(trim(vulnerability_name), '') as vulnerability_name,
    date_added,
    short_description,
    required_action,
    due_date,
    notes,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m23:46:35.466084 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:46:35.468222 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:46:35.468328 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:46:35.468476 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus" rename to "stg_urlhaus__dbt_backup"
[0m23:46:35.469403 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:46:35.469718 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev" rename to "stg_kev__dbt_backup"
[0m23:46:35.469830 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:46:35.470879 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:46:35.470992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:35.471159 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus__dbt_tmp" rename to "stg_urlhaus"
[0m23:46:35.472326 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:46:35.472582 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev__dbt_tmp" rename to "stg_kev"
[0m23:46:35.472710 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:46:35.477930 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m23:46:35.478022 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:46:35.478632 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m23:46:35.478199 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:46:35.478934 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m23:46:35.478785 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:46:35.479163 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m23:46:35.479593 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m23:46:35.479705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:46:35.482426 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."staging"."stg_urlhaus__dbt_backup"
[0m23:46:35.483217 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."staging"."stg_kev__dbt_backup"
[0m23:46:35.485013 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:46:35.484818 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:46:35.485296 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
drop view if exists "threat_risk"."staging"."stg_urlhaus__dbt_backup" cascade
[0m23:46:35.485155 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
drop view if exists "threat_risk"."staging"."stg_kev__dbt_backup" cascade
[0m23:46:35.486558 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:46:35.486681 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:46:35.487993 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: Close
[0m23:46:35.487587 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: Close
[0m23:46:35.488630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2903c50>]}
[0m23:46:35.488789 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4089010>]}
[0m23:46:35.489297 [info ] [Thread-2 (]: 2 of 33 OK created sql view model staging.stg_urlhaus .......................... [[32mCREATE VIEW[0m in 0.05s]
[0m23:46:35.489043 [info ] [Thread-1 (]: 1 of 33 OK created sql view model staging.stg_kev .............................. [[32mCREATE VIEW[0m in 0.05s]
[0m23:46:35.489807 [debug] [Thread-1 (]: Finished running node model.threat_risk.stg_kev
[0m23:46:35.489611 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_urlhaus
[0m23:46:35.490302 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:46:35.490469 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:46:35.490613 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:46:35.490722 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:46:35.490868 [info ] [Thread-4 (]: 3 of 33 START test not_null_stg_kev_cve_id ..................................... [RUN]
[0m23:46:35.491100 [info ] [Thread-3 (]: 4 of 33 START test not_null_stg_kev_product .................................... [RUN]
[0m23:46:35.491321 [info ] [Thread-1 (]: 5 of 33 START test not_null_stg_kev_run_date ................................... [RUN]
[0m23:46:35.492276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_kev, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m23:46:35.491900 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0'
[0m23:46:35.492121 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.threat_risk.not_null_stg_kev_product.9b2d2b4877'
[0m23:46:35.491561 [info ] [Thread-2 (]: 6 of 33 START test not_null_stg_kev_vendor_project ............................. [RUN]
[0m23:46:35.492900 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m23:46:35.492583 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:46:35.492743 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:46:35.492416 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:46:35.493038 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:46:35.497272 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:46:35.498584 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:46:35.499782 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:46:35.500970 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:46:35.501832 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:46:35.502150 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:46:35.502280 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:46:35.508918 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:46:35.508030 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:46:35.508156 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:46:35.507232 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:46:35.509886 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:46:35.510164 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:46:35.510347 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:46:35.510602 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:46:35.511265 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m23:46:35.510913 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m23:46:35.511041 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:46:35.510752 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m23:46:35.511865 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:46:35.511542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:35.511707 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m23:46:35.511402 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:46:35.512316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:35.519236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:35.519521 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:46:35.519791 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m23:46:35.519940 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:35.520044 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:46:35.520160 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:35.520380 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:46:35.520865 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m23:46:35.520691 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:46:35.520523 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:46:35.521103 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:46:35.521278 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m23:46:35.522312 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:35.522467 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:35.523899 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m23:46:35.524045 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:46:35.524188 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:46:35.524589 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m23:46:35.524882 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m23:46:35.525301 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m23:46:35.525845 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m23:46:35.526118 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m23:46:35.526377 [info ] [Thread-1 (]: 5 of 33 PASS not_null_stg_kev_run_date ......................................... [[32mPASS[0m in 0.03s]
[0m23:46:35.526718 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m23:46:35.526952 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m23:46:35.527222 [info ] [Thread-4 (]: 3 of 33 PASS not_null_stg_kev_cve_id ........................................... [[32mPASS[0m in 0.04s]
[0m23:46:35.527566 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:46:35.527904 [info ] [Thread-2 (]: 6 of 33 PASS not_null_stg_kev_vendor_project ................................... [[32mPASS[0m in 0.03s]
[0m23:46:35.528313 [info ] [Thread-3 (]: 4 of 33 PASS not_null_stg_kev_product .......................................... [[32mPASS[0m in 0.04s]
[0m23:46:35.529471 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:46:35.528898 [debug] [Thread-1 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:46:35.529229 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:46:35.528608 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:46:35.530446 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:46:35.529904 [info ] [Thread-1 (]: 7 of 33 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m23:46:35.530192 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:46:35.529663 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:46:35.530707 [info ] [Thread-4 (]: 10 of 33 START test not_null_stg_urlhaus_url_status ............................ [RUN]
[0m23:46:35.531005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41)
[0m23:46:35.531279 [info ] [Thread-2 (]: 9 of 33 START test not_null_stg_urlhaus_url .................................... [RUN]
[0m23:46:35.531640 [info ] [Thread-3 (]: 8 of 33 START test not_null_stg_urlhaus_run_date ............................... [RUN]
[0m23:46:35.532603 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93)
[0m23:46:35.532166 [debug] [Thread-1 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:46:35.532409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m23:46:35.531926 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m23:46:35.532766 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:46:35.536943 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:46:35.537196 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:46:35.537374 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:46:35.559226 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:46:35.560795 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:46:35.562172 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:46:35.562398 [debug] [Thread-1 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:46:35.562865 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:46:35.563190 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:46:35.563937 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:46:35.564142 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:46:35.564831 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:46:35.565568 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:46:35.566491 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:46:35.566718 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:46:35.567139 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:46:35.567318 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m23:46:35.567430 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:46:35.567606 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:46:35.567696 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m23:46:35.568295 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:35.567979 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m23:46:35.568136 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m23:46:35.567838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:35.568582 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:35.568764 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:35.573891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:46:35.574179 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:46:35.574455 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m23:46:35.574626 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:46:35.574899 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:46:35.575202 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:46:35.575343 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:46:35.575907 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:46:35.575730 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m23:46:35.575522 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:46:35.576310 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m23:46:35.576051 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m23:46:35.578377 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:35.579004 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m23:46:35.579151 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:46:35.579315 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:46:35.579461 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:46:35.580918 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m23:46:35.580018 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m23:46:35.580506 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m23:46:35.579593 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m23:46:35.581118 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m23:46:35.581344 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m23:46:35.581567 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m23:46:35.581806 [info ] [Thread-3 (]: 8 of 33 PASS not_null_stg_urlhaus_run_date ..................................... [[32mPASS[0m in 0.05s]
[0m23:46:35.582158 [info ] [Thread-2 (]: 9 of 33 PASS not_null_stg_urlhaus_url .......................................... [[32mPASS[0m in 0.05s]
[0m23:46:35.582544 [info ] [Thread-4 (]: 10 of 33 PASS not_null_stg_urlhaus_url_status .................................. [[32mPASS[0m in 0.05s]
[0m23:46:35.582831 [info ] [Thread-1 (]: 7 of 33 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown .. [[32mPASS[0m in 0.05s]
[0m23:46:35.583835 [debug] [Thread-1 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:46:35.584037 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_product
[0m23:46:35.583594 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:46:35.583106 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:46:35.583330 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:46:35.584335 [info ] [Thread-1 (]: 11 of 33 START sql table model marts.dim_product ............................... [RUN]
[0m23:46:35.584629 [debug] [Thread-4 (]: Began running node model.threat_risk.dim_vendor
[0m23:46:35.584895 [debug] [Thread-3 (]: Began running node model.threat_risk.fact_kev
[0m23:46:35.585299 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_date
[0m23:46:35.585506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now model.threat_risk.dim_product)
[0m23:46:35.585762 [info ] [Thread-4 (]: 12 of 33 START sql table model marts.dim_vendor ................................ [RUN]
[0m23:46:35.586147 [info ] [Thread-3 (]: 13 of 33 START sql table model marts.fact_kev .................................. [RUN]
[0m23:46:35.586405 [info ] [Thread-2 (]: 14 of 33 START sql table model marts.dim_date .................................. [RUN]
[0m23:46:35.586698 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_product
[0m23:46:35.586937 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now model.threat_risk.dim_vendor)
[0m23:46:35.587161 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now model.threat_risk.fact_kev)
[0m23:46:35.589236 [debug] [Thread-3 (]: Began compiling node model.threat_risk.fact_kev
[0m23:46:35.588792 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_product"
[0m23:46:35.589038 [debug] [Thread-4 (]: Began compiling node model.threat_risk.dim_vendor
[0m23:46:35.587444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now model.threat_risk.dim_date)
[0m23:46:35.591684 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_date
[0m23:46:35.591452 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.dim_vendor"
[0m23:46:35.590199 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.fact_kev"
[0m23:46:35.592700 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_date"
[0m23:46:35.592845 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_product
[0m23:46:35.593449 [debug] [Thread-4 (]: Began executing node model.threat_risk.dim_vendor
[0m23:46:35.593572 [debug] [Thread-3 (]: Began executing node model.threat_risk.fact_kev
[0m23:46:35.601949 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.dim_product"
[0m23:46:35.603203 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.dim_vendor"
[0m23:46:35.603365 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_date
[0m23:46:35.604421 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.fact_kev"
[0m23:46:35.605899 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.dim_date"
[0m23:46:35.606169 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:46:35.606329 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:46:35.606767 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:46:35.606900 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: BEGIN
[0m23:46:35.607117 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:46:35.607216 [debug] [Thread-1 (]: On model.threat_risk.dim_product: BEGIN
[0m23:46:35.607878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:35.607548 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:35.607710 [debug] [Thread-2 (]: On model.threat_risk.dim_date: BEGIN
[0m23:46:35.607384 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: BEGIN
[0m23:46:35.608321 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:35.608538 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:35.612674 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:46:35.612852 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:46:35.612987 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */

  
    

  create  table "threat_risk"."marts"."dim_product__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  md5(coalesce(vendor_project,'')) as vendor_key,
  vendor_project,
  product
from (
  select distinct vendor_project, product
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null and product is not null
) p
  );
  
[0m23:46:35.613293 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m23:46:35.613430 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m23:46:35.613652 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:46:35.613800 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:46:35.613960 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:46:35.614165 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */

  
    

  create  table "threat_risk"."marts"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with dates as (
  select distinct run_date as d from "threat_risk"."staging"."stg_kev"
  union
  select distinct run_date as d from "threat_risk"."staging"."stg_urlhaus"
),
final as (
  select
    d as date_day,
    extract(year from d)::int as year,
    extract(month from d)::int as month,
    extract(day from d)::int as day
  from dates
)
select * from final
  );
  
[0m23:46:35.614340 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:46:35.614542 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */

  
    

  create  table "threat_risk"."marts"."fact_kev__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(cve_id,'')) as cve_key,
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  run_date as date_day,
  cve_id,
  vulnerability_name,
  date_added,
  due_date,
  required_action,
  notes
from "threat_risk"."staging"."stg_kev"
where cve_id is not null
  );
  
[0m23:46:35.614817 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */

  
    

  create  table "threat_risk"."marts"."dim_vendor__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project, '')) as vendor_key,
  vendor_project
from (
  select distinct vendor_project
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null
) v
  );
  
[0m23:46:35.619274 [debug] [Thread-4 (]: SQL status: SELECT 245 in 0.004 seconds
[0m23:46:35.620638 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:46:35.621006 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor" rename to "dim_vendor__dbt_backup"
[0m23:46:35.620891 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:46:35.620762 [debug] [Thread-1 (]: SQL status: SELECT 625 in 0.008 seconds
[0m23:46:35.622083 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:46:35.622228 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:35.623338 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:46:35.623555 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:46:35.624573 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:46:35.625009 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor__dbt_tmp" rename to "dim_vendor"
[0m23:46:35.624754 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product" rename to "dim_product__dbt_backup"
[0m23:46:35.625142 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:46:35.627055 [debug] [Thread-2 (]: On model.threat_risk.dim_date: COMMIT
[0m23:46:35.627199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:46:35.627292 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:46:35.627432 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:46:35.628478 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:46:35.629342 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m23:46:35.629140 [debug] [Thread-2 (]: On model.threat_risk.dim_date: COMMIT
[0m23:46:35.628939 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: COMMIT
[0m23:46:35.629859 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:46:35.629660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:46:35.630531 [debug] [Thread-1 (]: On model.threat_risk.dim_product: COMMIT
[0m23:46:35.630021 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: COMMIT
[0m23:46:35.630674 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:46:35.630997 [debug] [Thread-1 (]: On model.threat_risk.dim_product: COMMIT
[0m23:46:35.631306 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:46:35.632189 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."marts"."dim_date__dbt_backup"
[0m23:46:35.632342 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:46:35.632440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:46:35.633441 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:46:35.633597 [debug] [Thread-3 (]: SQL status: SELECT 8928 in 0.019 seconds
[0m23:46:35.635034 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."marts"."dim_vendor__dbt_backup"
[0m23:46:35.635798 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."marts"."dim_product__dbt_backup"
[0m23:46:35.635987 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
drop table if exists "threat_risk"."marts"."dim_date__dbt_backup" cascade
[0m23:46:35.636969 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:46:35.637209 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:46:35.637978 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
drop table if exists "threat_risk"."marts"."dim_vendor__dbt_backup" cascade
[0m23:46:35.637717 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev" rename to "fact_kev__dbt_backup"
[0m23:46:35.637839 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:46:35.637458 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:46:35.638593 [debug] [Thread-2 (]: On model.threat_risk.dim_date: Close
[0m23:46:35.638714 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:35.638897 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
drop table if exists "threat_risk"."marts"."dim_product__dbt_backup" cascade
[0m23:46:35.639221 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb295dc10>]}
[0m23:46:35.640251 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:46:35.640382 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:46:35.640739 [info ] [Thread-2 (]: 14 of 33 OK created sql table model marts.dim_date ............................. [[32mSELECT 1[0m in 0.05s]
[0m23:46:35.641020 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev__dbt_tmp" rename to "fact_kev"
[0m23:46:35.641704 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: Close
[0m23:46:35.641866 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:46:35.642124 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_date
[0m23:46:35.642503 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb400cb90>]}
[0m23:46:35.642624 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:46:35.643120 [debug] [Thread-1 (]: On model.threat_risk.dim_product: Close
[0m23:46:35.643335 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_url
[0m23:46:35.643615 [info ] [Thread-4 (]: 12 of 33 OK created sql table model marts.dim_vendor ........................... [[32mSELECT 245[0m in 0.06s]
[0m23:46:35.644253 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: COMMIT
[0m23:46:35.644484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb28c4bd0>]}
[0m23:46:35.644684 [info ] [Thread-2 (]: 15 of 33 START sql table model marts.dim_url ................................... [RUN]
[0m23:46:35.644991 [debug] [Thread-4 (]: Finished running node model.threat_risk.dim_vendor
[0m23:46:35.645184 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:46:35.645432 [info ] [Thread-1 (]: 11 of 33 OK created sql table model marts.dim_product .......................... [[32mSELECT 625[0m in 0.06s]
[0m23:46:35.645716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_date, now model.threat_risk.dim_url)
[0m23:46:35.645915 [debug] [Thread-4 (]: Began running node model.threat_risk.fact_url_events
[0m23:46:35.646361 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: COMMIT
[0m23:46:35.646580 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_product
[0m23:46:35.646769 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_url
[0m23:46:35.646959 [info ] [Thread-4 (]: 16 of 33 START sql table model marts.fact_url_events ........................... [RUN]
[0m23:46:35.648816 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_vendor, now model.threat_risk.fact_url_events)
[0m23:46:35.647522 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m23:46:35.648624 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_url"
[0m23:46:35.647355 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:46:35.650203 [info ] [Thread-1 (]: 17 of 33 START test not_null_dim_vendor_vendor_key ............................. [RUN]
[0m23:46:35.649845 [debug] [Thread-3 (]: Applying DROP to: "threat_risk"."marts"."fact_kev__dbt_backup"
[0m23:46:35.648957 [debug] [Thread-4 (]: Began compiling node model.threat_risk.fact_url_events
[0m23:46:35.650514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_product, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m23:46:35.650704 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_url
[0m23:46:35.650935 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:46:35.651829 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.fact_url_events"
[0m23:46:35.652015 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:46:35.653162 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.dim_url"
[0m23:46:35.653326 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
drop table if exists "threat_risk"."marts"."fact_kev__dbt_backup" cascade
[0m23:46:35.654839 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:46:35.655070 [debug] [Thread-4 (]: Began executing node model.threat_risk.fact_url_events
[0m23:46:35.655493 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:46:35.657203 [debug] [Thread-2 (]: On model.threat_risk.dim_url: BEGIN
[0m23:46:35.657002 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:46:35.656820 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.fact_url_events"
[0m23:46:35.657352 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:35.657520 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:46:35.657961 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: Close
[0m23:46:35.658351 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:46:35.659172 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:46:35.659430 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb28b1790>]}
[0m23:46:35.659624 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: BEGIN
[0m23:46:35.659995 [info ] [Thread-3 (]: 13 of 33 OK created sql table model marts.fact_kev ............................. [[32mSELECT 8928[0m in 0.07s]
[0m23:46:35.660189 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:35.660471 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:46:35.660630 [debug] [Thread-3 (]: Finished running node model.threat_risk.fact_kev
[0m23:46:35.661219 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: BEGIN
[0m23:46:35.661539 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:46:35.661679 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:46:35.663210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:35.663426 [info ] [Thread-3 (]: 18 of 33 START test not_null_dim_vendor_vendor_project ......................... [RUN]
[0m23:46:35.663734 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:46:35.664007 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m23:46:35.664645 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:46:35.664478 [debug] [Thread-2 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */

  
    

  create  table "threat_risk"."marts"."dim_url__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  url,
  host
from (
  select distinct url, host
  from "threat_risk"."staging"."stg_urlhaus"
  where url is not null
) u
  );
  
[0m23:46:35.664284 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_kev, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m23:46:35.665044 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:46:35.664800 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */

  
    

  create  table "threat_risk"."marts"."fact_url_events__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  run_date as date_day,
  url_status,
  threat,
  tags,
  date_added,
  reporter,
  larted
from "threat_risk"."staging"."stg_urlhaus"
where url is not null
  );
  
[0m23:46:35.668778 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:46:35.669142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:46:35.669364 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:46:35.669705 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_vendor"
where vendor_key is null



      
    ) dbt_internal_test
[0m23:46:35.669544 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:46:35.670825 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:46:35.670962 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:35.671706 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: ROLLBACK
[0m23:46:35.672083 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:46:35.672553 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: BEGIN
[0m23:46:35.672724 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:35.672363 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: Close
[0m23:46:35.673262 [info ] [Thread-1 (]: 17 of 33 PASS not_null_dim_vendor_vendor_key ................................... [[32mPASS[0m in 0.02s]
[0m23:46:35.673685 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:46:35.673920 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:46:35.675215 [info ] [Thread-1 (]: 19 of 33 START test unique_dim_vendor_vendor_key ............................... [RUN]
[0m23:46:35.675476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m23:46:35.675678 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:46:35.678117 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:46:35.678391 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m23:46:35.678676 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:46:35.678929 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_vendor"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:46:35.678802 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:46:35.679847 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:46:35.679954 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:35.680687 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: ROLLBACK
[0m23:46:35.680924 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:46:35.681151 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: BEGIN
[0m23:46:35.681017 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: Close
[0m23:46:35.681505 [info ] [Thread-3 (]: 18 of 33 PASS not_null_dim_vendor_vendor_project ............................... [[32mPASS[0m in 0.02s]
[0m23:46:35.681277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:35.681826 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:46:35.682219 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:46:35.682526 [info ] [Thread-3 (]: 20 of 33 START test unique_dim_vendor_vendor_project ........................... [RUN]
[0m23:46:35.682951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m23:46:35.683422 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:46:35.686411 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:46:35.686725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:46:35.687002 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:46:35.687307 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_key is not null
group by vendor_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:46:35.687156 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:46:35.688209 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:46:35.688330 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:35.688967 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: ROLLBACK
[0m23:46:35.689185 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:46:35.689440 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: BEGIN
[0m23:46:35.689285 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: Close
[0m23:46:35.689894 [info ] [Thread-1 (]: 19 of 33 PASS unique_dim_vendor_vendor_key ..................................... [[32mPASS[0m in 0.01s]
[0m23:46:35.689642 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:35.690216 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:46:35.690594 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:46:35.690853 [info ] [Thread-1 (]: 21 of 33 START test not_null_dim_product_product ............................... [RUN]
[0m23:46:35.691087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m23:46:35.692344 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:46:35.694468 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:46:35.694770 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m23:46:35.695037 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:46:35.695319 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_project as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_project is not null
group by vendor_project
having count(*) > 1



      
    ) dbt_internal_test
[0m23:46:35.695169 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:46:35.696250 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:46:35.696377 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:35.697033 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: ROLLBACK
[0m23:46:35.697267 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:46:35.697476 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: BEGIN
[0m23:46:35.697368 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: Close
[0m23:46:35.697596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:35.697748 [debug] [Thread-2 (]: SQL status: SELECT 22497 in 0.033 seconds
[0m23:46:35.697923 [info ] [Thread-3 (]: 20 of 33 PASS unique_dim_vendor_vendor_project ................................. [[32mPASS[0m in 0.02s]
[0m23:46:35.699396 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:46:35.700691 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:46:35.700911 [debug] [Thread-2 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url__dbt_tmp" rename to "dim_url"
[0m23:46:35.701179 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:46:35.701593 [info ] [Thread-3 (]: 22 of 33 START test not_null_dim_product_product_key ........................... [RUN]
[0m23:46:35.701366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:46:35.701718 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:46:35.701928 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96, now test.threat_risk.not_null_dim_product_product_key.f0e1d838d3)
[0m23:46:35.702819 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:46:35.702654 [debug] [Thread-2 (]: On model.threat_risk.dim_url: COMMIT
[0m23:46:35.702086 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:46:35.704955 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product.56a877bc84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."marts"."dim_product"
where product is null



      
    ) dbt_internal_test
[0m23:46:35.704689 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:46:35.704810 [debug] [Thread-4 (]: SQL status: SELECT 22497 in 0.036 seconds
[0m23:46:35.704489 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:46:35.705194 [debug] [Thread-2 (]: On model.threat_risk.dim_url: COMMIT
[0m23:46:35.706270 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:46:35.706407 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:35.706797 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events__dbt_tmp" rename to "fact_url_events"
[0m23:46:35.706959 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:46:35.707534 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: ROLLBACK
[0m23:46:35.708610 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:46:35.708896 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:35.709148 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: Close
[0m23:46:35.711011 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: COMMIT
[0m23:46:35.711408 [info ] [Thread-1 (]: 21 of 33 PASS not_null_dim_product_product ..................................... [[32mPASS[0m in 0.02s]
[0m23:46:35.711640 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:46:35.711841 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:46:35.712510 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: COMMIT
[0m23:46:35.712356 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m23:46:35.712061 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:46:35.712728 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:35.712935 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:46:35.713358 [info ] [Thread-1 (]: 23 of 33 START test not_null_dim_product_vendor_key ............................ [RUN]
[0m23:46:35.713689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.not_null_dim_product_vendor_key.78836999d2)
[0m23:46:35.713874 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:46:35.715520 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:46:35.715993 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:46:35.716916 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:46:35.717066 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:46:35.717547 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m23:46:35.717655 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m23:46:35.717842 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:46:35.718736 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."marts"."dim_url__dbt_backup"
[0m23:46:35.718872 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:46:35.719721 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."marts"."fact_url_events__dbt_backup"
[0m23:46:35.720541 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:46:35.720177 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:46:35.720336 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: BEGIN
[0m23:46:35.719902 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "threat_risk"."marts"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m23:46:35.720677 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
drop table if exists "threat_risk"."marts"."fact_url_events__dbt_backup" cascade
[0m23:46:35.720834 [debug] [Thread-2 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
drop table if exists "threat_risk"."marts"."dim_url__dbt_backup" cascade
[0m23:46:35.721000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:35.721340 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:46:35.721549 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:46:35.721653 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:35.722264 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: Close
[0m23:46:35.723583 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb06e1490>]}
[0m23:46:35.723323 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m23:46:35.722721 [debug] [Thread-2 (]: On model.threat_risk.dim_url: Close
[0m23:46:35.723837 [info ] [Thread-4 (]: 16 of 33 OK created sql table model marts.fact_url_events ...................... [[32mSELECT 22497[0m in 0.07s]
[0m23:46:35.724152 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: Close
[0m23:46:35.724440 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7b75da-f452-4b0a-afe7-9396267bca66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0713d10>]}
[0m23:46:35.725427 [info ] [Thread-2 (]: 15 of 33 OK created sql table model marts.dim_url .............................. [[32mSELECT 22497[0m in 0.08s]
[0m23:46:35.725005 [info ] [Thread-3 (]: 22 of 33 PASS not_null_dim_product_product_key ................................. [[32mPASS[0m in 0.02s]
[0m23:46:35.725172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:46:35.724707 [debug] [Thread-4 (]: Finished running node model.threat_risk.fact_url_events
[0m23:46:35.725745 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_url
[0m23:46:35.726016 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:46:35.726199 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:46:35.726413 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:46:35.726695 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:46:35.726966 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:46:35.727170 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_product"
where vendor_key is null



      
    ) dbt_internal_test
[0m23:46:35.727349 [info ] [Thread-4 (]: 24 of 33 START test not_null_dim_product_vendor_project ........................ [RUN]
[0m23:46:35.727546 [info ] [Thread-2 (]: 25 of 33 START test unique_dim_product_product_key ............................. [RUN]
[0m23:46:35.727790 [info ] [Thread-3 (]: 26 of 33 START test not_null_fact_kev_cve_id ................................... [RUN]
[0m23:46:35.728172 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_url_events, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m23:46:35.728897 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:46:35.728540 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:35.728736 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m23:46:35.728357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_url, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m23:46:35.731383 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:46:35.731025 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: ROLLBACK
[0m23:46:35.731221 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:46:35.730472 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:46:35.732715 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:46:35.732988 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: Close
[0m23:46:35.734186 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:46:35.734757 [info ] [Thread-1 (]: 23 of 33 PASS not_null_dim_product_vendor_key .................................. [[32mPASS[0m in 0.02s]
[0m23:46:35.735102 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:46:35.735240 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:46:35.735561 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:46:35.736438 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:46:35.736646 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:46:35.737367 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:46:35.737562 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:46:35.738555 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:46:35.738768 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:46:35.738955 [info ] [Thread-1 (]: 27 of 33 START test not_null_fact_kev_date_day ................................. [RUN]
[0m23:46:35.739134 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:46:35.739425 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: BEGIN
[0m23:46:35.739622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m23:46:35.739745 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:46:35.740369 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: BEGIN
[0m23:46:35.740056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:35.740210 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:46:35.739915 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: BEGIN
[0m23:46:35.742268 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:35.742077 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:46:35.740505 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:35.743577 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:46:35.746630 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:46:35.746786 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:46:35.747077 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:46:35.747218 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:46:35.747330 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m23:46:35.747536 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:46:35.748178 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: BEGIN
[0m23:46:35.747840 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:46:35.748015 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:46:35.747676 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:46:35.748718 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."marts"."fact_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m23:46:35.748555 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_product"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:46:35.748309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:35.749312 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m23:46:35.749443 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:35.750044 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: ROLLBACK
[0m23:46:35.750580 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m23:46:35.751088 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: Close
[0m23:46:35.750932 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: Close
[0m23:46:35.750729 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:35.751394 [info ] [Thread-2 (]: 25 of 33 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.02s]
[0m23:46:35.751627 [info ] [Thread-4 (]: 24 of 33 PASS not_null_dim_product_vendor_project .............................. [[32mPASS[0m in 0.02s]
[0m23:46:35.752313 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: ROLLBACK
[0m23:46:35.752630 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:46:35.752754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:46:35.752989 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:46:35.753219 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: Close
[0m23:46:35.753365 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:46:35.753562 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:46:35.753754 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:46:35.754028 [info ] [Thread-3 (]: 26 of 33 PASS not_null_fact_kev_cve_id ......................................... [[32mPASS[0m in 0.03s]
[0m23:46:35.754294 [info ] [Thread-2 (]: 28 of 33 START test not_null_fact_url_events_date_day .......................... [RUN]
[0m23:46:35.754593 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_kev"
where date_day is null



      
    ) dbt_internal_test
[0m23:46:35.754819 [info ] [Thread-4 (]: 29 of 33 START test not_null_fact_url_events_url_key ........................... [RUN]
[0m23:46:35.755098 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:46:35.755310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_product_product_key.1753236bd0, now test.threat_risk.not_null_fact_url_events_date_day.d658eee263)
[0m23:46:35.755576 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15, now test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d)
[0m23:46:35.755766 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:46:35.755958 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:46:35.756157 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:46:35.756326 [info ] [Thread-3 (]: 30 of 33 START test not_null_dim_url_url ....................................... [RUN]
[0m23:46:35.759801 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8, now test.threat_risk.not_null_dim_url_url.2b67971659)
[0m23:46:35.758200 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:46:35.759616 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:46:35.756444 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:35.760876 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: ROLLBACK
[0m23:46:35.759940 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:46:35.761054 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:46:35.761370 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:46:35.762592 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:46:35.762711 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: Close
[0m23:46:35.763511 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:46:35.764256 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:46:35.764766 [info ] [Thread-1 (]: 27 of 33 PASS not_null_fact_kev_date_day ....................................... [[32mPASS[0m in 0.03s]
[0m23:46:35.765140 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:46:35.765560 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:46:35.765701 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:46:35.766529 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:46:35.766673 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:46:35.766836 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:46:35.767029 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: BEGIN
[0m23:46:35.767285 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: BEGIN
[0m23:46:35.767490 [info ] [Thread-1 (]: 31 of 33 START test not_null_dim_url_url_key ................................... [RUN]
[0m23:46:35.767640 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:46:35.768369 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: BEGIN
[0m23:46:35.768000 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:35.768207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_date_day.64362f7a33, now test.threat_risk.not_null_dim_url_url_key.89914b0872)
[0m23:46:35.767827 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:35.768500 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:35.768767 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:46:35.770776 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:46:35.771762 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:46:35.773047 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:46:35.774444 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:46:35.774574 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: BEGIN
[0m23:46:35.774709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:35.775192 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:46:35.775417 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:46:35.775821 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_url_events"
where date_day is null



      
    ) dbt_internal_test
[0m23:46:35.775635 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:46:35.776186 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:46:35.776367 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:35.776594 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url.2b67971659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."dim_url"
where url is null



      
    ) dbt_internal_test
[0m23:46:35.776787 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:46:35.777051 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."fact_url_events"
where url_key is null



      
    ) dbt_internal_test
[0m23:46:35.777849 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:35.778502 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: ROLLBACK
[0m23:46:35.778652 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:35.778766 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:35.778894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:46:35.779098 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: Close
[0m23:46:35.779584 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: ROLLBACK
[0m23:46:35.780105 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: ROLLBACK
[0m23:46:35.780310 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:46:35.780604 [info ] [Thread-2 (]: 28 of 33 PASS not_null_fact_url_events_date_day ................................ [[32mPASS[0m in 0.03s]
[0m23:46:35.780922 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: Close
[0m23:46:35.781130 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: Close
[0m23:46:35.781259 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url_key.89914b0872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."dim_url"
where url_key is null



      
    ) dbt_internal_test
[0m23:46:35.781494 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:46:35.781757 [info ] [Thread-4 (]: 29 of 33 PASS not_null_fact_url_events_url_key ................................. [[32mPASS[0m in 0.03s]
[0m23:46:35.782065 [info ] [Thread-3 (]: 30 of 33 PASS not_null_dim_url_url ............................................. [[32mPASS[0m in 0.02s]
[0m23:46:35.782917 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:46:35.782710 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:46:35.782459 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:46:35.783492 [info ] [Thread-2 (]: 32 of 33 START test unique_dim_url_url ......................................... [RUN]
[0m23:46:35.783244 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:35.783072 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:46:35.783719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_url_events_date_day.d658eee263, now test.threat_risk.unique_dim_url_url.4c561dc36d)
[0m23:46:35.784269 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: ROLLBACK
[0m23:46:35.784451 [info ] [Thread-3 (]: 33 of 33 START test unique_dim_url_url_key ..................................... [RUN]
[0m23:46:35.785016 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url.2b67971659, now test.threat_risk.unique_dim_url_url_key.d67ee5b979)
[0m23:46:35.784888 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: Close
[0m23:46:35.784659 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:46:35.785179 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:46:35.785423 [info ] [Thread-1 (]: 31 of 33 PASS not_null_dim_url_url_key ......................................... [[32mPASS[0m in 0.02s]
[0m23:46:35.787123 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:46:35.788392 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:46:35.788749 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:46:35.789413 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:46:35.789564 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:46:35.790530 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:46:35.792303 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:46:35.792789 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:46:35.792916 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:46:35.793175 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: BEGIN
[0m23:46:35.793031 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: BEGIN
[0m23:46:35.793434 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:35.793311 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:35.796850 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m23:46:35.797005 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:46:35.797152 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url.4c561dc36d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m23:46:35.797508 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:46:35.797656 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:46:35.797800 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url_key.d67ee5b979"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url_key is not null
group by url_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:46:35.801887 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:46:35.802477 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: ROLLBACK
[0m23:46:35.802570 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:46:35.803131 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: ROLLBACK
[0m23:46:35.802758 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: Close
[0m23:46:35.803627 [info ] [Thread-2 (]: 32 of 33 PASS unique_dim_url_url ............................................... [[32mPASS[0m in 0.02s]
[0m23:46:35.803379 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: Close
[0m23:46:35.803902 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:46:35.804153 [info ] [Thread-3 (]: 33 of 33 PASS unique_dim_url_url_key ........................................... [[32mPASS[0m in 0.02s]
[0m23:46:35.804571 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:46:35.805443 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:35.805641 [debug] [MainThread]: On master: BEGIN
[0m23:46:35.805791 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:35.808976 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:46:35.809150 [debug] [MainThread]: On master: COMMIT
[0m23:46:35.809295 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:35.809427 [debug] [MainThread]: On master: COMMIT
[0m23:46:35.809615 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:35.809751 [debug] [MainThread]: On master: Close
[0m23:46:35.809948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:35.810114 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url.4c561dc36d' was properly closed.
[0m23:46:35.810258 [debug] [MainThread]: Connection 'test.threat_risk.not_null_dim_url_url_key.89914b0872' was properly closed.
[0m23:46:35.810406 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d' was properly closed.
[0m23:46:35.810564 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url_key.d67ee5b979' was properly closed.
[0m23:46:35.810797 [info ] [MainThread]: 
[0m23:46:35.810979 [info ] [MainThread]: Finished running 2 view models, 25 data tests, 6 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m23:46:35.812366 [debug] [MainThread]: Command end result
[0m23:46:35.827626 [info ] [MainThread]: 
[0m23:46:35.827839 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:46:35.828078 [info ] [MainThread]: 
[0m23:46:35.828262 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 TOTAL=33
[0m23:46:35.828719 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.639955, "process_user_time": 0.98064, "process_kernel_time": 0.115369, "process_mem_max_rss": "123384", "process_out_blocks": "4055", "process_in_blocks": "0"}
[0m23:46:35.828921 [debug] [MainThread]: Command `dbt build` succeeded at 23:46:35.828889 after 0.64 seconds
[0m23:46:35.829071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d70ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d70410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d713d0>]}
[0m23:46:35.829247 [debug] [MainThread]: Flushing usage events
[0m23:51:23.080550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d1e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d1a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d51d10>]}


============================== 23:51:23.083153 | a5843614-95b8-4745-ad2c-88ffa790f290 ==============================
[0m23:51:23.083153 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:51:23.083441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:51:23.128846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d7ba50>]}
[0m23:51:23.144817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa529a690>]}
[0m23:51:23.145162 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:51:23.165380 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:51:23.206774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:23.206977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:23.220028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d63f90>]}
[0m23:51:23.264784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1aaec50>]}
[0m23:51:23.265080 [info ] [MainThread]: Found 8 models, 25 data tests, 429 macros
[0m23:51:23.266665 [info ] [MainThread]: 
[0m23:51:23.266965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:23.269157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m23:51:23.269567 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m23:51:23.286626 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m23:51:23.286803 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m23:51:23.287008 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m23:51:23.287272 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m23:51:23.287465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:23.287663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:23.293535 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m23:51:23.293756 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m23:51:23.294430 [debug] [ThreadPool]: On list_threat_risk: Close
[0m23:51:23.294937 [debug] [ThreadPool]: On list_threat_risk: Close
[0m23:51:23.296152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_staging)
[0m23:51:23.296460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_marts)
[0m23:51:23.298707 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m23:51:23.299460 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m23:51:23.299643 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m23:51:23.299810 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m23:51:23.300021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:23.300222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:23.304200 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:51:23.304340 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:51:23.304490 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m23:51:23.304658 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m23:51:23.304840 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m23:51:23.305030 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:51:23.306946 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m23:51:23.307044 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m23:51:23.307542 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m23:51:23.307957 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m23:51:23.308238 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m23:51:23.308373 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m23:51:23.311027 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:23.311257 [debug] [MainThread]: On master: BEGIN
[0m23:51:23.311417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:23.314443 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:51:23.314605 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:23.314789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:51:23.317239 [debug] [MainThread]: SQL status: SELECT 4 in 0.002 seconds
[0m23:51:23.317653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0709590>]}
[0m23:51:23.317855 [debug] [MainThread]: On master: ROLLBACK
[0m23:51:23.318054 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:23.318240 [debug] [MainThread]: On master: BEGIN
[0m23:51:23.318532 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:51:23.318689 [debug] [MainThread]: On master: COMMIT
[0m23:51:23.318828 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:23.318963 [debug] [MainThread]: On master: COMMIT
[0m23:51:23.319182 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:51:23.319347 [debug] [MainThread]: On master: Close
[0m23:51:23.319547 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:51:23.319791 [info ] [MainThread]: 
[0m23:51:23.323954 [debug] [Thread-1 (]: Began running node model.threat_risk.stg_kev
[0m23:51:23.324150 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_urlhaus
[0m23:51:23.324427 [info ] [Thread-1 (]: 1 of 33 START sql view model staging.stg_kev ................................... [RUN]
[0m23:51:23.324761 [info ] [Thread-2 (]: 2 of 33 START sql view model staging.stg_urlhaus ............................... [RUN]
[0m23:51:23.325028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now model.threat_risk.stg_kev)
[0m23:51:23.325282 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now model.threat_risk.stg_urlhaus)
[0m23:51:23.325508 [debug] [Thread-1 (]: Began compiling node model.threat_risk.stg_kev
[0m23:51:23.325766 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_urlhaus
[0m23:51:23.328462 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.stg_kev"
[0m23:51:23.329209 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus"
[0m23:51:23.330112 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_urlhaus
[0m23:51:23.330250 [debug] [Thread-1 (]: Began executing node model.threat_risk.stg_kev
[0m23:51:23.345270 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.stg_urlhaus"
[0m23:51:23.346484 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.stg_kev"
[0m23:51:23.347513 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:51:23.347812 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:51:23.348475 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: BEGIN
[0m23:51:23.348137 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: BEGIN
[0m23:51:23.348759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:23.349003 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:23.354910 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:23.355302 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:51:23.355507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:51:23.355748 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */

  create view "threat_risk"."staging"."stg_urlhaus__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.urlhaus_recent
),
clean as (
  select
    nullif(trim(url), '') as url,
    nullif(trim(url_status), '') as url_status,
    nullif(trim(host), '') as host,
    date_added,
    nullif(trim(threat), '') as threat,
    nullif(trim(tags), '') as tags,
    nullif(trim(urlhaus_link), '') as urlhaus_link,
    nullif(trim(reporter), '') as reporter,
    larted,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m23:51:23.356028 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:51:23.356449 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */

  create view "threat_risk"."staging"."stg_kev__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.kev
),
clean as (
  select
    nullif(trim(cve_id), '') as cve_id,
    nullif(trim(vendor_project), '') as vendor_project,
    nullif(trim(product), '') as product,
    nullif(trim(vulnerability_name), '') as vulnerability_name,
    date_added,
    short_description,
    required_action,
    due_date,
    notes,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m23:51:23.357754 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:51:23.358139 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:51:23.362996 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:51:23.364758 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:51:23.365339 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus" rename to "stg_urlhaus__dbt_backup"
[0m23:51:23.366217 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev" rename to "stg_kev__dbt_backup"
[0m23:51:23.367006 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:23.367174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:23.369175 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:51:23.370798 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus__dbt_tmp" rename to "stg_urlhaus"
[0m23:51:23.370511 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:51:23.371132 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev__dbt_tmp" rename to "stg_kev"
[0m23:51:23.371601 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:23.378202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:51:23.379406 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m23:51:23.380104 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m23:51:23.380678 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:51:23.380427 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:51:23.380992 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m23:51:23.380846 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m23:51:23.381593 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m23:51:23.381702 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m23:51:23.385471 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."staging"."stg_urlhaus__dbt_backup"
[0m23:51:23.386573 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."staging"."stg_kev__dbt_backup"
[0m23:51:23.389242 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:51:23.390171 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
drop view if exists "threat_risk"."staging"."stg_urlhaus__dbt_backup" cascade
[0m23:51:23.389977 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:51:23.390658 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
drop view if exists "threat_risk"."staging"."stg_kev__dbt_backup" cascade
[0m23:51:23.391960 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:51:23.392128 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:51:23.393465 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: Close
[0m23:51:23.394951 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa069f150>]}
[0m23:51:23.394080 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: Close
[0m23:51:23.395856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa06bec10>]}
[0m23:51:23.395454 [info ] [Thread-2 (]: 2 of 33 OK created sql view model staging.stg_urlhaus .......................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:51:23.396419 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_urlhaus
[0m23:51:23.396173 [info ] [Thread-1 (]: 1 of 33 OK created sql view model staging.stg_kev .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m23:51:23.396966 [debug] [Thread-4 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:51:23.397187 [debug] [Thread-1 (]: Finished running node model.threat_risk.stg_kev
[0m23:51:23.397319 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:51:23.397481 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:51:23.397661 [info ] [Thread-4 (]: 3 of 33 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m23:51:23.397920 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:51:23.398245 [info ] [Thread-3 (]: 4 of 33 START test not_null_stg_urlhaus_run_date ............................... [RUN]
[0m23:51:23.398502 [info ] [Thread-2 (]: 5 of 33 START test not_null_stg_urlhaus_url .................................... [RUN]
[0m23:51:23.398790 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41'
[0m23:51:23.398964 [info ] [Thread-1 (]: 6 of 33 START test not_null_stg_urlhaus_url_status ............................. [RUN]
[0m23:51:23.399241 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93'
[0m23:51:23.399507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m23:51:23.399760 [debug] [Thread-4 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:51:23.399938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_kev, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m23:51:23.400135 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:51:23.400308 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:51:23.405353 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:51:23.405698 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:51:23.409037 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:51:23.411067 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:51:23.412938 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:51:23.413913 [debug] [Thread-4 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:51:23.414417 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:51:23.414653 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:51:23.420974 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:51:23.421361 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:51:23.422408 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:51:23.423482 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:51:23.424664 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:51:23.425665 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:51:23.426791 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m23:51:23.426394 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:51:23.426953 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:51:23.427356 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:51:23.427222 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:51:23.427576 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m23:51:23.428559 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:51:23.428254 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m23:51:23.427820 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m23:51:23.428998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:23.429441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:23.433223 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:23.433603 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:51:23.433888 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m23:51:23.436865 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:51:23.437292 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:51:23.437967 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m23:51:23.439492 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:51:23.439932 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:51:23.441698 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m23:51:23.440846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:51:23.443148 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:51:23.443698 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m23:51:23.443863 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:51:23.445878 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m23:51:23.447285 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m23:51:23.454364 [info ] [Thread-4 (]: 3 of 33 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown .. [[32mPASS[0m in 0.06s]
[0m23:51:23.449330 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:51:23.452185 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:51:23.462878 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m23:51:23.464355 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m23:51:23.459538 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m23:51:23.447657 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:51:23.457744 [debug] [Thread-4 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:51:23.469506 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m23:51:23.468808 [info ] [Thread-1 (]: 6 of 33 PASS not_null_stg_urlhaus_url_status ................................... [[32mPASS[0m in 0.07s]
[0m23:51:23.474450 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:51:23.475355 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:51:23.470578 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m23:51:23.472661 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:51:23.477382 [info ] [Thread-4 (]: 7 of 33 START test not_null_stg_kev_cve_id ..................................... [RUN]
[0m23:51:23.476183 [info ] [Thread-1 (]: 8 of 33 START test not_null_stg_kev_product .................................... [RUN]
[0m23:51:23.478312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now test.threat_risk.not_null_stg_kev_product.9b2d2b4877)
[0m23:51:23.474798 [info ] [Thread-2 (]: 5 of 33 PASS not_null_stg_urlhaus_url .......................................... [[32mPASS[0m in 0.08s]
[0m23:51:23.479659 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:51:23.477190 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m23:51:23.478737 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:51:23.477733 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0)
[0m23:51:23.488962 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:51:23.481794 [info ] [Thread-3 (]: 4 of 33 PASS not_null_stg_urlhaus_run_date ..................................... [[32mPASS[0m in 0.08s]
[0m23:51:23.488531 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:51:23.480003 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:51:23.531957 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:51:23.532619 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:51:23.533519 [info ] [Thread-2 (]: 9 of 33 START test not_null_stg_kev_run_date ................................... [RUN]
[0m23:51:23.533932 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:51:23.534301 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:51:23.534675 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m23:51:23.534799 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:51:23.536385 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:51:23.536722 [info ] [Thread-3 (]: 10 of 33 START test not_null_stg_kev_vendor_project ............................ [RUN]
[0m23:51:23.536974 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:51:23.539887 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:51:23.538336 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m23:51:23.537933 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:51:23.540059 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:51:23.540334 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:51:23.542324 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:51:23.540746 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m23:51:23.542616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:23.540568 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:51:23.541024 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:51:23.543970 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:51:23.543200 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:51:23.544205 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m23:51:23.545941 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:23.545766 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:51:23.545450 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:51:23.546537 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m23:51:23.546861 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:23.547275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:23.547770 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:51:23.547566 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:51:23.548141 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m23:51:23.547960 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m23:51:23.548294 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:51:23.550693 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:23.551313 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:23.551470 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:51:23.551683 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:51:23.551810 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:51:23.552043 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:23.552190 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m23:51:23.552932 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m23:51:23.553253 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m23:51:23.553512 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:51:23.554248 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:51:23.553921 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m23:51:23.554655 [info ] [Thread-1 (]: 8 of 33 PASS not_null_stg_kev_product .......................................... [[32mPASS[0m in 0.08s]
[0m23:51:23.554932 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:51:23.555122 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_url
[0m23:51:23.555431 [info ] [Thread-1 (]: 11 of 33 START sql table model marts.dim_url ................................... [RUN]
[0m23:51:23.555719 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:51:23.555940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now model.threat_risk.dim_url)
[0m23:51:23.556142 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:51:23.556332 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:51:23.556886 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m23:51:23.557109 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_url
[0m23:51:23.557615 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m23:51:23.558180 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m23:51:23.559476 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_url"
[0m23:51:23.559587 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m23:51:23.559808 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m23:51:23.559958 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m23:51:23.560322 [info ] [Thread-4 (]: 7 of 33 PASS not_null_stg_kev_cve_id ........................................... [[32mPASS[0m in 0.08s]
[0m23:51:23.560846 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_url
[0m23:51:23.560702 [info ] [Thread-3 (]: 10 of 33 PASS not_null_stg_kev_vendor_project .................................. [[32mPASS[0m in 0.02s]
[0m23:51:23.569958 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:51:23.561408 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:51:23.569660 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.dim_url"
[0m23:51:23.561149 [info ] [Thread-2 (]: 9 of 33 PASS not_null_stg_kev_run_date ......................................... [[32mPASS[0m in 0.03s]
[0m23:51:23.570161 [debug] [Thread-3 (]: Began running node model.threat_risk.fact_url_events
[0m23:51:23.570794 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:51:23.571102 [info ] [Thread-3 (]: 12 of 33 START sql table model marts.fact_url_events ........................... [RUN]
[0m23:51:23.571432 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:51:23.571827 [debug] [Thread-4 (]: Began running node model.threat_risk.dim_date
[0m23:51:23.572013 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_product
[0m23:51:23.572312 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now model.threat_risk.fact_url_events)
[0m23:51:23.573386 [debug] [Thread-3 (]: Began compiling node model.threat_risk.fact_url_events
[0m23:51:23.572804 [info ] [Thread-4 (]: 13 of 33 START sql table model marts.dim_date .................................. [RUN]
[0m23:51:23.573082 [info ] [Thread-2 (]: 14 of 33 START sql table model marts.dim_product ............................... [RUN]
[0m23:51:23.572547 [debug] [Thread-1 (]: On model.threat_risk.dim_url: BEGIN
[0m23:51:23.575230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:23.574848 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now model.threat_risk.dim_date)
[0m23:51:23.575065 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now model.threat_risk.dim_product)
[0m23:51:23.574620 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.fact_url_events"
[0m23:51:23.575498 [debug] [Thread-4 (]: Began compiling node model.threat_risk.dim_date
[0m23:51:23.575722 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_product
[0m23:51:23.577048 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.dim_date"
[0m23:51:23.580218 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_product"
[0m23:51:23.580362 [debug] [Thread-3 (]: Began executing node model.threat_risk.fact_url_events
[0m23:51:23.580695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:23.581084 [debug] [Thread-4 (]: Began executing node model.threat_risk.dim_date
[0m23:51:23.582450 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.fact_url_events"
[0m23:51:23.582727 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_product
[0m23:51:23.583013 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:51:23.584550 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.dim_date"
[0m23:51:23.586706 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.dim_product"
[0m23:51:23.587222 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */

  
    

  create  table "threat_risk"."marts"."dim_url__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  url,
  host
from (
  select distinct url, host
  from "threat_risk"."staging"."stg_urlhaus"
  where url is not null
) u
  );
  
[0m23:51:23.587461 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:51:23.588656 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: BEGIN
[0m23:51:23.588530 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:51:23.588198 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:51:23.588836 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:51:23.589096 [debug] [Thread-2 (]: On model.threat_risk.dim_product: BEGIN
[0m23:51:23.589253 [debug] [Thread-4 (]: On model.threat_risk.dim_date: BEGIN
[0m23:51:23.589592 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:23.589951 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:23.596219 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:51:23.596469 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:23.596797 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:51:23.597337 [debug] [Thread-2 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */

  
    

  create  table "threat_risk"."marts"."dim_product__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  md5(coalesce(vendor_project,'')) as vendor_key,
  vendor_project,
  product
from (
  select distinct vendor_project, product
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null and product is not null
) p
  );
  
[0m23:51:23.597148 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:51:23.596960 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:51:23.597600 [debug] [Thread-4 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */

  
    

  create  table "threat_risk"."marts"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with dates as (
  select distinct run_date as d from "threat_risk"."staging"."stg_kev"
  union
  select distinct run_date as d from "threat_risk"."staging"."stg_urlhaus"
),
final as (
  select
    d as date_day,
    extract(year from d)::int as year,
    extract(month from d)::int as month,
    extract(day from d)::int as day
  from dates
)
select * from final
  );
  
[0m23:51:23.597762 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:51:23.597978 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */

  
    

  create  table "threat_risk"."marts"."fact_url_events__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  run_date as date_day,
  url_status,
  threat,
  tags,
  date_added,
  reporter,
  larted
from "threat_risk"."staging"."stg_urlhaus"
where url is not null
  );
  
[0m23:51:23.605535 [debug] [Thread-2 (]: SQL status: SELECT 625 in 0.008 seconds
[0m23:51:23.607176 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:51:23.607361 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:51:23.607580 [debug] [Thread-2 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product" rename to "dim_product__dbt_backup"
[0m23:51:23.608836 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:51:23.609142 [debug] [Thread-4 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date" rename to "dim_date__dbt_backup"
[0m23:51:23.609290 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:23.610516 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:51:23.610671 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:23.610864 [debug] [Thread-2 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m23:51:23.612039 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:51:23.612354 [debug] [Thread-4 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:51:23.612487 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:23.614690 [debug] [Thread-2 (]: On model.threat_risk.dim_product: COMMIT
[0m23:51:23.614818 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:51:23.614986 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:51:23.615515 [debug] [Thread-4 (]: On model.threat_risk.dim_date: COMMIT
[0m23:51:23.615715 [debug] [Thread-2 (]: On model.threat_risk.dim_product: COMMIT
[0m23:51:23.615941 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:51:23.616273 [debug] [Thread-4 (]: On model.threat_risk.dim_date: COMMIT
[0m23:51:23.617472 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:51:23.617721 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:51:23.619034 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."marts"."dim_product__dbt_backup"
[0m23:51:23.620270 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."marts"."dim_date__dbt_backup"
[0m23:51:23.621978 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:51:23.622361 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:51:23.622612 [debug] [Thread-2 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
drop table if exists "threat_risk"."marts"."dim_product__dbt_backup" cascade
[0m23:51:23.622925 [debug] [Thread-4 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
drop table if exists "threat_risk"."marts"."dim_date__dbt_backup" cascade
[0m23:51:23.625208 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:51:23.626007 [debug] [Thread-4 (]: On model.threat_risk.dim_date: Close
[0m23:51:23.626177 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:51:23.626579 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d51f10>]}
[0m23:51:23.627363 [debug] [Thread-2 (]: On model.threat_risk.dim_product: Close
[0m23:51:23.627889 [info ] [Thread-4 (]: 13 of 33 OK created sql table model marts.dim_date ............................. [[32mSELECT 1[0m in 0.05s]
[0m23:51:23.628462 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05f3990>]}
[0m23:51:23.628851 [debug] [Thread-4 (]: Finished running node model.threat_risk.dim_date
[0m23:51:23.629157 [info ] [Thread-2 (]: 14 of 33 OK created sql table model marts.dim_product .......................... [[32mSELECT 625[0m in 0.05s]
[0m23:51:23.629512 [debug] [Thread-4 (]: Began running node model.threat_risk.dim_vendor
[0m23:51:23.629843 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_product
[0m23:51:23.630115 [info ] [Thread-4 (]: 15 of 33 START sql table model marts.dim_vendor ................................ [RUN]
[0m23:51:23.630373 [debug] [Thread-2 (]: Began running node model.threat_risk.fact_kev
[0m23:51:23.630744 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_date, now model.threat_risk.dim_vendor)
[0m23:51:23.631033 [info ] [Thread-2 (]: 16 of 33 START sql table model marts.fact_kev .................................. [RUN]
[0m23:51:23.631338 [debug] [Thread-4 (]: Began compiling node model.threat_risk.dim_vendor
[0m23:51:23.631528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_product, now model.threat_risk.fact_kev)
[0m23:51:23.631673 [debug] [Thread-1 (]: SQL status: SELECT 22498 in 0.043 seconds
[0m23:51:23.633989 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.dim_vendor"
[0m23:51:23.634177 [debug] [Thread-2 (]: Began compiling node model.threat_risk.fact_kev
[0m23:51:23.635669 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:51:23.637323 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.fact_kev"
[0m23:51:23.637616 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url" rename to "dim_url__dbt_backup"
[0m23:51:23.637783 [debug] [Thread-4 (]: Began executing node model.threat_risk.dim_vendor
[0m23:51:23.639716 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.dim_vendor"
[0m23:51:23.639944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:51:23.640149 [debug] [Thread-2 (]: Began executing node model.threat_risk.fact_kev
[0m23:51:23.641936 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:51:23.643371 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.fact_kev"
[0m23:51:23.643521 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:51:23.643726 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url__dbt_tmp" rename to "dim_url"
[0m23:51:23.644142 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: BEGIN
[0m23:51:23.644703 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:23.644603 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:23.644431 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:51:23.645722 [debug] [Thread-1 (]: On model.threat_risk.dim_url: COMMIT
[0m23:51:23.646014 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: BEGIN
[0m23:51:23.646849 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:23.646615 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:51:23.647573 [debug] [Thread-1 (]: On model.threat_risk.dim_url: COMMIT
[0m23:51:23.649592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:51:23.650878 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."marts"."dim_url__dbt_backup"
[0m23:51:23.651016 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:23.651136 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:23.651377 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:51:23.651905 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
drop table if exists "threat_risk"."marts"."dim_url__dbt_backup" cascade
[0m23:51:23.651732 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:51:23.651540 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:51:23.652137 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */

  
    

  create  table "threat_risk"."marts"."fact_kev__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(cve_id,'')) as cve_key,
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  run_date as date_day,
  cve_id,
  vulnerability_name,
  date_added,
  due_date,
  required_action,
  notes
from "threat_risk"."staging"."stg_kev"
where cve_id is not null
  );
  
[0m23:51:23.652325 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */

  
    

  create  table "threat_risk"."marts"."dim_vendor__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project, '')) as vendor_key,
  vendor_project
from (
  select distinct vendor_project
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null
) v
  );
  
[0m23:51:23.653525 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:51:23.654122 [debug] [Thread-1 (]: On model.threat_risk.dim_url: Close
[0m23:51:23.654540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0565350>]}
[0m23:51:23.654996 [info ] [Thread-1 (]: 11 of 33 OK created sql table model marts.dim_url .............................. [[32mSELECT 22498[0m in 0.10s]
[0m23:51:23.655391 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_url
[0m23:51:23.655772 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:51:23.656106 [info ] [Thread-1 (]: 17 of 33 START test not_null_dim_product_product ............................... [RUN]
[0m23:51:23.656416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_url, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m23:51:23.656607 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:51:23.658401 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:51:23.658958 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:51:23.660121 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:51:23.660248 [debug] [Thread-4 (]: SQL status: SELECT 245 in 0.008 seconds
[0m23:51:23.661435 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:51:23.661610 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor" rename to "dim_vendor__dbt_backup"
[0m23:51:23.661754 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:51:23.661944 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: BEGIN
[0m23:51:23.662084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:23.662197 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:23.663875 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:51:23.665743 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor__dbt_tmp" rename to "dim_vendor"
[0m23:51:23.666113 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:23.666712 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: COMMIT
[0m23:51:23.666941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:23.667364 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:51:23.667159 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:51:23.667660 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: COMMIT
[0m23:51:23.667508 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product.56a877bc84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."marts"."dim_product"
where product is null



      
    ) dbt_internal_test
[0m23:51:23.668508 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:23.669237 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: ROLLBACK
[0m23:51:23.669502 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: Close
[0m23:51:23.669786 [info ] [Thread-1 (]: 17 of 33 PASS not_null_dim_product_product ..................................... [[32mPASS[0m in 0.01s]
[0m23:51:23.670139 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:51:23.670430 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:51:23.670772 [info ] [Thread-1 (]: 18 of 33 START test not_null_dim_product_product_key ........................... [RUN]
[0m23:51:23.671122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.not_null_dim_product_product_key.f0e1d838d3)
[0m23:51:23.671412 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:51:23.674935 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:51:23.676147 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:51:23.677305 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:51:23.677795 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:51:23.677979 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m23:51:23.678213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:23.679552 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m23:51:23.679989 [debug] [Thread-3 (]: SQL status: SELECT 44995 in 0.082 seconds
[0m23:51:23.681255 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."marts"."dim_vendor__dbt_backup"
[0m23:51:23.682764 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:51:23.683294 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:51:23.683940 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
drop table if exists "threat_risk"."marts"."dim_vendor__dbt_backup" cascade
[0m23:51:23.683758 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events" rename to "fact_url_events__dbt_backup"
[0m23:51:23.683524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:23.684332 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:51:23.684560 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:23.684780 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "threat_risk"."marts"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m23:51:23.686608 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:51:23.686817 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:51:23.687275 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events__dbt_tmp" rename to "fact_url_events"
[0m23:51:23.688023 [debug] [Thread-4 (]: On model.threat_risk.dim_vendor: Close
[0m23:51:23.688725 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05c8850>]}
[0m23:51:23.688196 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:23.688892 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:23.689929 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m23:51:23.689232 [info ] [Thread-4 (]: 15 of 33 OK created sql table model marts.dim_vendor ........................... [[32mSELECT 245[0m in 0.06s]
[0m23:51:23.690664 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: COMMIT
[0m23:51:23.690837 [debug] [Thread-2 (]: SQL status: SELECT 10416 in 0.038 seconds
[0m23:51:23.691173 [debug] [Thread-4 (]: Finished running node model.threat_risk.dim_vendor
[0m23:51:23.692946 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:51:23.691488 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:51:23.692729 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:51:23.691314 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: Close
[0m23:51:23.693952 [info ] [Thread-1 (]: 18 of 33 PASS not_null_dim_product_product_key ................................. [[32mPASS[0m in 0.02s]
[0m23:51:23.693497 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: COMMIT
[0m23:51:23.693692 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev" rename to "fact_kev__dbt_backup"
[0m23:51:23.693251 [info ] [Thread-4 (]: 19 of 33 START test not_null_dim_product_vendor_key ............................ [RUN]
[0m23:51:23.694601 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_vendor, now test.threat_risk.not_null_dim_product_vendor_key.78836999d2)
[0m23:51:23.694176 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:51:23.694753 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:23.694914 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:51:23.695020 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:51:23.695212 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:51:23.696326 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:51:23.697822 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:51:23.698700 [debug] [Thread-3 (]: Applying DROP to: "threat_risk"."marts"."fact_url_events__dbt_backup"
[0m23:51:23.698885 [info ] [Thread-1 (]: 20 of 33 START test not_null_dim_product_vendor_project ........................ [RUN]
[0m23:51:23.699124 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev__dbt_tmp" rename to "fact_kev"
[0m23:51:23.699481 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:51:23.699679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m23:51:23.699805 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:51:23.700013 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
drop table if exists "threat_risk"."marts"."fact_url_events__dbt_backup" cascade
[0m23:51:23.700124 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:23.700301 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:51:23.701080 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:51:23.701727 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: COMMIT
[0m23:51:23.703240 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:51:23.703386 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:51:23.703643 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:51:23.703950 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:51:23.704433 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: Close
[0m23:51:23.704670 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: COMMIT
[0m23:51:23.704876 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:51:23.705067 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: BEGIN
[0m23:51:23.706861 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:23.706571 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:51:23.706710 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:51:23.705449 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f40990>]}
[0m23:51:23.709256 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."marts"."fact_kev__dbt_backup"
[0m23:51:23.709544 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:51:23.709779 [info ] [Thread-3 (]: 12 of 33 OK created sql table model marts.fact_url_events ...................... [[32mSELECT 44995[0m in 0.13s]
[0m23:51:23.710060 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:51:23.710401 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: BEGIN
[0m23:51:23.710591 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:23.710869 [debug] [Thread-3 (]: Finished running node model.threat_risk.fact_url_events
[0m23:51:23.711202 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
drop table if exists "threat_risk"."marts"."fact_kev__dbt_backup" cascade
[0m23:51:23.711483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:23.711700 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:51:23.711921 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:51:23.712492 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_product"
where vendor_key is null



      
    ) dbt_internal_test
[0m23:51:23.712784 [info ] [Thread-3 (]: 21 of 33 START test unique_dim_product_product_key ............................. [RUN]
[0m23:51:23.713273 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_url_events, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m23:51:23.713514 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:51:23.713665 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:23.713807 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:51:23.716435 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:51:23.717235 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: ROLLBACK
[0m23:51:23.717436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:23.718682 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:51:23.718515 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: Close
[0m23:51:23.717951 [debug] [Thread-2 (]: On model.threat_risk.fact_kev: Close
[0m23:51:23.718918 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_product"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:51:23.719069 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:51:23.719399 [info ] [Thread-4 (]: 19 of 33 PASS not_null_dim_product_vendor_key .................................. [[32mPASS[0m in 0.02s]
[0m23:51:23.719727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5843614-95b8-4745-ad2c-88ffa790f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa03cc290>]}
[0m23:51:23.720950 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:51:23.721113 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:23.721340 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:51:23.722687 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:51:23.722461 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: ROLLBACK
[0m23:51:23.721609 [info ] [Thread-2 (]: 16 of 33 OK created sql table model marts.fact_kev ............................. [[32mSELECT 10416[0m in 0.09s]
[0m23:51:23.722880 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:51:23.722998 [info ] [Thread-4 (]: 22 of 33 START test not_null_dim_url_url ....................................... [RUN]
[0m23:51:23.723880 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.not_null_dim_url_url.2b67971659)
[0m23:51:23.723502 [debug] [Thread-2 (]: Finished running node model.threat_risk.fact_kev
[0m23:51:23.723692 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: BEGIN
[0m23:51:23.723285 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: Close
[0m23:51:23.724731 [info ] [Thread-1 (]: 20 of 33 PASS not_null_dim_product_vendor_project .............................. [[32mPASS[0m in 0.03s]
[0m23:51:23.724261 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:51:23.724507 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:51:23.724047 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:51:23.724953 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:51:23.725140 [info ] [Thread-2 (]: 23 of 33 START test not_null_dim_url_url_key ................................... [RUN]
[0m23:51:23.726906 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:51:23.727137 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:51:23.727358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_kev, now test.threat_risk.not_null_dim_url_url_key.89914b0872)
[0m23:51:23.727660 [info ] [Thread-1 (]: 24 of 33 START test unique_dim_url_url ......................................... [RUN]
[0m23:51:23.727952 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:51:23.728328 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:51:23.728584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15, now test.threat_risk.unique_dim_url_url.4c561dc36d)
[0m23:51:23.728738 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:23.730308 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:51:23.731500 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:51:23.731814 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:51:23.732121 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:51:23.734694 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:51:23.734834 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:51:23.735192 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:23.735072 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:51:23.736268 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:51:23.736544 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:51:23.736762 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: BEGIN
[0m23:51:23.737958 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:51:23.738146 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:23.738390 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:51:23.738518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:23.739511 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m23:51:23.739741 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: BEGIN
[0m23:51:23.739861 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:51:23.740323 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: Close
[0m23:51:23.740483 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:23.740706 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: BEGIN
[0m23:51:23.741011 [info ] [Thread-3 (]: 21 of 33 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.03s]
[0m23:51:23.744296 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:51:23.741417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:23.744517 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:51:23.745018 [info ] [Thread-3 (]: 25 of 33 START test unique_dim_url_url_key ..................................... [RUN]
[0m23:51:23.745223 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m23:51:23.745454 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_product_product_key.1753236bd0, now test.threat_risk.unique_dim_url_url_key.d67ee5b979)
[0m23:51:23.745684 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:51:23.745946 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:23.747207 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:51:23.747509 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url.2b67971659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."dim_url"
where url is null



      
    ) dbt_internal_test
[0m23:51:23.747722 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:51:23.749426 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:51:23.749830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:51:23.750044 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url_key.89914b0872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."dim_url"
where url_key is null



      
    ) dbt_internal_test
[0m23:51:23.750489 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:51:23.750820 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:51:23.751016 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url.4c561dc36d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:23.752113 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:51:23.752263 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:51:23.752378 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:51:23.753167 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: ROLLBACK
[0m23:51:23.753715 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: ROLLBACK
[0m23:51:23.753860 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:51:23.754151 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: Close
[0m23:51:23.754384 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: Close
[0m23:51:23.754516 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: BEGIN
[0m23:51:23.754806 [info ] [Thread-2 (]: 23 of 33 PASS not_null_dim_url_url_key ......................................... [[32mPASS[0m in 0.03s]
[0m23:51:23.755875 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:51:23.755616 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:51:23.755368 [info ] [Thread-4 (]: 22 of 33 PASS not_null_dim_url_url ............................................. [[32mPASS[0m in 0.03s]
[0m23:51:23.756476 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:51:23.756063 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:51:23.756841 [info ] [Thread-2 (]: 26 of 33 START test not_null_dim_vendor_vendor_key ............................. [RUN]
[0m23:51:23.756661 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:51:23.757223 [info ] [Thread-4 (]: 27 of 33 START test not_null_dim_vendor_vendor_project ......................... [RUN]
[0m23:51:23.757043 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url_key.89914b0872, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m23:51:23.757563 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:51:23.757404 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url.2b67971659, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m23:51:23.757679 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:51:23.759273 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:51:23.759497 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:51:23.759637 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:23.760169 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: ROLLBACK
[0m23:51:23.763232 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:51:23.763463 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:51:23.763605 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:51:23.763813 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: Close
[0m23:51:23.764030 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url_key.d67ee5b979"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url_key is not null
group by url_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:23.764285 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:51:23.765007 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:51:23.765281 [info ] [Thread-1 (]: 24 of 33 PASS unique_dim_url_url ............................................... [[32mPASS[0m in 0.04s]
[0m23:51:23.766422 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:51:23.767016 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:51:23.767377 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:51:23.767985 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: BEGIN
[0m23:51:23.767831 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:51:23.767651 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:51:23.768147 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:23.768369 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: BEGIN
[0m23:51:23.768565 [info ] [Thread-1 (]: 28 of 33 START test unique_dim_vendor_vendor_key ............................... [RUN]
[0m23:51:23.768924 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:23.769155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_url_url.4c561dc36d, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m23:51:23.769505 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:51:23.771079 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:51:23.771248 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:51:23.771957 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: ROLLBACK
[0m23:51:23.772170 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:51:23.772407 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: Close
[0m23:51:23.773604 [info ] [Thread-3 (]: 25 of 33 PASS unique_dim_url_url_key ........................................... [[32mPASS[0m in 0.03s]
[0m23:51:23.773317 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:23.773208 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:51:23.773752 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:23.773951 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:51:23.774149 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:51:23.774542 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:51:23.774764 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:51:23.774976 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:51:23.775703 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: BEGIN
[0m23:51:23.775319 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_vendor"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:51:23.775506 [info ] [Thread-3 (]: 29 of 33 START test unique_dim_vendor_vendor_project ........................... [RUN]
[0m23:51:23.775134 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_vendor"
where vendor_key is null



      
    ) dbt_internal_test
[0m23:51:23.775849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:23.776121 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_url_url_key.d67ee5b979, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m23:51:23.776457 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:51:23.776667 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:23.776813 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:23.778358 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:51:23.779465 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: ROLLBACK
[0m23:51:23.780389 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: ROLLBACK
[0m23:51:23.780625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:23.781979 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:51:23.781550 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:51:23.781751 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: Close
[0m23:51:23.781223 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: Close
[0m23:51:23.782280 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_key is not null
group by vendor_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:23.783390 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:51:23.783679 [info ] [Thread-2 (]: 26 of 33 PASS not_null_dim_vendor_vendor_key ................................... [[32mPASS[0m in 0.03s]
[0m23:51:23.783957 [info ] [Thread-4 (]: 27 of 33 PASS not_null_dim_vendor_vendor_project ............................... [[32mPASS[0m in 0.03s]
[0m23:51:23.784455 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:51:23.784654 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:51:23.784816 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:51:23.784939 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:23.785130 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:51:23.786373 [info ] [Thread-2 (]: 30 of 33 START test not_null_fact_url_events_date_day .......................... [RUN]
[0m23:51:23.785497 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:51:23.786150 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: ROLLBACK
[0m23:51:23.785303 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: BEGIN
[0m23:51:23.786570 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.not_null_fact_url_events_date_day.d658eee263)
[0m23:51:23.786752 [info ] [Thread-4 (]: 31 of 33 START test not_null_fact_url_events_url_key ........................... [RUN]
[0m23:51:23.787011 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: Close
[0m23:51:23.787697 [info ] [Thread-1 (]: 28 of 33 PASS unique_dim_vendor_vendor_key ..................................... [[32mPASS[0m in 0.02s]
[0m23:51:23.787954 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:51:23.787473 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d)
[0m23:51:23.787129 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:51:23.787291 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:51:23.788126 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:51:23.788325 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:51:23.790019 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:51:23.790205 [info ] [Thread-1 (]: 32 of 33 START test not_null_fact_kev_cve_id ................................... [RUN]
[0m23:51:23.791676 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:51:23.791943 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:23.792138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m23:51:23.792381 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:51:23.792566 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:51:23.792720 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:51:23.792882 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:51:23.793646 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:51:23.793828 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_project as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_project is not null
group by vendor_project
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:23.795095 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:51:23.796029 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:51:23.796508 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:51:23.796935 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: BEGIN
[0m23:51:23.797107 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:23.797261 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:51:23.797368 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:23.797528 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:51:23.798024 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: ROLLBACK
[0m23:51:23.799783 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:51:23.800101 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: BEGIN
[0m23:51:23.800305 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: Close
[0m23:51:23.800519 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:23.800775 [info ] [Thread-3 (]: 29 of 33 PASS unique_dim_vendor_vendor_project ................................. [[32mPASS[0m in 0.02s]
[0m23:51:23.800924 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:51:23.801331 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:51:23.801578 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: BEGIN
[0m23:51:23.801816 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:51:23.802451 [info ] [Thread-3 (]: 33 of 33 START test not_null_fact_kev_date_day ................................. [RUN]
[0m23:51:23.802009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:23.802651 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m23:51:23.803019 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:51:23.803279 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:23.807032 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:51:23.807472 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:51:23.807693 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m23:51:23.808139 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_url_events"
where date_day is null



      
    ) dbt_internal_test
[0m23:51:23.808466 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:51:23.808920 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:51:23.808740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:51:23.809217 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."fact_url_events"
where url_key is null



      
    ) dbt_internal_test
[0m23:51:23.810747 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:51:23.811034 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:51:23.811633 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."marts"."fact_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m23:51:23.812070 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:51:23.812365 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: BEGIN
[0m23:51:23.812640 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:51:23.813683 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:51:23.813817 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:51:23.815453 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: ROLLBACK
[0m23:51:23.815593 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:51:23.816067 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: ROLLBACK
[0m23:51:23.816322 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: Close
[0m23:51:23.816447 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:23.816898 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: ROLLBACK
[0m23:51:23.817162 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: Close
[0m23:51:23.817354 [info ] [Thread-2 (]: 30 of 33 PASS not_null_fact_url_events_date_day ................................ [[32mPASS[0m in 0.03s]
[0m23:51:23.817560 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:51:23.817821 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: Close
[0m23:51:23.818013 [info ] [Thread-4 (]: 31 of 33 PASS not_null_fact_url_events_url_key ................................. [[32mPASS[0m in 0.03s]
[0m23:51:23.818307 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:51:23.818464 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_kev"
where date_day is null



      
    ) dbt_internal_test
[0m23:51:23.818867 [info ] [Thread-1 (]: 32 of 33 PASS not_null_fact_kev_cve_id ......................................... [[32mPASS[0m in 0.03s]
[0m23:51:23.819193 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:51:23.819662 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:51:23.820396 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:23.820887 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: ROLLBACK
[0m23:51:23.821069 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: Close
[0m23:51:23.821306 [info ] [Thread-3 (]: 33 of 33 PASS not_null_fact_kev_date_day ....................................... [[32mPASS[0m in 0.02s]
[0m23:51:23.821528 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:51:23.822397 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:23.822561 [debug] [MainThread]: On master: BEGIN
[0m23:51:23.822684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:23.825611 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:51:23.825737 [debug] [MainThread]: On master: COMMIT
[0m23:51:23.825848 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:23.825949 [debug] [MainThread]: On master: COMMIT
[0m23:51:23.826105 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:51:23.826215 [debug] [MainThread]: On master: Close
[0m23:51:23.826377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:23.826490 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8' was properly closed.
[0m23:51:23.826590 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_date_day.d658eee263' was properly closed.
[0m23:51:23.826716 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d' was properly closed.
[0m23:51:23.826830 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_kev_date_day.64362f7a33' was properly closed.
[0m23:51:23.827033 [info ] [MainThread]: 
[0m23:51:23.827234 [info ] [MainThread]: Finished running 2 view models, 25 data tests, 6 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m23:51:23.828655 [debug] [MainThread]: Command end result
[0m23:51:23.845327 [info ] [MainThread]: 
[0m23:51:23.845522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:51:23.845685 [info ] [MainThread]: 
[0m23:51:23.845842 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 TOTAL=33
[0m23:51:23.846320 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.78283125, "process_user_time": 1.105281, "process_kernel_time": 0.129201, "process_mem_max_rss": "123392", "process_out_blocks": "4058", "process_in_blocks": "0"}
[0m23:51:23.846529 [debug] [MainThread]: Command `dbt build` succeeded at 23:51:23.846492 after 0.78 seconds
[0m23:51:23.846694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa308c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa08bac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7a30490>]}
[0m23:51:23.846864 [debug] [MainThread]: Flushing usage events
[0m23:51:27.343767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebd7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebd1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebd65d0>]}


============================== 23:51:27.346183 | 83870a89-81f3-42e5-9cf8-19ff51cfa0b7 ==============================
[0m23:51:27.346183 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:51:27.346455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/logs', 'profiles_dir': '/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:51:27.392829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de280d0>]}
[0m23:51:27.409439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff910da150>]}
[0m23:51:27.409762 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:51:27.430190 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:51:27.469784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:27.470002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:27.483091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dab0150>]}
[0m23:51:27.523369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d90ae10>]}
[0m23:51:27.523611 [info ] [MainThread]: Found 8 models, 25 data tests, 429 macros
[0m23:51:27.525072 [info ] [MainThread]: 
[0m23:51:27.525396 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:27.527060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m23:51:27.527341 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m23:51:27.540862 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m23:51:27.541000 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m23:51:27.541193 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m23:51:27.541412 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m23:51:27.541601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:27.541780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:27.547437 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m23:51:27.547572 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m23:51:27.548079 [debug] [ThreadPool]: On list_threat_risk: Close
[0m23:51:27.548565 [debug] [ThreadPool]: On list_threat_risk: Close
[0m23:51:27.549587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_staging)
[0m23:51:27.549880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_marts)
[0m23:51:27.552108 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m23:51:27.552877 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m23:51:27.553081 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m23:51:27.553263 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m23:51:27.553449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:27.553663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:27.557632 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:51:27.557775 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:51:27.557937 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m23:51:27.558118 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m23:51:27.558316 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:51:27.558508 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m23:51:27.560381 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m23:51:27.560472 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m23:51:27.560916 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m23:51:27.561370 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m23:51:27.561626 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m23:51:27.561763 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m23:51:27.564130 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:27.564309 [debug] [MainThread]: On master: BEGIN
[0m23:51:27.564470 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:27.567454 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:51:27.567615 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:27.567790 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:51:27.570602 [debug] [MainThread]: SQL status: SELECT 4 in 0.003 seconds
[0m23:51:27.571082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c455a90>]}
[0m23:51:27.571330 [debug] [MainThread]: On master: ROLLBACK
[0m23:51:27.571566 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:27.571702 [debug] [MainThread]: On master: BEGIN
[0m23:51:27.571950 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:51:27.572118 [debug] [MainThread]: On master: COMMIT
[0m23:51:27.572259 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:27.572386 [debug] [MainThread]: On master: COMMIT
[0m23:51:27.572575 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:51:27.572710 [debug] [MainThread]: On master: Close
[0m23:51:27.572908 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:51:27.573097 [info ] [MainThread]: 
[0m23:51:27.577342 [debug] [Thread-1 (]: Began running node model.threat_risk.stg_kev
[0m23:51:27.577490 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_urlhaus
[0m23:51:27.577724 [info ] [Thread-1 (]: 1 of 33 START sql view model staging.stg_kev ................................... [RUN]
[0m23:51:27.578034 [info ] [Thread-2 (]: 2 of 33 START sql view model staging.stg_urlhaus ............................... [RUN]
[0m23:51:27.578278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now model.threat_risk.stg_kev)
[0m23:51:27.578516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now model.threat_risk.stg_urlhaus)
[0m23:51:27.578701 [debug] [Thread-1 (]: Began compiling node model.threat_risk.stg_kev
[0m23:51:27.578894 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_urlhaus
[0m23:51:27.581323 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.stg_kev"
[0m23:51:27.582022 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus"
[0m23:51:27.582830 [debug] [Thread-1 (]: Began executing node model.threat_risk.stg_kev
[0m23:51:27.582969 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_urlhaus
[0m23:51:27.594836 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.stg_kev"
[0m23:51:27.595981 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.stg_urlhaus"
[0m23:51:27.596699 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:51:27.596983 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: BEGIN
[0m23:51:27.596849 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:51:27.597281 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: BEGIN
[0m23:51:27.597136 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:27.597466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:27.600941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m23:51:27.601100 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:51:27.601264 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */

  create view "threat_risk"."staging"."stg_kev__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.kev
),
clean as (
  select
    nullif(trim(cve_id), '') as cve_id,
    nullif(trim(vendor_project), '') as vendor_project,
    nullif(trim(product), '') as product,
    nullif(trim(vulnerability_name), '') as vulnerability_name,
    date_added,
    short_description,
    required_action,
    due_date,
    notes,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m23:51:27.601620 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:27.601758 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:51:27.601914 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */

  create view "threat_risk"."staging"."stg_urlhaus__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.urlhaus_recent
),
clean as (
  select
    nullif(trim(url), '') as url,
    nullif(trim(url_status), '') as url_status,
    nullif(trim(host), '') as host,
    date_added,
    nullif(trim(threat), '') as threat,
    nullif(trim(tags), '') as tags,
    nullif(trim(urlhaus_link), '') as urlhaus_link,
    nullif(trim(reporter), '') as reporter,
    larted,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m23:51:27.602676 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:51:27.604911 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:51:27.605131 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev" rename to "stg_kev__dbt_backup"
[0m23:51:27.605023 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:51:27.606129 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:51:27.606212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:27.606354 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus" rename to "stg_urlhaus__dbt_backup"
[0m23:51:27.607242 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:51:27.607592 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev__dbt_tmp" rename to "stg_kev"
[0m23:51:27.607843 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:27.608794 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:51:27.608890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:27.609018 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus__dbt_tmp" rename to "stg_urlhaus"
[0m23:51:27.614251 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m23:51:27.614502 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:51:27.614632 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m23:51:27.614733 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:27.615285 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m23:51:27.615396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:51:27.615532 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:51:27.618378 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m23:51:27.618216 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."staging"."stg_kev__dbt_backup"
[0m23:51:27.620055 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m23:51:27.620149 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:51:27.621017 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."staging"."stg_urlhaus__dbt_backup"
[0m23:51:27.620279 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
drop view if exists "threat_risk"."staging"."stg_kev__dbt_backup" cascade
[0m23:51:27.621203 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m23:51:27.621417 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
drop view if exists "threat_risk"."staging"."stg_urlhaus__dbt_backup" cascade
[0m23:51:27.622148 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:51:27.622267 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:51:27.623572 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: Close
[0m23:51:27.623136 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: Close
[0m23:51:27.624337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebf80d0>]}
[0m23:51:27.624143 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c335590>]}
[0m23:51:27.624946 [info ] [Thread-2 (]: 2 of 33 OK created sql view model staging.stg_urlhaus .......................... [[32mCREATE VIEW[0m in 0.05s]
[0m23:51:27.624609 [info ] [Thread-1 (]: 1 of 33 OK created sql view model staging.stg_kev .............................. [[32mCREATE VIEW[0m in 0.05s]
[0m23:51:27.625493 [debug] [Thread-1 (]: Finished running node model.threat_risk.stg_kev
[0m23:51:27.625296 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_urlhaus
[0m23:51:27.625926 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:51:27.626132 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:51:27.626307 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:51:27.626452 [info ] [Thread-4 (]: 3 of 33 START test not_null_stg_kev_cve_id ..................................... [RUN]
[0m23:51:27.626614 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:51:27.626784 [info ] [Thread-3 (]: 4 of 33 START test not_null_stg_kev_product .................................... [RUN]
[0m23:51:27.627039 [info ] [Thread-1 (]: 5 of 33 START test not_null_stg_kev_run_date ................................... [RUN]
[0m23:51:27.627417 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0'
[0m23:51:27.627584 [info ] [Thread-2 (]: 6 of 33 START test not_null_stg_kev_vendor_project ............................. [RUN]
[0m23:51:27.627882 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.threat_risk.not_null_stg_kev_product.9b2d2b4877'
[0m23:51:27.628056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_kev, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m23:51:27.628245 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:51:27.628437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m23:51:27.628608 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:51:27.628760 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:51:27.632891 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:51:27.633073 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:51:27.634408 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:51:27.635743 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:51:27.637236 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:51:27.637863 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:51:27.638162 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:51:27.643898 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:51:27.643068 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:51:27.643205 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:51:27.642884 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:51:27.644711 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:51:27.645571 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:51:27.645733 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:51:27.646517 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m23:51:27.646425 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:51:27.646219 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:51:27.646663 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:51:27.646748 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:51:27.646890 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m23:51:27.647474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:27.647173 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m23:51:27.647022 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m23:51:27.647781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:27.647987 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:51:27.652861 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:27.653053 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:51:27.653264 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m23:51:27.655239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:51:27.655478 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:51:27.655612 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:51:27.655848 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m23:51:27.655995 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:51:27.656146 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:51:27.656365 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:51:27.656562 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:51:27.656728 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m23:51:27.656875 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:51:27.658510 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m23:51:27.658663 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:51:27.658800 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:51:27.659346 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m23:51:27.659466 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m23:51:27.659578 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:51:27.660069 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m23:51:27.660298 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m23:51:27.660533 [info ] [Thread-3 (]: 4 of 33 PASS not_null_stg_kev_product .......................................... [[32mPASS[0m in 0.03s]
[0m23:51:27.661277 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m23:51:27.661550 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m23:51:27.661782 [info ] [Thread-1 (]: 5 of 33 PASS not_null_stg_kev_run_date ......................................... [[32mPASS[0m in 0.03s]
[0m23:51:27.662040 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:51:27.662416 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m23:51:27.662665 [info ] [Thread-2 (]: 6 of 33 PASS not_null_stg_kev_vendor_project ................................... [[32mPASS[0m in 0.03s]
[0m23:51:27.662982 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:51:27.663355 [debug] [Thread-3 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:51:27.663707 [info ] [Thread-4 (]: 3 of 33 PASS not_null_stg_kev_cve_id ........................................... [[32mPASS[0m in 0.04s]
[0m23:51:27.664005 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:51:27.664264 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:51:27.664518 [info ] [Thread-3 (]: 7 of 33 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m23:51:27.664855 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:51:27.665095 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:51:27.665342 [info ] [Thread-1 (]: 8 of 33 START test not_null_stg_urlhaus_run_date ............................... [RUN]
[0m23:51:27.665667 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41)
[0m23:51:27.665898 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:51:27.666234 [info ] [Thread-2 (]: 9 of 33 START test not_null_stg_urlhaus_url .................................... [RUN]
[0m23:51:27.666522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93)
[0m23:51:27.666731 [debug] [Thread-3 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:51:27.666924 [info ] [Thread-4 (]: 10 of 33 START test not_null_stg_urlhaus_url_status ............................ [RUN]
[0m23:51:27.667213 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m23:51:27.667399 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:51:27.671646 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:51:27.671858 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m23:51:27.672070 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:51:27.693514 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:51:27.693980 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:51:27.695317 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:51:27.695646 [debug] [Thread-3 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:51:27.696853 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:51:27.697163 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:51:27.697962 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:51:27.698135 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:51:27.698931 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:51:27.699153 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:51:27.699992 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:51:27.700292 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:51:27.701448 [debug] [Thread-3 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m23:51:27.701242 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:51:27.701043 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:51:27.701615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:51:27.701733 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:51:27.701858 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m23:51:27.702513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:27.702354 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m23:51:27.702247 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:51:27.702808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:27.703008 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m23:51:27.704335 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:27.707280 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:27.707503 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:51:27.707694 [debug] [Thread-3 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m23:51:27.709051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:51:27.709261 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:51:27.709413 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m23:51:27.709937 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:27.710119 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:51:27.710338 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:51:27.710538 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:51:27.710843 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m23:51:27.711060 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m23:51:27.717996 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:51:27.718857 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m23:51:27.719010 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:51:27.719231 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m23:51:27.719370 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:51:27.719841 [debug] [Thread-3 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m23:51:27.720165 [info ] [Thread-1 (]: 8 of 33 PASS not_null_stg_urlhaus_run_date ..................................... [[32mPASS[0m in 0.05s]
[0m23:51:27.720703 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m23:51:27.720989 [debug] [Thread-3 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m23:51:27.721193 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:51:27.721432 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m23:51:27.721632 [info ] [Thread-3 (]: 7 of 33 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown .. [[32mPASS[0m in 0.06s]
[0m23:51:27.721947 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_product
[0m23:51:27.722348 [info ] [Thread-4 (]: 10 of 33 PASS not_null_stg_urlhaus_url_status .................................. [[32mPASS[0m in 0.05s]
[0m23:51:27.722634 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:51:27.722857 [debug] [Thread-3 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:51:27.723156 [info ] [Thread-1 (]: 11 of 33 START sql table model marts.dim_product ............................... [RUN]
[0m23:51:27.723465 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:51:27.723955 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m23:51:27.724192 [debug] [Thread-3 (]: Began running node model.threat_risk.dim_vendor
[0m23:51:27.724491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now model.threat_risk.dim_product)
[0m23:51:27.724740 [debug] [Thread-4 (]: Began running node model.threat_risk.fact_kev
[0m23:51:27.725047 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m23:51:27.725224 [info ] [Thread-3 (]: 12 of 33 START sql table model marts.dim_vendor ................................ [RUN]
[0m23:51:27.725531 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_product
[0m23:51:27.725821 [info ] [Thread-4 (]: 13 of 33 START sql table model marts.fact_kev .................................. [RUN]
[0m23:51:27.726180 [info ] [Thread-2 (]: 9 of 33 PASS not_null_stg_urlhaus_url .......................................... [[32mPASS[0m in 0.06s]
[0m23:51:27.726460 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now model.threat_risk.dim_vendor)
[0m23:51:27.727667 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_product"
[0m23:51:27.727884 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now model.threat_risk.fact_kev)
[0m23:51:27.728133 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:51:27.728337 [debug] [Thread-3 (]: Began compiling node model.threat_risk.dim_vendor
[0m23:51:27.728673 [debug] [Thread-4 (]: Began compiling node model.threat_risk.fact_kev
[0m23:51:27.729061 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_product
[0m23:51:27.729232 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_date
[0m23:51:27.730197 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.dim_vendor"
[0m23:51:27.731276 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.fact_kev"
[0m23:51:27.739915 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.dim_product"
[0m23:51:27.740173 [info ] [Thread-2 (]: 14 of 33 START sql table model marts.dim_date .................................. [RUN]
[0m23:51:27.741186 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now model.threat_risk.dim_date)
[0m23:51:27.741046 [debug] [Thread-4 (]: Began executing node model.threat_risk.fact_kev
[0m23:51:27.740766 [debug] [Thread-3 (]: Began executing node model.threat_risk.dim_vendor
[0m23:51:27.741378 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_date
[0m23:51:27.742507 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.fact_kev"
[0m23:51:27.742694 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:51:27.743674 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.dim_vendor"
[0m23:51:27.744703 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_date"
[0m23:51:27.744995 [debug] [Thread-1 (]: On model.threat_risk.dim_product: BEGIN
[0m23:51:27.745204 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:51:27.745549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:27.745736 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:51:27.745889 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_date
[0m23:51:27.745988 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: BEGIN
[0m23:51:27.746273 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: BEGIN
[0m23:51:27.747594 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.dim_date"
[0m23:51:27.748657 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:27.748814 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:51:27.749354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:27.749513 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:51:27.749724 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:51:27.749984 [debug] [Thread-2 (]: On model.threat_risk.dim_date: BEGIN
[0m23:51:27.750504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:27.750235 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */

  
    

  create  table "threat_risk"."marts"."dim_product__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  md5(coalesce(vendor_project,'')) as vendor_key,
  vendor_project,
  product
from (
  select distinct vendor_project, product
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null and product is not null
) p
  );
  
[0m23:51:27.755558 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m23:51:27.755773 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:51:27.755974 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */

  
    

  create  table "threat_risk"."marts"."fact_kev__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(cve_id,'')) as cve_key,
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  run_date as date_day,
  cve_id,
  vulnerability_name,
  date_added,
  due_date,
  required_action,
  notes
from "threat_risk"."staging"."stg_kev"
where cve_id is not null
  );
  
[0m23:51:27.756139 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:51:27.756412 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:51:27.756543 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:27.756701 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */

  
    

  create  table "threat_risk"."marts"."dim_vendor__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project, '')) as vendor_key,
  vendor_project
from (
  select distinct vendor_project
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null
) v
  );
  
[0m23:51:27.756855 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:51:27.757096 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */

  
    

  create  table "threat_risk"."marts"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with dates as (
  select distinct run_date as d from "threat_risk"."staging"."stg_kev"
  union
  select distinct run_date as d from "threat_risk"."staging"."stg_urlhaus"
),
final as (
  select
    d as date_day,
    extract(year from d)::int as year,
    extract(month from d)::int as month,
    extract(day from d)::int as day
  from dates
)
select * from final
  );
  
[0m23:51:27.759562 [debug] [Thread-1 (]: SQL status: SELECT 625 in 0.009 seconds
[0m23:51:27.760998 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:51:27.761176 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product" rename to "dim_product__dbt_backup"
[0m23:51:27.761542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:27.762529 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:51:27.762651 [debug] [Thread-3 (]: SQL status: SELECT 245 in 0.006 seconds
[0m23:51:27.762792 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m23:51:27.763912 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:51:27.764186 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor" rename to "dim_vendor__dbt_backup"
[0m23:51:27.764313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:27.766336 [debug] [Thread-1 (]: On model.threat_risk.dim_product: COMMIT
[0m23:51:27.766460 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:51:27.766600 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:51:27.767601 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:51:27.767779 [debug] [Thread-1 (]: On model.threat_risk.dim_product: COMMIT
[0m23:51:27.767965 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor__dbt_tmp" rename to "dim_vendor"
[0m23:51:27.768471 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:27.769065 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: COMMIT
[0m23:51:27.769236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:51:27.769352 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:51:27.770226 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."marts"."dim_product__dbt_backup"
[0m23:51:27.770428 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: COMMIT
[0m23:51:27.771555 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m23:51:27.771883 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
drop table if exists "threat_risk"."marts"."dim_product__dbt_backup" cascade
[0m23:51:27.771685 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:51:27.773285 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:51:27.773451 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:51:27.773579 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:51:27.773715 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date" rename to "dim_date__dbt_backup"
[0m23:51:27.775748 [debug] [Thread-3 (]: Applying DROP to: "threat_risk"."marts"."dim_vendor__dbt_backup"
[0m23:51:27.776330 [debug] [Thread-1 (]: On model.threat_risk.dim_product: Close
[0m23:51:27.776734 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m23:51:27.776880 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:27.777227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c315550>]}
[0m23:51:27.777440 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
drop table if exists "threat_risk"."marts"."dim_vendor__dbt_backup" cascade
[0m23:51:27.778668 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:51:27.779421 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:51:27.779042 [info ] [Thread-1 (]: 11 of 33 OK created sql table model marts.dim_product .......................... [[32mSELECT 625[0m in 0.05s]
[0m23:51:27.779746 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_product
[0m23:51:27.779859 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:27.780853 [debug] [Thread-2 (]: On model.threat_risk.dim_date: COMMIT
[0m23:51:27.780059 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_url
[0m23:51:27.780975 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:51:27.781135 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:51:27.781331 [info ] [Thread-1 (]: 15 of 33 START sql table model marts.dim_url ................................... [RUN]
[0m23:51:27.781867 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: Close
[0m23:51:27.782031 [debug] [Thread-2 (]: On model.threat_risk.dim_date: COMMIT
[0m23:51:27.782214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_product, now model.threat_risk.dim_url)
[0m23:51:27.782506 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c314450>]}
[0m23:51:27.782751 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_url
[0m23:51:27.783029 [info ] [Thread-3 (]: 12 of 33 OK created sql table model marts.dim_vendor ........................... [[32mSELECT 245[0m in 0.06s]
[0m23:51:27.783171 [debug] [Thread-4 (]: SQL status: SELECT 13392 in 0.027 seconds
[0m23:51:27.783314 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:51:27.784437 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_url"
[0m23:51:27.784705 [debug] [Thread-3 (]: Finished running node model.threat_risk.dim_vendor
[0m23:51:27.785807 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:51:27.786637 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."marts"."dim_date__dbt_backup"
[0m23:51:27.786990 [debug] [Thread-3 (]: Began running node model.threat_risk.fact_url_events
[0m23:51:27.787299 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev" rename to "fact_kev__dbt_backup"
[0m23:51:27.787415 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_url
[0m23:51:27.787632 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m23:51:27.787843 [info ] [Thread-3 (]: 16 of 33 START sql table model marts.fact_url_events ........................... [RUN]
[0m23:51:27.789264 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.dim_url"
[0m23:51:27.789435 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:27.789590 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
drop table if exists "threat_risk"."marts"."dim_date__dbt_backup" cascade
[0m23:51:27.789777 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_vendor, now model.threat_risk.fact_url_events)
[0m23:51:27.791130 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:51:27.791365 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:51:27.791538 [debug] [Thread-3 (]: Began compiling node model.threat_risk.fact_url_events
[0m23:51:27.791730 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev__dbt_tmp" rename to "fact_kev"
[0m23:51:27.791942 [debug] [Thread-1 (]: On model.threat_risk.dim_url: BEGIN
[0m23:51:27.792075 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:51:27.793115 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.fact_url_events"
[0m23:51:27.793371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:27.793497 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:27.793961 [debug] [Thread-2 (]: On model.threat_risk.dim_date: Close
[0m23:51:27.794855 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: COMMIT
[0m23:51:27.795048 [debug] [Thread-3 (]: Began executing node model.threat_risk.fact_url_events
[0m23:51:27.796188 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec1d9d0>]}
[0m23:51:27.796374 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:51:27.797633 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.fact_url_events"
[0m23:51:27.797893 [info ] [Thread-2 (]: 14 of 33 OK created sql table model marts.dim_date ............................. [[32mSELECT 1[0m in 0.06s]
[0m23:51:27.798044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:27.798266 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: COMMIT
[0m23:51:27.798621 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_date
[0m23:51:27.798806 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:51:27.798944 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:51:27.799228 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:51:27.799334 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m23:51:27.799510 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */

  
    

  create  table "threat_risk"."marts"."dim_url__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  url,
  host
from (
  select distinct url, host
  from "threat_risk"."staging"."stg_urlhaus"
  where url is not null
) u
  );
  
[0m23:51:27.799709 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: BEGIN
[0m23:51:27.799860 [info ] [Thread-2 (]: 17 of 33 START test not_null_dim_product_product ............................... [RUN]
[0m23:51:27.801283 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_date, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m23:51:27.801018 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:51:27.800745 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."marts"."fact_kev__dbt_backup"
[0m23:51:27.801522 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:51:27.802056 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m23:51:27.804003 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
drop table if exists "threat_risk"."marts"."fact_kev__dbt_backup" cascade
[0m23:51:27.803820 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:51:27.804562 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:51:27.806327 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:51:27.806465 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:51:27.806571 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:27.807125 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: Close
[0m23:51:27.807342 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:51:27.807748 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c471a10>]}
[0m23:51:27.807545 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:51:27.807900 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */

  
    

  create  table "threat_risk"."marts"."fact_url_events__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  run_date as date_day,
  url_status,
  threat,
  tags,
  date_added,
  reporter,
  larted
from "threat_risk"."staging"."stg_urlhaus"
where url is not null
  );
  
[0m23:51:27.808191 [info ] [Thread-4 (]: 13 of 33 OK created sql table model marts.fact_kev ............................. [[32mSELECT 13392[0m in 0.08s]
[0m23:51:27.808431 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: BEGIN
[0m23:51:27.808808 [debug] [Thread-4 (]: Finished running node model.threat_risk.fact_kev
[0m23:51:27.808993 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:27.809206 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:51:27.809673 [info ] [Thread-4 (]: 18 of 33 START test not_null_dim_product_product_key ........................... [RUN]
[0m23:51:27.809932 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_kev, now test.threat_risk.not_null_dim_product_product_key.f0e1d838d3)
[0m23:51:27.810185 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:51:27.811905 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:51:27.812389 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:51:27.813300 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:51:27.813714 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:27.813979 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:51:27.814292 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product.56a877bc84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."marts"."dim_product"
where product is null



      
    ) dbt_internal_test
[0m23:51:27.814146 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:51:27.814540 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m23:51:27.814696 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:27.814922 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m23:51:27.815679 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: ROLLBACK
[0m23:51:27.815941 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: Close
[0m23:51:27.817457 [info ] [Thread-2 (]: 17 of 33 PASS not_null_dim_product_product ..................................... [[32mPASS[0m in 0.02s]
[0m23:51:27.817803 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:51:27.818102 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:51:27.818396 [info ] [Thread-2 (]: 19 of 33 START test not_null_dim_product_vendor_key ............................ [RUN]
[0m23:51:27.818892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.not_null_dim_product_vendor_key.78836999d2)
[0m23:51:27.818679 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:27.819210 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:51:27.819055 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:51:27.819351 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "threat_risk"."marts"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m23:51:27.821046 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:51:27.821590 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:51:27.821716 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m23:51:27.822554 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:51:27.823113 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m23:51:27.823456 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: Close
[0m23:51:27.823699 [info ] [Thread-4 (]: 18 of 33 PASS not_null_dim_product_product_key ................................. [[32mPASS[0m in 0.01s]
[0m23:51:27.823865 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:51:27.824232 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: BEGIN
[0m23:51:27.824065 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:51:27.824362 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:27.824540 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:51:27.825151 [info ] [Thread-4 (]: 20 of 33 START test not_null_dim_product_vendor_project ........................ [RUN]
[0m23:51:27.825527 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m23:51:27.825703 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:51:27.828512 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:51:27.828781 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:27.828979 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:51:27.829244 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_product"
where vendor_key is null



      
    ) dbt_internal_test
[0m23:51:27.829138 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:51:27.830167 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:51:27.830270 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:27.830882 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: ROLLBACK
[0m23:51:27.831107 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:51:27.831324 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: BEGIN
[0m23:51:27.831197 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: Close
[0m23:51:27.831668 [info ] [Thread-2 (]: 19 of 33 PASS not_null_dim_product_vendor_key .................................. [[32mPASS[0m in 0.01s]
[0m23:51:27.831450 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:27.831926 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:51:27.832346 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:51:27.832632 [info ] [Thread-2 (]: 21 of 33 START test unique_dim_product_product_key ............................. [RUN]
[0m23:51:27.832956 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m23:51:27.833210 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:51:27.837283 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:51:27.837588 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:27.837828 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:51:27.837951 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:51:27.838939 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:51:27.838076 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_product"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:51:27.839427 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:51:27.839640 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: BEGIN
[0m23:51:27.839926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:27.839772 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:27.840648 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: ROLLBACK
[0m23:51:27.840992 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: Close
[0m23:51:27.841294 [info ] [Thread-4 (]: 20 of 33 PASS not_null_dim_product_vendor_project .............................. [[32mPASS[0m in 0.02s]
[0m23:51:27.841660 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:51:27.842402 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:51:27.843192 [info ] [Thread-4 (]: 22 of 33 START test not_null_dim_vendor_vendor_key ............................. [RUN]
[0m23:51:27.843478 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m23:51:27.843707 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:51:27.845468 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:51:27.845674 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m23:51:27.846001 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:51:27.846241 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:27.846397 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:51:27.847370 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:51:27.847498 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:27.848202 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m23:51:27.848497 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: Close
[0m23:51:27.848757 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:51:27.849041 [info ] [Thread-2 (]: 21 of 33 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.02s]
[0m23:51:27.849354 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: BEGIN
[0m23:51:27.849879 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:27.849682 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:51:27.850220 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:51:27.850561 [info ] [Thread-2 (]: 23 of 33 START test not_null_dim_vendor_vendor_project ......................... [RUN]
[0m23:51:27.850844 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_product_product_key.1753236bd0, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m23:51:27.851102 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:51:27.853898 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:51:27.854257 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:27.854735 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:51:27.854906 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_vendor"
where vendor_key is null



      
    ) dbt_internal_test
[0m23:51:27.854600 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:51:27.857219 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:51:27.857336 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:51:27.858037 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: ROLLBACK
[0m23:51:27.858298 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:51:27.858665 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: BEGIN
[0m23:51:27.858546 [debug] [Thread-1 (]: SQL status: SELECT 22498 in 0.058 seconds
[0m23:51:27.858398 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: Close
[0m23:51:27.858819 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:27.859970 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:51:27.860399 [info ] [Thread-4 (]: 22 of 33 PASS not_null_dim_vendor_vendor_key ................................... [[32mPASS[0m in 0.02s]
[0m23:51:27.861429 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:51:27.860982 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url" rename to "dim_url__dbt_backup"
[0m23:51:27.861633 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:51:27.861889 [info ] [Thread-4 (]: 24 of 33 START test unique_dim_vendor_vendor_key ............................... [RUN]
[0m23:51:27.862238 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m23:51:27.862031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:27.862396 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:51:27.863576 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:51:27.865189 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:51:27.865448 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url__dbt_tmp" rename to "dim_url"
[0m23:51:27.865610 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:51:27.866007 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:51:27.866460 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_vendor"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:51:27.866306 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:51:27.866177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:27.867452 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:51:27.867602 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:27.868185 [debug] [Thread-1 (]: On model.threat_risk.dim_url: COMMIT
[0m23:51:27.868874 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: ROLLBACK
[0m23:51:27.869066 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:51:27.869246 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:51:27.869423 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: Close
[0m23:51:27.869568 [debug] [Thread-1 (]: On model.threat_risk.dim_url: COMMIT
[0m23:51:27.869774 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: BEGIN
[0m23:51:27.870042 [info ] [Thread-2 (]: 23 of 33 PASS not_null_dim_vendor_vendor_project ............................... [[32mPASS[0m in 0.02s]
[0m23:51:27.870446 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:27.870743 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:51:27.871105 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:51:27.871552 [info ] [Thread-2 (]: 25 of 33 START test unique_dim_vendor_vendor_project ........................... [RUN]
[0m23:51:27.871850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m23:51:27.872039 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:51:27.873572 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:51:27.873999 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:51:27.874880 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:51:27.875035 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:27.875515 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:51:27.875850 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:51:27.876039 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_key is not null
group by vendor_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:27.876312 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: BEGIN
[0m23:51:27.876761 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:27.877537 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:27.878756 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: ROLLBACK
[0m23:51:27.879764 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: Close
[0m23:51:27.880099 [info ] [Thread-4 (]: 24 of 33 PASS unique_dim_vendor_vendor_key ..................................... [[32mPASS[0m in 0.02s]
[0m23:51:27.880379 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:51:27.880617 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:51:27.880967 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:27.881365 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:51:27.881219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m23:51:27.880875 [info ] [Thread-4 (]: 26 of 33 START test not_null_fact_kev_cve_id ................................... [RUN]
[0m23:51:27.882775 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m23:51:27.882576 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."marts"."dim_url__dbt_backup"
[0m23:51:27.881531 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_project as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_project is not null
group by vendor_project
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:27.882940 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:51:27.883189 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m23:51:27.884779 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:51:27.884917 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:51:27.885066 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
drop table if exists "threat_risk"."marts"."dim_url__dbt_backup" cascade
[0m23:51:27.885773 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: ROLLBACK
[0m23:51:27.886034 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:51:27.886189 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: Close
[0m23:51:27.887037 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:51:27.887229 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:51:27.887409 [info ] [Thread-2 (]: 25 of 33 PASS unique_dim_vendor_vendor_project ................................. [[32mPASS[0m in 0.02s]
[0m23:51:27.888159 [debug] [Thread-1 (]: On model.threat_risk.dim_url: Close
[0m23:51:27.888771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3a72d0>]}
[0m23:51:27.888540 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:51:27.888404 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:51:27.889028 [info ] [Thread-1 (]: 15 of 33 OK created sql table model marts.dim_url .............................. [[32mSELECT 22498[0m in 0.11s]
[0m23:51:27.889743 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_url
[0m23:51:27.889504 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:51:27.889249 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: BEGIN
[0m23:51:27.890414 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:27.890205 [info ] [Thread-2 (]: 27 of 33 START test not_null_fact_kev_date_day ................................. [RUN]
[0m23:51:27.890040 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:51:27.890719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m23:51:27.890882 [info ] [Thread-1 (]: 28 of 33 START test not_null_dim_url_url ....................................... [RUN]
[0m23:51:27.891245 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:51:27.891480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_url, now test.threat_risk.not_null_dim_url_url.2b67971659)
[0m23:51:27.893044 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:51:27.893317 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:51:27.894926 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:51:27.895436 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:27.895595 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:51:27.895802 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:51:27.896004 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:51:27.898044 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:51:27.898237 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."marts"."fact_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m23:51:27.899013 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:51:27.899541 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:51:27.899705 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: BEGIN
[0m23:51:27.899985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:27.899900 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:51:27.900252 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: BEGIN
[0m23:51:27.900504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:27.901894 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:51:27.902553 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: ROLLBACK
[0m23:51:27.903115 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: Close
[0m23:51:27.903368 [info ] [Thread-4 (]: 26 of 33 PASS not_null_fact_kev_cve_id ......................................... [[32mPASS[0m in 0.02s]
[0m23:51:27.903773 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:51:27.904123 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:51:27.903974 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:27.904565 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:51:27.904343 [info ] [Thread-4 (]: 29 of 33 START test not_null_dim_url_url_key ................................... [RUN]
[0m23:51:27.904749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:27.904919 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_kev"
where date_day is null



      
    ) dbt_internal_test
[0m23:51:27.905123 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8, now test.threat_risk.not_null_dim_url_url_key.89914b0872)
[0m23:51:27.905329 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:51:27.905576 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:51:27.905777 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url.2b67971659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."dim_url"
where url is null



      
    ) dbt_internal_test
[0m23:51:27.907769 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:51:27.907957 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:51:27.908765 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: ROLLBACK
[0m23:51:27.909048 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:51:27.909162 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: Close
[0m23:51:27.910530 [info ] [Thread-2 (]: 27 of 33 PASS not_null_fact_kev_date_day ....................................... [[32mPASS[0m in 0.02s]
[0m23:51:27.910277 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:51:27.910144 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:51:27.910799 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:51:27.911380 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: ROLLBACK
[0m23:51:27.911696 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:51:27.911948 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:51:27.912058 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: Close
[0m23:51:27.912222 [info ] [Thread-2 (]: 30 of 33 START test unique_dim_url_url ......................................... [RUN]
[0m23:51:27.912970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_date_day.64362f7a33, now test.threat_risk.unique_dim_url_url.4c561dc36d)
[0m23:51:27.912712 [info ] [Thread-1 (]: 28 of 33 PASS not_null_dim_url_url ............................................. [[32mPASS[0m in 0.02s]
[0m23:51:27.912417 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: BEGIN
[0m23:51:27.913585 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:27.913438 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:51:27.913196 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:51:27.913857 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:51:27.915375 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:51:27.915583 [info ] [Thread-1 (]: 31 of 33 START test unique_dim_url_url_key ..................................... [RUN]
[0m23:51:27.916025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url.2b67971659, now test.threat_risk.unique_dim_url_url_key.d67ee5b979)
[0m23:51:27.917425 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:51:27.917588 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:51:27.918978 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:51:27.920122 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:51:27.920259 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m23:51:27.920754 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:51:27.920874 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:51:27.921032 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url_key.89914b0872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."dim_url"
where url_key is null



      
    ) dbt_internal_test
[0m23:51:27.921244 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:51:27.922000 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:51:27.922235 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: BEGIN
[0m23:51:27.922545 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:27.922880 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:51:27.923143 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: BEGIN
[0m23:51:27.923580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:27.923436 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:51:27.924434 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: ROLLBACK
[0m23:51:27.926193 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: Close
[0m23:51:27.926446 [info ] [Thread-4 (]: 29 of 33 PASS not_null_dim_url_url_key ......................................... [[32mPASS[0m in 0.02s]
[0m23:51:27.926688 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:51:27.926956 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:51:27.927167 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:51:27.927385 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url.4c561dc36d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:27.928493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:27.928690 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:51:27.928853 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url_key.d67ee5b979"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url_key is not null
group by url_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:27.932619 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:51:27.933265 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: ROLLBACK
[0m23:51:27.933448 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:51:27.933625 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: Close
[0m23:51:27.934065 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: ROLLBACK
[0m23:51:27.934415 [info ] [Thread-2 (]: 30 of 33 PASS unique_dim_url_url ............................................... [[32mPASS[0m in 0.02s]
[0m23:51:27.934750 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: Close
[0m23:51:27.934964 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:51:27.935234 [info ] [Thread-1 (]: 31 of 33 PASS unique_dim_url_url_key ........................................... [[32mPASS[0m in 0.02s]
[0m23:51:27.935651 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:51:27.939603 [debug] [Thread-3 (]: SQL status: SELECT 89991 in 0.131 seconds
[0m23:51:27.940776 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:51:27.941028 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events" rename to "fact_url_events__dbt_backup"
[0m23:51:27.941388 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:27.942257 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:51:27.942413 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events__dbt_tmp" rename to "fact_url_events"
[0m23:51:27.942693 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:27.943231 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: COMMIT
[0m23:51:27.943606 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:51:27.943758 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: COMMIT
[0m23:51:27.945999 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:51:27.947041 [debug] [Thread-3 (]: Applying DROP to: "threat_risk"."marts"."fact_url_events__dbt_backup"
[0m23:51:27.947261 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m23:51:27.947565 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
drop table if exists "threat_risk"."marts"."fact_url_events__dbt_backup" cascade
[0m23:51:27.948752 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:51:27.949255 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: Close
[0m23:51:27.949483 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83870a89-81f3-42e5-9cf8-19ff51cfa0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c282150>]}
[0m23:51:27.949738 [info ] [Thread-3 (]: 16 of 33 OK created sql table model marts.fact_url_events ...................... [[32mSELECT 89991[0m in 0.16s]
[0m23:51:27.950003 [debug] [Thread-3 (]: Finished running node model.threat_risk.fact_url_events
[0m23:51:27.950464 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:51:27.950595 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:51:27.950750 [info ] [Thread-4 (]: 32 of 33 START test not_null_fact_url_events_date_day .......................... [RUN]
[0m23:51:27.950970 [info ] [Thread-2 (]: 33 of 33 START test not_null_fact_url_events_url_key ........................... [RUN]
[0m23:51:27.951270 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url_key.89914b0872, now test.threat_risk.not_null_fact_url_events_date_day.d658eee263)
[0m23:51:27.951471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_url_url.4c561dc36d, now test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d)
[0m23:51:27.951644 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:51:27.951801 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:51:27.953392 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:51:27.955882 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:51:27.956407 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:51:27.956572 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:51:27.958023 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:51:27.957291 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:51:27.958430 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:51:27.958561 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:51:27.958801 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: BEGIN
[0m23:51:27.958676 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: BEGIN
[0m23:51:27.959030 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:27.958922 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:27.962350 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m23:51:27.962501 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:51:27.962633 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."fact_url_events"
where url_key is null



      
    ) dbt_internal_test
[0m23:51:27.963699 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m23:51:27.963845 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:51:27.963980 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_url_events"
where date_day is null



      
    ) dbt_internal_test
[0m23:51:27.968107 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:51:27.968271 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:51:27.968928 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: ROLLBACK
[0m23:51:27.969403 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: ROLLBACK
[0m23:51:27.969609 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: Close
[0m23:51:27.969979 [info ] [Thread-4 (]: 32 of 33 PASS not_null_fact_url_events_date_day ................................ [[32mPASS[0m in 0.02s]
[0m23:51:27.969750 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: Close
[0m23:51:27.970605 [info ] [Thread-2 (]: 33 of 33 PASS not_null_fact_url_events_url_key ................................. [[32mPASS[0m in 0.02s]
[0m23:51:27.970335 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:51:27.970902 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:51:27.971715 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:27.971866 [debug] [MainThread]: On master: BEGIN
[0m23:51:27.971988 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:27.975112 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:51:27.975262 [debug] [MainThread]: On master: COMMIT
[0m23:51:27.975408 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:27.975542 [debug] [MainThread]: On master: COMMIT
[0m23:51:27.975732 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:51:27.975870 [debug] [MainThread]: On master: Close
[0m23:51:27.976051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:27.976200 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url_key.d67ee5b979' was properly closed.
[0m23:51:27.976339 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d' was properly closed.
[0m23:51:27.976504 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_date_day.d658eee263' was properly closed.
[0m23:51:27.976650 [debug] [MainThread]: Connection 'model.threat_risk.fact_url_events' was properly closed.
[0m23:51:27.976873 [info ] [MainThread]: 
[0m23:51:27.977067 [info ] [MainThread]: Finished running 2 view models, 25 data tests, 6 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m23:51:27.978579 [debug] [MainThread]: Command end result
[0m23:51:27.994693 [info ] [MainThread]: 
[0m23:51:27.994924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:51:27.995147 [info ] [MainThread]: 
[0m23:51:27.995366 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 TOTAL=33
[0m23:51:27.995810 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.66736114, "process_user_time": 1.015167, "process_kernel_time": 0.080439, "process_mem_max_rss": "123292", "process_out_blocks": "4059", "process_in_blocks": "0"}
[0m23:51:27.996029 [debug] [MainThread]: Command `dbt build` succeeded at 23:51:27.995993 after 0.67 seconds
[0m23:51:27.996193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93870d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93870410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93870e90>]}
[0m23:51:27.996335 [debug] [MainThread]: Flushing usage events
[0m23:57:57.877933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e944c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e944b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e9415d0>]}


============================== 23:57:57.880399 | ea27889b-833c-4713-82a5-24a04e1c2a6d ==============================
[0m23:57:57.880399 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:57:57.880753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/logs', 'profiles_dir': '/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:57:57.927225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea27889b-833c-4713-82a5-24a04e1c2a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db28810>]}
[0m23:57:57.943945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea27889b-833c-4713-82a5-24a04e1c2a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da0dc50>]}
[0m23:57:57.944286 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:57:57.965119 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:57:58.005572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:57:58.005788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:57:58.018874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea27889b-833c-4713-82a5-24a04e1c2a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db08e10>]}
[0m23:57:58.059509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea27889b-833c-4713-82a5-24a04e1c2a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d663dd0>]}
[0m23:57:58.059786 [info ] [MainThread]: Found 8 models, 25 data tests, 429 macros
[0m23:57:58.060006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea27889b-833c-4713-82a5-24a04e1c2a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d8dad90>]}
[0m23:57:58.061279 [info ] [MainThread]: 
[0m23:57:58.061613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:57:58.063326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk_staging'
[0m23:57:58.063555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk_marts'
[0m23:57:58.078410 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m23:57:58.078550 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m23:57:58.078744 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m23:57:58.078953 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m23:57:58.079134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:58.079314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:58.085024 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:57:58.085226 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:57:58.085478 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m23:57:58.085676 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m23:57:58.085937 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m23:57:58.086127 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:57:58.088276 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m23:57:58.088403 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m23:57:58.088951 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m23:57:58.089432 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m23:57:58.089711 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m23:57:58.089879 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m23:57:58.092267 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:58.092434 [debug] [MainThread]: On master: BEGIN
[0m23:57:58.092572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:57:58.095501 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:57:58.095683 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:58.095868 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:57:58.098384 [debug] [MainThread]: SQL status: SELECT 4 in 0.002 seconds
[0m23:57:58.098873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea27889b-833c-4713-82a5-24a04e1c2a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db3f350>]}
[0m23:57:58.099067 [debug] [MainThread]: On master: ROLLBACK
[0m23:57:58.099269 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:58.099408 [debug] [MainThread]: On master: BEGIN
[0m23:57:58.099669 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:57:58.099837 [debug] [MainThread]: On master: COMMIT
[0m23:57:58.099969 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:58.100097 [debug] [MainThread]: On master: COMMIT
[0m23:57:58.100296 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:57:58.100442 [debug] [MainThread]: On master: Close
[0m23:57:58.100668 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:57:58.100892 [info ] [MainThread]: 
[0m23:57:58.104835 [debug] [Thread-1 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:57:58.104992 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:57:58.105125 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:57:58.105319 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:57:58.105461 [info ] [Thread-1 (]: 1 of 25 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m23:57:58.105731 [info ] [Thread-2 (]: 2 of 25 START test not_null_dim_product_product ................................ [RUN]
[0m23:57:58.106110 [info ] [Thread-3 (]: 3 of 25 START test not_null_dim_product_product_key ............................ [RUN]
[0m23:57:58.106388 [info ] [Thread-4 (]: 4 of 25 START test not_null_dim_product_vendor_key ............................. [RUN]
[0m23:57:58.106695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41)
[0m23:57:58.106917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m23:57:58.107170 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.threat_risk.not_null_dim_product_product_key.f0e1d838d3'
[0m23:57:58.107423 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.threat_risk.not_null_dim_product_vendor_key.78836999d2'
[0m23:57:58.107623 [debug] [Thread-1 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:57:58.107837 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:57:58.108030 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:57:58.108228 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:57:58.114512 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:57:58.117397 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:57:58.118768 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:57:58.120071 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:57:58.121101 [debug] [Thread-1 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:57:58.121369 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:57:58.126073 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:57:58.126236 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:57:58.126390 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:57:58.127158 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:57:58.128100 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:57:58.128845 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:57:58.129149 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:57:58.129583 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:57:58.130169 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: BEGIN
[0m23:57:58.129893 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m23:57:58.130035 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:57:58.129760 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:57:58.130747 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m23:57:58.130439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:58.130585 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: BEGIN
[0m23:57:58.130298 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:57:58.130899 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:57:58.131328 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:57:58.138700 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:57:58.138909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:57:58.139149 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:57:58.139721 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product.56a877bc84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."marts"."dim_product"
where product is null



      
    ) dbt_internal_test
[0m23:57:58.139396 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:57:58.139554 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:57:58.139289 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:57:58.139939 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:57:58.140131 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m23:57:58.140309 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:57:58.140892 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "threat_risk"."marts"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m23:57:58.140612 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_product"
where vendor_key is null



      
    ) dbt_internal_test
[0m23:57:58.140428 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:57:58.143313 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: ROLLBACK
[0m23:57:58.143501 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:57:58.143658 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:57:58.143994 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: Close
[0m23:57:58.144655 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m23:57:58.145445 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: ROLLBACK
[0m23:57:58.145912 [info ] [Thread-2 (]: 2 of 25 PASS not_null_dim_product_product ...................................... [[32mPASS[0m in 0.04s]
[0m23:57:58.147172 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:57:58.146829 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: Close
[0m23:57:58.146361 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: Close
[0m23:57:58.147414 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:57:58.147871 [info ] [Thread-4 (]: 4 of 25 PASS not_null_dim_product_vendor_key ................................... [[32mPASS[0m in 0.04s]
[0m23:57:58.148297 [info ] [Thread-3 (]: 3 of 25 PASS not_null_dim_product_product_key .................................. [[32mPASS[0m in 0.04s]
[0m23:57:58.149363 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:57:58.149040 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:57:58.148531 [info ] [Thread-2 (]: 5 of 25 START test not_null_dim_product_vendor_project ......................... [RUN]
[0m23:57:58.150253 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m23:57:58.149952 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:57:58.149625 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:57:58.151075 [info ] [Thread-3 (]: 6 of 25 START test not_null_dim_url_url ........................................ [RUN]
[0m23:57:58.150764 [info ] [Thread-4 (]: 7 of 25 START test not_null_dim_url_url_key .................................... [RUN]
[0m23:57:58.150455 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:57:58.151391 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.not_null_dim_url_url.2b67971659)
[0m23:57:58.151701 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.not_null_dim_url_url_key.89914b0872)
[0m23:57:58.153582 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:57:58.153763 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:57:58.153946 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:57:58.154134 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:57:58.154878 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m23:57:58.156319 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:57:58.156464 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:57:58.157726 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:57:58.157980 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m23:57:58.159611 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:57:58.159912 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:57:58.160145 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:57:58.160363 [info ] [Thread-1 (]: 1 of 25 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown .. [[32mPASS[0m in 0.05s]
[0m23:57:58.161431 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:57:58.161571 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:57:58.162874 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: BEGIN
[0m23:57:58.162574 [debug] [Thread-1 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:57:58.162333 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:57:58.163024 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:57:58.163206 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:57:58.163397 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:57:58.164270 [info ] [Thread-1 (]: 8 of 25 START test not_null_dim_vendor_vendor_key .............................. [RUN]
[0m23:57:58.164060 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: BEGIN
[0m23:57:58.163935 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:57:58.164535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m23:57:58.164782 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:57:58.164981 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: BEGIN
[0m23:57:58.165225 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:57:58.165703 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:57:58.167794 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:57:58.168067 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m23:57:58.168468 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:57:58.168733 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_product"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:57:58.168878 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:57:58.168981 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:57:58.169905 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:57:58.170034 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:57:58.170174 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:57:58.170858 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: ROLLBACK
[0m23:57:58.171093 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:57:58.171218 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url.2b67971659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."dim_url"
where url is null



      
    ) dbt_internal_test
[0m23:57:58.171346 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:57:58.171561 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: Close
[0m23:57:58.171689 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: BEGIN
[0m23:57:58.171945 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:57:58.172197 [info ] [Thread-2 (]: 5 of 25 PASS not_null_dim_product_vendor_project ............................... [[32mPASS[0m in 0.02s]
[0m23:57:58.172999 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:57:58.172725 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url_key.89914b0872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."dim_url"
where url_key is null



      
    ) dbt_internal_test
[0m23:57:58.172435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:58.173118 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:57:58.173282 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:57:58.174036 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: ROLLBACK
[0m23:57:58.174218 [info ] [Thread-2 (]: 9 of 25 START test not_null_dim_vendor_vendor_project .......................... [RUN]
[0m23:57:58.174421 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:57:58.174661 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: Close
[0m23:57:58.176014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m23:57:58.176514 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: ROLLBACK
[0m23:57:58.176759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:57:58.176960 [info ] [Thread-3 (]: 6 of 25 PASS not_null_dim_url_url .............................................. [[32mPASS[0m in 0.03s]
[0m23:57:58.177152 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:57:58.177406 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: Close
[0m23:57:58.177519 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:57:58.177755 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:57:58.179242 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:57:58.179506 [info ] [Thread-4 (]: 7 of 25 PASS not_null_dim_url_url_key .......................................... [[32mPASS[0m in 0.03s]
[0m23:57:58.179695 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_vendor"
where vendor_key is null



      
    ) dbt_internal_test
[0m23:57:58.180023 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:57:58.180539 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:57:58.180829 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:57:58.181025 [info ] [Thread-3 (]: 10 of 25 START test not_null_fact_kev_cve_id ................................... [RUN]
[0m23:57:58.182512 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url.2b67971659, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m23:57:58.181480 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:57:58.182316 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:57:58.181304 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:57:58.182654 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:57:58.183198 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: ROLLBACK
[0m23:57:58.183539 [info ] [Thread-4 (]: 11 of 25 START test not_null_fact_kev_date_day ................................. [RUN]
[0m23:57:58.183796 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:57:58.185172 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:57:58.185411 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: Close
[0m23:57:58.185522 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url_key.89914b0872, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m23:57:58.185712 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: BEGIN
[0m23:57:58.186568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:57:58.186122 [info ] [Thread-1 (]: 8 of 25 PASS not_null_dim_vendor_vendor_key .................................... [[32mPASS[0m in 0.02s]
[0m23:57:58.186456 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:57:58.186240 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:57:58.187120 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:57:58.188030 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:57:58.190480 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:57:58.190724 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:57:58.190891 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:57:58.191334 [info ] [Thread-1 (]: 12 of 25 START test not_null_fact_url_events_date_day .......................... [RUN]
[0m23:57:58.191543 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:57:58.191762 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:57:58.191892 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:57:58.193462 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_vendor"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:57:58.192436 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: BEGIN
[0m23:57:58.193278 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:57:58.192203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.not_null_fact_url_events_date_day.d658eee263)
[0m23:57:58.193711 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:57:58.194017 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:57:58.194124 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:57:58.194406 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:57:58.195827 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:57:58.196414 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: ROLLBACK
[0m23:57:58.196627 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: BEGIN
[0m23:57:58.197062 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: Close
[0m23:57:58.197263 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:57:58.197444 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:57:58.197574 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:57:58.197894 [info ] [Thread-2 (]: 9 of 25 PASS not_null_dim_vendor_vendor_project ................................ [[32mPASS[0m in 0.02s]
[0m23:57:58.200127 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:57:58.200352 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:57:58.200575 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:57:58.200877 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m23:57:58.201040 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."marts"."fact_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m23:57:58.201282 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:57:58.201413 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:57:58.201606 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:57:58.201885 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: BEGIN
[0m23:57:58.202073 [info ] [Thread-2 (]: 13 of 25 START test not_null_fact_url_events_url_key ........................... [RUN]
[0m23:57:58.202304 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_kev"
where date_day is null



      
    ) dbt_internal_test
[0m23:57:58.202623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:58.202904 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d)
[0m23:57:58.203336 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:57:58.203556 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:57:58.227501 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.024 seconds
[0m23:57:58.228886 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:57:58.229565 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: ROLLBACK
[0m23:57:58.229724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m23:57:58.230889 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:57:58.230771 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: Close
[0m23:57:58.230230 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: ROLLBACK
[0m23:57:58.231570 [info ] [Thread-3 (]: 10 of 25 PASS not_null_fact_kev_cve_id ......................................... [[32mPASS[0m in 0.05s]
[0m23:57:58.231251 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:57:58.231097 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_url_events"
where date_day is null



      
    ) dbt_internal_test
[0m23:57:58.231810 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: Close
[0m23:57:58.232057 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:57:58.232959 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:57:58.233285 [info ] [Thread-4 (]: 11 of 25 PASS not_null_fact_kev_date_day ....................................... [[32mPASS[0m in 0.05s]
[0m23:57:58.234057 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:57:58.233503 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:57:58.234240 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:57:58.234441 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:57:58.234585 [info ] [Thread-3 (]: 14 of 25 START test not_null_stg_kev_cve_id .................................... [RUN]
[0m23:57:58.235326 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8, now test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0)
[0m23:57:58.235100 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: BEGIN
[0m23:57:58.234768 [info ] [Thread-4 (]: 15 of 25 START test not_null_stg_kev_product ................................... [RUN]
[0m23:57:58.235885 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_date_day.64362f7a33, now test.threat_risk.not_null_stg_kev_product.9b2d2b4877)
[0m23:57:58.235671 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:57:58.235480 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:57:58.236034 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:57:58.237705 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:57:58.237859 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:57:58.239228 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:57:58.239537 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:57:58.240070 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: ROLLBACK
[0m23:57:58.240327 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:57:58.240510 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:57:58.240694 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:57:58.240811 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: Close
[0m23:57:58.241580 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:57:58.241749 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."fact_url_events"
where url_key is null



      
    ) dbt_internal_test
[0m23:57:58.242609 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:57:58.242911 [info ] [Thread-1 (]: 12 of 25 PASS not_null_fact_url_events_date_day ................................ [[32mPASS[0m in 0.05s]
[0m23:57:58.243444 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:57:58.243692 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:57:58.244150 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:57:58.244006 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:57:58.243856 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m23:57:58.244341 [info ] [Thread-1 (]: 16 of 25 START test not_null_stg_kev_run_date .................................. [RUN]
[0m23:57:58.244940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_url_events_date_day.d658eee263, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m23:57:58.244768 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:57:58.244579 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m23:57:58.245083 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:57:58.245355 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:57:58.246890 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:57:58.247028 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:57:58.247869 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: ROLLBACK
[0m23:57:58.248118 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: Close
[0m23:57:58.248580 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:57:58.248945 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:57:58.249317 [info ] [Thread-2 (]: 13 of 25 PASS not_null_fact_url_events_url_key ................................. [[32mPASS[0m in 0.05s]
[0m23:57:58.249577 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:57:58.250580 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:57:58.250858 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:57:58.250980 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:57:58.251138 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m23:57:58.251480 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:57:58.251762 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:57:58.251899 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:57:58.252130 [info ] [Thread-2 (]: 17 of 25 START test not_null_stg_kev_vendor_project ............................ [RUN]
[0m23:57:58.252342 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m23:57:58.252537 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m23:57:58.252770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m23:57:58.253156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:58.253453 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:57:58.256359 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:57:58.256934 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:57:58.258131 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:57:58.258422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:57:58.258605 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:57:58.258791 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:57:58.258918 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:57:58.259047 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:57:58.260493 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m23:57:58.260120 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m23:57:58.260324 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m23:57:58.259636 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m23:57:58.260629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:57:58.260845 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m23:57:58.261052 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m23:57:58.261348 [info ] [Thread-4 (]: 15 of 25 PASS not_null_stg_kev_product ......................................... [[32mPASS[0m in 0.03s]
[0m23:57:58.261683 [info ] [Thread-3 (]: 14 of 25 PASS not_null_stg_kev_cve_id .......................................... [[32mPASS[0m in 0.03s]
[0m23:57:58.261997 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:57:58.262442 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:57:58.262244 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:57:58.262628 [info ] [Thread-4 (]: 18 of 25 START test not_null_stg_urlhaus_run_date .............................. [RUN]
[0m23:57:58.263038 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93)
[0m23:57:58.262802 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:57:58.263201 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:57:58.263321 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:57:58.263455 [info ] [Thread-3 (]: 19 of 25 START test not_null_stg_urlhaus_url ................................... [RUN]
[0m23:57:58.265088 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:57:58.265671 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m23:57:58.265806 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m23:57:58.265956 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m23:57:58.266408 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:57:58.266523 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m23:57:58.266655 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:57:58.266927 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:57:58.267128 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m23:57:58.267386 [info ] [Thread-1 (]: 16 of 25 PASS not_null_stg_kev_run_date ........................................ [[32mPASS[0m in 0.02s]
[0m23:57:58.269450 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:57:58.271092 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:57:58.271444 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:57:58.272063 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:57:58.272247 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:57:58.272390 [info ] [Thread-1 (]: 20 of 25 START test not_null_stg_urlhaus_url_status ............................ [RUN]
[0m23:57:58.272544 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:57:58.272801 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m23:57:58.274064 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:57:58.273900 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:57:58.272997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m23:57:58.274637 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:57:58.274796 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:57:58.277320 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:57:58.277473 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:57:58.278090 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m23:57:58.278263 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m23:57:58.278499 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m23:57:58.278711 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m23:57:58.278810 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:57:58.278943 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:57:58.280477 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m23:57:58.279322 [info ] [Thread-2 (]: 17 of 25 PASS not_null_stg_kev_vendor_project .................................. [[32mPASS[0m in 0.03s]
[0m23:57:58.280298 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:57:58.279081 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:57:58.280761 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:57:58.281229 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:57:58.281367 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:57:58.281693 [info ] [Thread-2 (]: 21 of 25 START test unique_dim_product_product_key ............................. [RUN]
[0m23:57:58.282087 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m23:57:58.282445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m23:57:58.282659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:58.282977 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:57:58.286534 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:57:58.286802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:57:58.286925 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:57:58.287101 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:57:58.287224 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:57:58.287347 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:57:58.287522 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m23:57:58.288362 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:57:58.288483 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:57:58.289473 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m23:57:58.288638 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m23:57:58.289721 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:57:58.289863 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m23:57:58.290381 [info ] [Thread-4 (]: 18 of 25 PASS not_null_stg_urlhaus_run_date .................................... [[32mPASS[0m in 0.03s]
[0m23:57:58.290096 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: BEGIN
[0m23:57:58.290960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:57:58.290768 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:57:58.291312 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:57:58.291572 [info ] [Thread-4 (]: 22 of 25 START test unique_dim_url_url ......................................... [RUN]
[0m23:57:58.291888 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now test.threat_risk.unique_dim_url_url.4c561dc36d)
[0m23:57:58.292089 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:57:58.294293 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:57:58.294596 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:57:58.294856 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:57:58.295111 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:57:58.294983 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:57:58.296121 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:57:58.296243 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:57:58.296832 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m23:57:58.297050 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:57:58.297269 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: BEGIN
[0m23:57:58.297140 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: Close
[0m23:57:58.297392 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:57:58.297638 [info ] [Thread-2 (]: 21 of 25 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.02s]
[0m23:57:58.298432 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:57:58.298815 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:57:58.299664 [info ] [Thread-2 (]: 23 of 25 START test unique_dim_url_url_key ..................................... [RUN]
[0m23:57:58.300633 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_product_product_key.1753236bd0, now test.threat_risk.unique_dim_url_url_key.d67ee5b979)
[0m23:57:58.300798 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:57:58.302461 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:57:58.302649 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:57:58.302814 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:57:58.302929 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m23:57:58.303599 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m23:57:58.303854 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:57:58.304276 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m23:57:58.304454 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:57:58.304696 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m23:57:58.305472 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:57:58.305727 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m23:57:58.305847 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url.4c561dc36d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m23:57:58.306118 [info ] [Thread-3 (]: 19 of 25 PASS not_null_stg_urlhaus_url ......................................... [[32mPASS[0m in 0.04s]
[0m23:57:58.306583 [info ] [Thread-1 (]: 20 of 25 PASS not_null_stg_urlhaus_url_status .................................. [[32mPASS[0m in 0.03s]
[0m23:57:58.306891 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:57:58.307115 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:57:58.307380 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:57:58.308024 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:57:58.307822 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:57:58.307600 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: BEGIN
[0m23:57:58.308756 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:57:58.308444 [info ] [Thread-3 (]: 24 of 25 START test unique_dim_vendor_vendor_key ............................... [RUN]
[0m23:57:58.308175 [info ] [Thread-1 (]: 25 of 25 START test unique_dim_vendor_vendor_project ........................... [RUN]
[0m23:57:58.309111 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m23:57:58.309337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m23:57:58.309553 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:57:58.309774 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:57:58.312880 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:57:58.313026 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:57:58.315759 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:57:58.315901 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:57:58.316608 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: ROLLBACK
[0m23:57:58.316870 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:57:58.317054 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:57:58.317176 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:57:58.317372 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: Close
[0m23:57:58.318131 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:57:58.318341 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url_key.d67ee5b979"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url_key is not null
group by url_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:57:58.319143 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:57:58.319378 [info ] [Thread-4 (]: 22 of 25 PASS unique_dim_url_url ............................................... [[32mPASS[0m in 0.03s]
[0m23:57:58.320165 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:57:58.319864 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:57:58.320444 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: BEGIN
[0m23:57:58.320600 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:57:58.320771 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:57:58.320993 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: BEGIN
[0m23:57:58.321366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:58.324558 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m23:57:58.324713 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:57:58.324887 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:57:58.325433 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: ROLLBACK
[0m23:57:58.325638 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_key is not null
group by vendor_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:57:58.325884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m23:57:58.326053 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: Close
[0m23:57:58.326239 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:57:58.326506 [info ] [Thread-2 (]: 23 of 25 PASS unique_dim_url_url_key ........................................... [[32mPASS[0m in 0.03s]
[0m23:57:58.326751 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_project as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_project is not null
group by vendor_project
having count(*) > 1



      
    ) dbt_internal_test
[0m23:57:58.326923 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:57:58.327158 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:57:58.327914 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: ROLLBACK
[0m23:57:58.328026 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:57:58.328876 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: ROLLBACK
[0m23:57:58.328417 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: Close
[0m23:57:58.329258 [info ] [Thread-3 (]: 24 of 25 PASS unique_dim_vendor_vendor_key ..................................... [[32mPASS[0m in 0.02s]
[0m23:57:58.329087 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: Close
[0m23:57:58.329842 [info ] [Thread-1 (]: 25 of 25 PASS unique_dim_vendor_vendor_project ................................. [[32mPASS[0m in 0.02s]
[0m23:57:58.329511 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:57:58.330149 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:57:58.330949 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:58.331098 [debug] [MainThread]: On master: BEGIN
[0m23:57:58.331226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:57:58.334033 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:57:58.334162 [debug] [MainThread]: On master: COMMIT
[0m23:57:58.334278 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:58.334382 [debug] [MainThread]: On master: COMMIT
[0m23:57:58.334530 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:57:58.334647 [debug] [MainThread]: On master: Close
[0m23:57:58.334831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:58.334955 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96' was properly closed.
[0m23:57:58.335063 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url_key.d67ee5b979' was properly closed.
[0m23:57:58.335166 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68' was properly closed.
[0m23:57:58.335264 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url.4c561dc36d' was properly closed.
[0m23:57:58.335411 [info ] [MainThread]: 
[0m23:57:58.335584 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m23:57:58.336740 [debug] [MainThread]: Command end result
[0m23:57:58.352658 [info ] [MainThread]: 
[0m23:57:58.352951 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:57:58.353209 [info ] [MainThread]: 
[0m23:57:58.353388 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m23:57:58.353897 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49151683, "process_user_time": 0.86602, "process_kernel_time": 0.098571, "process_mem_max_rss": "122076", "process_out_blocks": "3946", "process_in_blocks": "0"}
[0m23:57:58.354111 [debug] [MainThread]: Command `dbt test` succeeded at 23:57:58.354078 after 0.49 seconds
[0m23:57:58.354263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1ae4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35e0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35e0d10>]}
[0m23:57:58.354407 [debug] [MainThread]: Flushing usage events
[0m23:58:09.952646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf85690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf814d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf85a90>]}


============================== 23:58:09.955344 | 4d774d2f-bea9-42ec-975b-1119ee4363b9 ==============================
[0m23:58:09.955344 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:58:09.955644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:58:10.000974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d774d2f-bea9-42ec-975b-1119ee4363b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1d3c10>]}
[0m23:58:10.017385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d774d2f-bea9-42ec-975b-1119ee4363b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f48a210>]}
[0m23:58:10.017762 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:58:10.038320 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:58:10.078102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:58:10.078321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:58:10.091154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d774d2f-bea9-42ec-975b-1119ee4363b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be60090>]}
[0m23:58:10.097993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d774d2f-bea9-42ec-975b-1119ee4363b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c158a50>]}
[0m23:58:10.098214 [info ] [MainThread]: Found 8 models, 25 data tests, 429 macros
[0m23:58:10.098399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d774d2f-bea9-42ec-975b-1119ee4363b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d0ee510>]}
[0m23:58:10.099477 [info ] [MainThread]: 
[0m23:58:10.099798 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:58:10.101390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk_staging'
[0m23:58:10.101640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk_marts'
[0m23:58:10.116120 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m23:58:10.116259 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m23:58:10.116432 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m23:58:10.116626 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m23:58:10.116793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:10.116992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:10.122163 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:58:10.122311 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:58:10.122475 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m23:58:10.122677 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m23:58:10.122865 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:58:10.123077 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m23:58:10.125003 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m23:58:10.125124 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m23:58:10.125700 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m23:58:10.126194 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m23:58:10.126479 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m23:58:10.126657 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m23:58:10.129003 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:10.129170 [debug] [MainThread]: On master: BEGIN
[0m23:58:10.129306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:58:10.132199 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:58:10.132397 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:10.132576 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:58:10.134902 [debug] [MainThread]: SQL status: SELECT 4 in 0.002 seconds
[0m23:58:10.135333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d774d2f-bea9-42ec-975b-1119ee4363b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f4944d0>]}
[0m23:58:10.135516 [debug] [MainThread]: On master: ROLLBACK
[0m23:58:10.135704 [debug] [MainThread]: On master: Close
[0m23:58:10.135895 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:58:10.136147 [info ] [MainThread]: 
[0m23:58:10.139788 [debug] [Thread-1 (]: Began running node model.threat_risk.stg_kev
[0m23:58:10.139959 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_urlhaus
[0m23:58:10.140195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now model.threat_risk.stg_kev)
[0m23:58:10.140437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now model.threat_risk.stg_urlhaus)
[0m23:58:10.140637 [debug] [Thread-1 (]: Began compiling node model.threat_risk.stg_kev
[0m23:58:10.140853 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_urlhaus
[0m23:58:10.143271 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.stg_kev"
[0m23:58:10.144018 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus"
[0m23:58:10.144848 [debug] [Thread-1 (]: Began executing node model.threat_risk.stg_kev
[0m23:58:10.145300 [debug] [Thread-1 (]: Finished running node model.threat_risk.stg_kev
[0m23:58:10.145078 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_urlhaus
[0m23:58:10.145789 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_urlhaus
[0m23:58:10.145945 [debug] [Thread-4 (]: Began running node model.threat_risk.dim_product
[0m23:58:10.146075 [debug] [Thread-3 (]: Began running node model.threat_risk.dim_vendor
[0m23:58:10.146210 [debug] [Thread-2 (]: Began running node model.threat_risk.fact_kev
[0m23:58:10.147078 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus, now model.threat_risk.fact_kev)
[0m23:58:10.146654 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.threat_risk.dim_product'
[0m23:58:10.146894 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.threat_risk.dim_vendor'
[0m23:58:10.146308 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:58:10.147708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_kev, now test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0)
[0m23:58:10.147373 [debug] [Thread-4 (]: Began compiling node model.threat_risk.dim_product
[0m23:58:10.147539 [debug] [Thread-3 (]: Began compiling node model.threat_risk.dim_vendor
[0m23:58:10.147219 [debug] [Thread-2 (]: Began compiling node model.threat_risk.fact_kev
[0m23:58:10.147845 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:58:10.148923 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.dim_product"
[0m23:58:10.149929 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.dim_vendor"
[0m23:58:10.150919 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.fact_kev"
[0m23:58:10.154710 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m23:58:10.155561 [debug] [Thread-4 (]: Began executing node model.threat_risk.dim_product
[0m23:58:10.155724 [debug] [Thread-3 (]: Began executing node model.threat_risk.dim_vendor
[0m23:58:10.155918 [debug] [Thread-2 (]: Began executing node model.threat_risk.fact_kev
[0m23:58:10.156227 [debug] [Thread-4 (]: Finished running node model.threat_risk.dim_product
[0m23:58:10.156688 [debug] [Thread-3 (]: Finished running node model.threat_risk.dim_vendor
[0m23:58:10.156940 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:58:10.157180 [debug] [Thread-2 (]: Finished running node model.threat_risk.fact_kev
[0m23:58:10.158232 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:58:10.157707 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:58:10.158058 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m23:58:10.157398 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:58:10.158993 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_product, now test.threat_risk.not_null_stg_kev_product.9b2d2b4877)
[0m23:58:10.158647 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_vendor, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m23:58:10.158833 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_date
[0m23:58:10.158458 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_kev, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m23:58:10.159623 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:58:10.159282 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:58:10.159461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now model.threat_risk.dim_date)
[0m23:58:10.159130 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:58:10.161637 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m23:58:10.163030 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m23:58:10.163207 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_date
[0m23:58:10.164490 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m23:58:10.164920 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:58:10.165827 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_date"
[0m23:58:10.166020 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:58:10.166363 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m23:58:10.166616 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:58:10.166880 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m23:58:10.167087 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_date
[0m23:58:10.167267 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_url
[0m23:58:10.167717 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m23:58:10.167899 [debug] [Thread-3 (]: Began running node model.threat_risk.fact_url_events
[0m23:58:10.168169 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_date
[0m23:58:10.168368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now model.threat_risk.dim_url)
[0m23:58:10.168553 [debug] [Thread-4 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:58:10.169323 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41)
[0m23:58:10.168958 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:58:10.169173 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_url
[0m23:58:10.168766 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now model.threat_risk.fact_url_events)
[0m23:58:10.170658 [debug] [Thread-3 (]: Began compiling node model.threat_risk.fact_url_events
[0m23:58:10.169645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_date, now test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93)
[0m23:58:10.170489 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_url"
[0m23:58:10.169459 [debug] [Thread-4 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:58:10.171538 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.fact_url_events"
[0m23:58:10.171722 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:58:10.174872 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m23:58:10.175194 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_url
[0m23:58:10.176374 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m23:58:10.176552 [debug] [Thread-3 (]: Began executing node model.threat_risk.fact_url_events
[0m23:58:10.176909 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_url
[0m23:58:10.177201 [debug] [Thread-4 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:58:10.178316 [debug] [Thread-4 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m23:58:10.177837 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:58:10.178063 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:58:10.177637 [debug] [Thread-3 (]: Finished running node model.threat_risk.fact_url_events
[0m23:58:10.179110 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:58:10.178657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_url, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m23:58:10.178932 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m23:58:10.178460 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:58:10.179336 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_url_events, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m23:58:10.179499 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:58:10.179691 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:58:10.179875 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m23:58:10.180052 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:58:10.181384 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m23:58:10.181608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now test.threat_risk.not_null_dim_product_product_key.f0e1d838d3)
[0m23:58:10.181782 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:58:10.183053 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m23:58:10.183324 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:58:10.184524 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m23:58:10.184668 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:58:10.185927 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m23:58:10.186180 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:58:10.186947 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m23:58:10.186623 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:58:10.186431 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m23:58:10.187117 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:58:10.187290 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:58:10.188121 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m23:58:10.187681 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:58:10.187861 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.not_null_dim_product_vendor_key.78836999d2)
[0m23:58:10.187517 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m23:58:10.189110 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:58:10.188682 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m23:58:10.188930 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:58:10.188296 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:58:10.189268 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m23:58:10.189438 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:58:10.191370 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m23:58:10.191557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m23:58:10.193274 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:58:10.192961 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m23:58:10.191728 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:58:10.195199 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m23:58:10.195395 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:58:10.196712 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m23:58:10.196963 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:58:10.197224 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m23:58:10.197427 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:58:10.197717 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m23:58:10.197889 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:58:10.197998 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:58:10.198261 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m23:58:10.198429 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:58:10.198696 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m23:58:10.198873 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m23:58:10.199044 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:58:10.199726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_product_product_key.1753236bd0, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m23:58:10.199401 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:58:10.199562 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:58:10.199216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m23:58:10.201346 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:58:10.200040 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m23:58:10.201214 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m23:58:10.199862 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:58:10.202507 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m23:58:10.202686 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:58:10.204082 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m23:58:10.204393 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:58:10.205619 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m23:58:10.205818 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:58:10.206131 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m23:58:10.206343 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:58:10.207167 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m23:58:10.206801 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:58:10.206925 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:58:10.206653 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m23:58:10.207322 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:58:10.208113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96, now test.threat_risk.not_null_dim_url_url.2b67971659)
[0m23:58:10.207746 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m23:58:10.207919 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:58:10.207561 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m23:58:10.208759 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:58:10.208402 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:58:10.208566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68, now test.threat_risk.not_null_dim_url_url_key.89914b0872)
[0m23:58:10.208254 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:58:10.208931 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8, now test.threat_risk.unique_dim_url_url.4c561dc36d)
[0m23:58:10.210193 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m23:58:10.210360 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:58:10.211558 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m23:58:10.211706 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:58:10.212981 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m23:58:10.213218 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:58:10.214379 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m23:58:10.214493 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:58:10.214850 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m23:58:10.215015 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:58:10.215288 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m23:58:10.215487 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:58:10.215799 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:58:10.216063 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m23:58:10.216899 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:58:10.216470 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_date_day.64362f7a33, now test.threat_risk.unique_dim_url_url_key.d67ee5b979)
[0m23:58:10.216722 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m23:58:10.216280 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:58:10.217477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url.2b67971659, now test.threat_risk.not_null_fact_url_events_date_day.d658eee263)
[0m23:58:10.217240 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:58:10.217062 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url_key.89914b0872, now test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d)
[0m23:58:10.217623 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:58:10.219585 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m23:58:10.219755 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:58:10.220908 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m23:58:10.222211 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m23:58:10.222436 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:58:10.222716 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:58:10.222937 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m23:58:10.223187 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m23:58:10.223283 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:58:10.223691 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m23:58:10.224432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:10.224575 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_date_day.d658eee263' was properly closed.
[0m23:58:10.224707 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d' was properly closed.
[0m23:58:10.224823 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url.4c561dc36d' was properly closed.
[0m23:58:10.224931 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url_key.d67ee5b979' was properly closed.
[0m23:58:10.226346 [debug] [MainThread]: Command end result
[0m23:58:10.280608 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:58:10.280768 [info ] [MainThread]: Building catalog
[0m23:58:10.284294 [debug] [ThreadPool]: Acquiring new postgres connection 'threat_risk.information_schema'
[0m23:58:10.286906 [debug] [ThreadPool]: Using postgres connection "threat_risk.information_schema"
[0m23:58:10.287041 [debug] [ThreadPool]: On threat_risk.information_schema: BEGIN
[0m23:58:10.287143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:10.290662 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:58:10.290795 [debug] [ThreadPool]: Using postgres connection "threat_risk.information_schema"
[0m23:58:10.290975 [debug] [ThreadPool]: On threat_risk.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "threat_risk.information_schema"} */

    
    

    select
        'threat_risk' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('stg_urlhaus')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('fact_url_events')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('stg_kev')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('dim_url')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('fact_kev')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('dim_product')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('dim_vendor')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:58:10.293628 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.002 seconds
[0m23:58:10.295815 [debug] [ThreadPool]: On threat_risk.information_schema: ROLLBACK
[0m23:58:10.296006 [debug] [ThreadPool]: On threat_risk.information_schema: Close
[0m23:58:10.311689 [info ] [MainThread]: Catalog written to /app/target/catalog.json
[0m23:58:10.312249 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.37495804, "process_user_time": 0.749527, "process_kernel_time": 0.052106, "process_mem_max_rss": "119488", "process_out_blocks": "6864", "process_in_blocks": "0"}
[0m23:58:10.312467 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:58:10.312435 after 0.38 seconds
[0m23:58:10.312599 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:58:10.312699 [debug] [MainThread]: Connection 'threat_risk.information_schema' was properly closed.
[0m23:58:10.312836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c21010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c20450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a91c910>]}
[0m23:58:10.312992 [debug] [MainThread]: Flushing usage events
[0m00:04:02.684294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5fedc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5fecc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5feee50>]}


============================== 00:04:02.686812 | 149e597e-b63a-48a8-b578-c7e313bb8d52 ==============================
[0m00:04:02.686812 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:04:02.687135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:04:02.732690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '149e597e-b63a-48a8-b578-c7e313bb8d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5feded0>]}
[0m00:04:02.749040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '149e597e-b63a-48a8-b578-c7e313bb8d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb85663d0>]}
[0m00:04:02.749364 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:04:02.769969 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:04:02.808802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:02.809033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:02.821982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '149e597e-b63a-48a8-b578-c7e313bb8d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4f32650>]}
[0m00:04:02.828370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '149e597e-b63a-48a8-b578-c7e313bb8d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4fddd10>]}
[0m00:04:02.828564 [info ] [MainThread]: Found 8 models, 25 data tests, 429 macros
[0m00:04:02.828720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '149e597e-b63a-48a8-b578-c7e313bb8d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ef1650>]}
[0m00:04:02.829848 [info ] [MainThread]: 
[0m00:04:02.830147 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:04:02.831707 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk_staging'
[0m00:04:02.831960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk_marts'
[0m00:04:02.847886 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m00:04:02.848030 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m00:04:02.848222 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m00:04:02.848440 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m00:04:02.848623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:02.848808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:02.853860 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m00:04:02.854034 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m00:04:02.854251 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m00:04:02.854488 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m00:04:02.854696 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m00:04:02.854906 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:04:02.856925 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m00:04:02.857042 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m00:04:02.857588 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m00:04:02.858091 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m00:04:02.858347 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m00:04:02.858580 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m00:04:02.861116 [debug] [MainThread]: Using postgres connection "master"
[0m00:04:02.861306 [debug] [MainThread]: On master: BEGIN
[0m00:04:02.861452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:04:02.864259 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:04:02.864428 [debug] [MainThread]: Using postgres connection "master"
[0m00:04:02.864604 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:04:02.867066 [debug] [MainThread]: SQL status: SELECT 4 in 0.002 seconds
[0m00:04:02.867495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '149e597e-b63a-48a8-b578-c7e313bb8d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb524e310>]}
[0m00:04:02.867680 [debug] [MainThread]: On master: ROLLBACK
[0m00:04:02.867873 [debug] [MainThread]: On master: Close
[0m00:04:02.868073 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:04:02.868266 [info ] [MainThread]: 
[0m00:04:02.872175 [debug] [Thread-1 (]: Began running node model.threat_risk.stg_kev
[0m00:04:02.872354 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_urlhaus
[0m00:04:02.872606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now model.threat_risk.stg_kev)
[0m00:04:02.872857 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now model.threat_risk.stg_urlhaus)
[0m00:04:02.873065 [debug] [Thread-1 (]: Began compiling node model.threat_risk.stg_kev
[0m00:04:02.873283 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_urlhaus
[0m00:04:02.875746 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.stg_kev"
[0m00:04:02.876510 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus"
[0m00:04:02.877350 [debug] [Thread-1 (]: Began executing node model.threat_risk.stg_kev
[0m00:04:02.877512 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_urlhaus
[0m00:04:02.877799 [debug] [Thread-1 (]: Finished running node model.threat_risk.stg_kev
[0m00:04:02.878088 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_urlhaus
[0m00:04:02.878611 [debug] [Thread-4 (]: Began running node model.threat_risk.dim_product
[0m00:04:02.878748 [debug] [Thread-3 (]: Began running node model.threat_risk.dim_vendor
[0m00:04:02.878893 [debug] [Thread-1 (]: Began running node model.threat_risk.fact_kev
[0m00:04:02.879009 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m00:04:02.879219 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.threat_risk.dim_product'
[0m00:04:02.879459 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.threat_risk.dim_vendor'
[0m00:04:02.879650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_kev, now model.threat_risk.fact_kev)
[0m00:04:02.880285 [debug] [Thread-1 (]: Began compiling node model.threat_risk.fact_kev
[0m00:04:02.879970 [debug] [Thread-4 (]: Began compiling node model.threat_risk.dim_product
[0m00:04:02.880137 [debug] [Thread-3 (]: Began compiling node model.threat_risk.dim_vendor
[0m00:04:02.879804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus, now test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0)
[0m00:04:02.881272 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.fact_kev"
[0m00:04:02.882276 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.dim_product"
[0m00:04:02.883267 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.dim_vendor"
[0m00:04:02.883441 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m00:04:02.883956 [debug] [Thread-1 (]: Began executing node model.threat_risk.fact_kev
[0m00:04:02.884121 [debug] [Thread-4 (]: Began executing node model.threat_risk.dim_product
[0m00:04:02.888048 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m00:04:02.888252 [debug] [Thread-3 (]: Began executing node model.threat_risk.dim_vendor
[0m00:04:02.888552 [debug] [Thread-1 (]: Finished running node model.threat_risk.fact_kev
[0m00:04:02.888965 [debug] [Thread-4 (]: Finished running node model.threat_risk.dim_product
[0m00:04:02.889352 [debug] [Thread-3 (]: Finished running node model.threat_risk.dim_vendor
[0m00:04:02.889605 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m00:04:02.889894 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m00:04:02.890135 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m00:04:02.891022 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m00:04:02.890537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_kev, now test.threat_risk.not_null_stg_kev_product.9b2d2b4877)
[0m00:04:02.890736 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_product, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m00:04:02.890297 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m00:04:02.891708 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_vendor, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m00:04:02.891377 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m00:04:02.891540 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m00:04:02.891184 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_date
[0m00:04:02.891847 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m00:04:02.893864 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m00:04:02.895292 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m00:04:02.895459 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now model.threat_risk.dim_date)
[0m00:04:02.897137 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_date
[0m00:04:02.896719 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m00:04:02.898118 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_date"
[0m00:04:02.898282 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m00:04:02.898421 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m00:04:02.898847 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m00:04:02.899030 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m00:04:02.899228 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m00:04:02.899393 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_date
[0m00:04:02.899497 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_url
[0m00:04:02.900611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now model.threat_risk.dim_url)
[0m00:04:02.900104 [debug] [Thread-4 (]: Began running node model.threat_risk.fact_url_events
[0m00:04:02.900422 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_date
[0m00:04:02.899737 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m00:04:02.901304 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m00:04:02.900928 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now model.threat_risk.fact_url_events)
[0m00:04:02.901119 [debug] [Thread-2 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m00:04:02.900753 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_url
[0m00:04:02.901474 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93)
[0m00:04:02.901664 [debug] [Thread-4 (]: Began compiling node model.threat_risk.fact_url_events
[0m00:04:02.901860 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_date, now test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41)
[0m00:04:02.902827 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_url"
[0m00:04:02.902989 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m00:04:02.903936 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.fact_url_events"
[0m00:04:02.904140 [debug] [Thread-2 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m00:04:02.905507 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m00:04:02.905789 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_url
[0m00:04:02.909474 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_url
[0m00:04:02.909182 [debug] [Thread-4 (]: Began executing node model.threat_risk.fact_url_events
[0m00:04:02.908892 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m00:04:02.909654 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m00:04:02.909882 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m00:04:02.910166 [debug] [Thread-4 (]: Finished running node model.threat_risk.fact_url_events
[0m00:04:02.910620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_url, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m00:04:02.910922 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m00:04:02.911038 [debug] [Thread-2 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m00:04:02.911943 [debug] [Thread-2 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m00:04:02.911498 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m00:04:02.911693 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m00:04:02.911220 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m00:04:02.913860 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_url_events, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m00:04:02.913473 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m00:04:02.913686 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m00:04:02.912113 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m00:04:02.914611 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m00:04:02.914320 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m00:04:02.914484 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m00:04:02.913998 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m00:04:02.914752 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m00:04:02.915993 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m00:04:02.916272 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m00:04:02.917498 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m00:04:02.918809 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m00:04:02.919112 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m00:04:02.919385 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m00:04:02.919644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m00:04:02.919770 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m00:04:02.919920 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m00:04:02.920786 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m00:04:02.920302 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m00:04:02.920540 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m00:04:02.920144 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m00:04:02.920945 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m00:04:02.923818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_date_day.64362f7a33, now test.threat_risk.not_null_dim_product_product_key.f0e1d838d3)
[0m00:04:02.923435 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m00:04:02.923640 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m00:04:02.923201 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m00:04:02.923953 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m00:04:02.924136 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now test.threat_risk.not_null_dim_product_vendor_key.78836999d2)
[0m00:04:02.924299 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m00:04:02.925740 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m00:04:02.925932 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m00:04:02.926066 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m00:04:02.926190 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m00:04:02.927514 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m00:04:02.927688 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m00:04:02.927890 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m00:04:02.929144 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m00:04:02.929513 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m00:04:02.929702 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m00:04:02.929823 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m00:04:02.930118 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m00:04:02.930386 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m00:04:02.930507 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m00:04:02.930698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m00:04:02.930865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m00:04:02.931046 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m00:04:02.931296 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m00:04:02.931920 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m00:04:02.932083 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m00:04:02.931738 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m00:04:02.931430 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m00:04:02.931564 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m00:04:02.932219 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m00:04:02.932391 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m00:04:02.934379 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m00:04:02.935616 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m00:04:02.936920 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m00:04:02.938335 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m00:04:02.938834 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m00:04:02.939030 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m00:04:02.939316 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m00:04:02.939454 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m00:04:02.939677 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m00:04:02.939826 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m00:04:02.940611 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m00:04:02.940188 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m00:04:02.940376 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m00:04:02.939939 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m00:04:02.940767 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m00:04:02.941435 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.not_null_dim_url_url_key.89914b0872)
[0m00:04:02.941108 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.not_null_dim_url_url.2b67971659)
[0m00:04:02.941281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_product_product_key.1753236bd0, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m00:04:02.940935 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m00:04:02.942038 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68, now test.threat_risk.unique_dim_url_url.4c561dc36d)
[0m00:04:02.941717 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_url_url.2b67971659
[0m00:04:02.941876 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m00:04:02.941566 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m00:04:02.942175 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m00:04:02.943436 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m00:04:02.944702 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m00:04:02.945924 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m00:04:02.947148 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m00:04:02.947722 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_url_url.2b67971659
[0m00:04:02.948077 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m00:04:02.947877 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m00:04:02.948276 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m00:04:02.948376 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m00:04:02.948504 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m00:04:02.948759 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m00:04:02.949002 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m00:04:02.949267 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m00:04:02.949421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url.2b67971659, now test.threat_risk.unique_dim_url_url_key.d67ee5b979)
[0m00:04:02.949604 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m00:04:02.950679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96, now test.threat_risk.not_null_fact_url_events_date_day.d658eee263)
[0m00:04:02.950474 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m00:04:02.950028 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m00:04:02.953075 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url_key.89914b0872, now test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d)
[0m00:04:02.952883 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m00:04:02.950826 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m00:04:02.953220 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m00:04:02.954533 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m00:04:02.955742 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m00:04:02.955922 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m00:04:02.956314 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m00:04:02.956486 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m00:04:02.956761 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m00:04:02.956877 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m00:04:02.957140 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m00:04:02.957857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:02.958008 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url_key.d67ee5b979' was properly closed.
[0m00:04:02.958144 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_date_day.d658eee263' was properly closed.
[0m00:04:02.958283 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d' was properly closed.
[0m00:04:02.958388 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url.4c561dc36d' was properly closed.
[0m00:04:02.959625 [debug] [MainThread]: Command end result
[0m00:04:03.014152 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m00:04:03.014329 [info ] [MainThread]: Building catalog
[0m00:04:03.017859 [debug] [ThreadPool]: Acquiring new postgres connection 'threat_risk.information_schema'
[0m00:04:03.020654 [debug] [ThreadPool]: Using postgres connection "threat_risk.information_schema"
[0m00:04:03.020807 [debug] [ThreadPool]: On threat_risk.information_schema: BEGIN
[0m00:04:03.020919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:03.024085 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m00:04:03.024222 [debug] [ThreadPool]: Using postgres connection "threat_risk.information_schema"
[0m00:04:03.024410 [debug] [ThreadPool]: On threat_risk.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "threat_risk.information_schema"} */

    
    

    select
        'threat_risk' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('dim_product')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('fact_kev')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('dim_url')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('stg_kev')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('dim_vendor')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('stg_urlhaus')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('fact_url_events')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m00:04:03.026945 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.002 seconds
[0m00:04:03.029043 [debug] [ThreadPool]: On threat_risk.information_schema: ROLLBACK
[0m00:04:03.029270 [debug] [ThreadPool]: On threat_risk.information_schema: Close
[0m00:04:03.045017 [info ] [MainThread]: Catalog written to /app/target/catalog.json
[0m00:04:03.045802 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.37708366, "process_user_time": 0.733466, "process_kernel_time": 0.070622, "process_mem_max_rss": "119648", "process_out_blocks": "6864", "process_in_blocks": "0"}
[0m00:04:03.046075 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:04:03.046028 after 0.38 seconds
[0m00:04:03.046268 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:04:03.046428 [debug] [MainThread]: Connection 'threat_risk.information_schema' was properly closed.
[0m00:04:03.046652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbae71690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbad00d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6ec5390>]}
[0m00:04:03.046840 [debug] [MainThread]: Flushing usage events
[0m00:14:37.464892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25ffd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27f3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25b9d10>]}


============================== 00:14:37.468338 | b6cf0541-5bb4-4ece-a01d-81aca08896cc ==============================
[0m00:14:37.468338 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:14:37.468745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/logs', 'debug': 'False', 'profiles_dir': '/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m00:14:37.515403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6cf0541-5bb4-4ece-a01d-81aca08896cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25bcc50>]}
[0m00:14:37.531778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6cf0541-5bb4-4ece-a01d-81aca08896cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b39e50>]}
[0m00:14:37.532134 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:14:37.552399 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:14:37.592874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:14:37.593089 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:14:37.606077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6cf0541-5bb4-4ece-a01d-81aca08896cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25b9fd0>]}
[0m00:14:37.646191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6cf0541-5bb4-4ece-a01d-81aca08896cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa132aed0>]}
[0m00:14:37.646434 [info ] [MainThread]: Found 8 models, 25 data tests, 429 macros
[0m00:14:37.646655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6cf0541-5bb4-4ece-a01d-81aca08896cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa162c5d0>]}
[0m00:14:37.647916 [info ] [MainThread]: 
[0m00:14:37.648232 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:14:37.649909 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk_marts'
[0m00:14:37.650145 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk_staging'
[0m00:14:37.664512 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m00:14:37.664658 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m00:14:37.664850 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m00:14:37.665050 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m00:14:37.665221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:37.665417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:37.670930 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m00:14:37.671071 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m00:14:37.671241 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m00:14:37.671472 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m00:14:37.671668 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m00:14:37.671876 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:14:37.673853 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m00:14:37.673974 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m00:14:37.674506 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m00:14:37.675005 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m00:14:37.675277 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m00:14:37.675450 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m00:14:37.677876 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:37.678041 [debug] [MainThread]: On master: BEGIN
[0m00:14:37.678175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:14:37.681002 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:14:37.681167 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:37.681363 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:14:37.683842 [debug] [MainThread]: SQL status: SELECT 4 in 0.002 seconds
[0m00:14:37.684306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6cf0541-5bb4-4ece-a01d-81aca08896cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17d8450>]}
[0m00:14:37.684514 [debug] [MainThread]: On master: ROLLBACK
[0m00:14:37.684724 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:37.684855 [debug] [MainThread]: On master: BEGIN
[0m00:14:37.685106 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:14:37.685277 [debug] [MainThread]: On master: COMMIT
[0m00:14:37.685436 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:37.685568 [debug] [MainThread]: On master: COMMIT
[0m00:14:37.685760 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:14:37.685898 [debug] [MainThread]: On master: Close
[0m00:14:37.686094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:14:37.686277 [info ] [MainThread]: 
[0m00:14:37.690341 [debug] [Thread-1 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m00:14:37.690509 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m00:14:37.690653 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m00:14:37.690867 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m00:14:37.691033 [info ] [Thread-1 (]: 1 of 25 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m00:14:37.691344 [info ] [Thread-2 (]: 2 of 25 START test not_null_dim_product_product ................................ [RUN]
[0m00:14:37.691716 [info ] [Thread-3 (]: 3 of 25 START test not_null_dim_product_product_key ............................ [RUN]
[0m00:14:37.692012 [info ] [Thread-4 (]: 4 of 25 START test not_null_dim_product_vendor_key ............................. [RUN]
[0m00:14:37.692377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41)
[0m00:14:37.692637 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m00:14:37.692890 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.threat_risk.not_null_dim_product_product_key.f0e1d838d3'
[0m00:14:37.693148 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.threat_risk.not_null_dim_product_vendor_key.78836999d2'
[0m00:14:37.693344 [debug] [Thread-1 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m00:14:37.693560 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m00:14:37.693762 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m00:14:37.693955 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m00:14:37.700197 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m00:14:37.703050 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m00:14:37.704391 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m00:14:37.705735 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m00:14:37.709328 [debug] [Thread-1 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m00:14:37.709479 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m00:14:37.709618 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m00:14:37.714598 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m00:14:37.714795 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m00:14:37.715560 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m00:14:37.716333 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m00:14:37.717268 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m00:14:37.717698 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m00:14:37.718156 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m00:14:37.718025 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m00:14:37.718364 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m00:14:37.718475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:37.718649 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m00:14:37.719184 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: BEGIN
[0m00:14:37.718916 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: BEGIN
[0m00:14:37.718772 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m00:14:37.719346 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:14:37.719507 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:37.719670 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:14:37.726528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m00:14:37.726853 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m00:14:37.727128 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m00:14:37.727332 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m00:14:37.727492 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m00:14:37.727623 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m00:14:37.727787 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m00:14:37.728060 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m00:14:37.728218 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m00:14:37.728830 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product.56a877bc84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."marts"."dim_product"
where product is null



      
    ) dbt_internal_test
[0m00:14:37.728640 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "threat_risk"."marts"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m00:14:37.728406 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_product"
where vendor_key is null



      
    ) dbt_internal_test
[0m00:14:37.729512 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:14:37.729639 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:14:37.729777 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:14:37.731619 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: ROLLBACK
[0m00:14:37.732270 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m00:14:37.732859 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: ROLLBACK
[0m00:14:37.733141 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: Close
[0m00:14:37.733375 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: Close
[0m00:14:37.733629 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: Close
[0m00:14:37.733895 [info ] [Thread-2 (]: 2 of 25 PASS not_null_dim_product_product ...................................... [[32mPASS[0m in 0.04s]
[0m00:14:37.734314 [info ] [Thread-3 (]: 3 of 25 PASS not_null_dim_product_product_key .................................. [[32mPASS[0m in 0.04s]
[0m00:14:37.734778 [info ] [Thread-4 (]: 4 of 25 PASS not_null_dim_product_vendor_key ................................... [[32mPASS[0m in 0.04s]
[0m00:14:37.735905 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m00:14:37.735578 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m00:14:37.735235 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m00:14:37.736763 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m00:14:37.736476 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m00:14:37.736155 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m00:14:37.737678 [info ] [Thread-4 (]: 5 of 25 START test not_null_dim_product_vendor_project ......................... [RUN]
[0m00:14:37.737341 [info ] [Thread-3 (]: 6 of 25 START test not_null_dim_url_url ........................................ [RUN]
[0m00:14:37.736980 [info ] [Thread-2 (]: 7 of 25 START test not_null_dim_url_url_key .................................... [RUN]
[0m00:14:37.738696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.not_null_dim_url_url_key.89914b0872)
[0m00:14:37.738343 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.not_null_dim_url_url.2b67971659)
[0m00:14:37.738026 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m00:14:37.739400 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m00:14:37.739189 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_url_url.2b67971659
[0m00:14:37.738938 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m00:14:37.741150 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m00:14:37.742557 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m00:14:37.744414 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m00:14:37.744589 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m00:14:37.745321 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m00:14:37.745977 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m00:14:37.746171 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_url_url.2b67971659
[0m00:14:37.746330 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m00:14:37.747879 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m00:14:37.748126 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m00:14:37.748899 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m00:14:37.749696 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m00:14:37.750068 [info ] [Thread-1 (]: 1 of 25 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown .. [[32mPASS[0m in 0.06s]
[0m00:14:37.750629 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m00:14:37.750924 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m00:14:37.751689 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: BEGIN
[0m00:14:37.751416 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m00:14:37.751535 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: BEGIN
[0m00:14:37.751189 [debug] [Thread-1 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m00:14:37.751818 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:37.751977 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: BEGIN
[0m00:14:37.752143 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:14:37.752346 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m00:14:37.752714 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:37.753020 [info ] [Thread-1 (]: 8 of 25 START test not_null_dim_vendor_vendor_key .............................. [RUN]
[0m00:14:37.753564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m00:14:37.753752 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m00:14:37.755665 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m00:14:37.756366 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m00:14:37.757964 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m00:14:37.758236 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m00:14:37.758508 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m00:14:37.758788 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_product"
where vendor_project is null



      
    ) dbt_internal_test
[0m00:14:37.758686 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m00:14:37.759057 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m00:14:37.759206 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: BEGIN
[0m00:14:37.759359 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m00:14:37.759510 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:14:37.759656 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m00:14:37.759804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:37.759983 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m00:14:37.760559 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: ROLLBACK
[0m00:14:37.760750 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url.2b67971659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."dim_url"
where url is null



      
    ) dbt_internal_test
[0m00:14:37.761060 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url_key.89914b0872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."dim_url"
where url_key is null



      
    ) dbt_internal_test
[0m00:14:37.761387 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: Close
[0m00:14:37.762404 [info ] [Thread-4 (]: 5 of 25 PASS not_null_dim_product_vendor_project ............................... [[32mPASS[0m in 0.02s]
[0m00:14:37.763572 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m00:14:37.763757 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m00:14:37.764045 [info ] [Thread-4 (]: 9 of 25 START test not_null_dim_vendor_vendor_project .......................... [RUN]
[0m00:14:37.764497 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m00:14:37.764190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:14:37.765013 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m00:14:37.764775 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:14:37.764899 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:14:37.764641 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m00:14:37.765177 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_vendor"
where vendor_key is null



      
    ) dbt_internal_test
[0m00:14:37.765737 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: ROLLBACK
[0m00:14:37.766259 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: ROLLBACK
[0m00:14:37.768148 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m00:14:37.768551 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: Close
[0m00:14:37.768822 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: Close
[0m00:14:37.768967 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:14:37.769300 [info ] [Thread-3 (]: 6 of 25 PASS not_null_dim_url_url .............................................. [[32mPASS[0m in 0.03s]
[0m00:14:37.769482 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m00:14:37.769745 [info ] [Thread-2 (]: 7 of 25 PASS not_null_dim_url_url_key .......................................... [[32mPASS[0m in 0.03s]
[0m00:14:37.770468 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: ROLLBACK
[0m00:14:37.770725 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m00:14:37.771720 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m00:14:37.771975 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m00:14:37.772199 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: Close
[0m00:14:37.772344 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m00:14:37.772740 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m00:14:37.773012 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m00:14:37.774052 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: BEGIN
[0m00:14:37.773449 [info ] [Thread-3 (]: 10 of 25 START test not_null_fact_kev_cve_id ................................... [RUN]
[0m00:14:37.773780 [info ] [Thread-2 (]: 11 of 25 START test not_null_fact_kev_date_day ................................. [RUN]
[0m00:14:37.773194 [info ] [Thread-1 (]: 8 of 25 PASS not_null_dim_vendor_vendor_key .................................... [[32mPASS[0m in 0.02s]
[0m00:14:37.774199 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:14:37.774396 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url.2b67971659, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m00:14:37.774599 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url_key.89914b0872, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m00:14:37.774805 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m00:14:37.775150 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m00:14:37.775452 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m00:14:37.775698 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m00:14:37.777218 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m00:14:37.778807 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m00:14:37.779030 [info ] [Thread-1 (]: 12 of 25 START test not_null_fact_url_events_date_day .......................... [RUN]
[0m00:14:37.779177 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m00:14:37.779800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.not_null_fact_url_events_date_day.d658eee263)
[0m00:14:37.779992 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m00:14:37.780101 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m00:14:37.780201 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m00:14:37.780400 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m00:14:37.781440 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m00:14:37.782239 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m00:14:37.782435 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_vendor"
where vendor_project is null



      
    ) dbt_internal_test
[0m00:14:37.783836 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m00:14:37.784306 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m00:14:37.784571 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m00:14:37.784818 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: BEGIN
[0m00:14:37.784944 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:14:37.785095 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m00:14:37.785213 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: BEGIN
[0m00:14:37.787749 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:37.785921 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: ROLLBACK
[0m00:14:37.787601 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m00:14:37.785353 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:37.788217 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: Close
[0m00:14:37.788627 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m00:14:37.789520 [info ] [Thread-4 (]: 9 of 25 PASS not_null_dim_vendor_vendor_project ................................ [[32mPASS[0m in 0.03s]
[0m00:14:37.789780 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: BEGIN
[0m00:14:37.790938 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m00:14:37.791417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:37.792392 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m00:14:37.792585 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m00:14:37.792909 [info ] [Thread-4 (]: 13 of 25 START test not_null_fact_url_events_url_key ........................... [RUN]
[0m00:14:37.793056 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m00:14:37.793278 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m00:14:37.793879 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."marts"."fact_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m00:14:37.793705 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m00:14:37.793516 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d)
[0m00:14:37.794117 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_kev"
where date_day is null



      
    ) dbt_internal_test
[0m00:14:37.794282 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m00:14:37.820217 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.026 seconds
[0m00:14:37.820408 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.026 seconds
[0m00:14:37.821716 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m00:14:37.821909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m00:14:37.822515 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: ROLLBACK
[0m00:14:37.823065 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: ROLLBACK
[0m00:14:37.823449 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m00:14:37.823743 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m00:14:37.823888 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: Close
[0m00:14:37.824102 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: Close
[0m00:14:37.824198 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_url_events"
where date_day is null



      
    ) dbt_internal_test
[0m00:14:37.825001 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m00:14:37.825386 [info ] [Thread-2 (]: 11 of 25 PASS not_null_fact_kev_date_day ....................................... [[32mPASS[0m in 0.05s]
[0m00:14:37.825744 [info ] [Thread-3 (]: 10 of 25 PASS not_null_fact_kev_cve_id ......................................... [[32mPASS[0m in 0.05s]
[0m00:14:37.826510 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m00:14:37.826756 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m00:14:37.826953 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m00:14:37.827100 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m00:14:37.827323 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m00:14:37.827937 [info ] [Thread-3 (]: 15 of 25 START test not_null_stg_kev_product ................................... [RUN]
[0m00:14:37.827692 [info ] [Thread-2 (]: 14 of 25 START test not_null_stg_kev_cve_id .................................... [RUN]
[0m00:14:37.827507 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: BEGIN
[0m00:14:37.828611 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:14:37.828443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_date_day.64362f7a33, now test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0)
[0m00:14:37.828216 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8, now test.threat_risk.not_null_stg_kev_product.9b2d2b4877)
[0m00:14:37.828871 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m00:14:37.829029 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m00:14:37.829146 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:14:37.830729 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m00:14:37.832592 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m00:14:37.833213 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: ROLLBACK
[0m00:14:37.833374 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m00:14:37.833881 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m00:14:37.834006 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: Close
[0m00:14:37.834134 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m00:14:37.834236 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m00:14:37.836957 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."fact_url_events"
where url_key is null



      
    ) dbt_internal_test
[0m00:14:37.835775 [info ] [Thread-1 (]: 12 of 25 PASS not_null_fact_url_events_date_day ................................ [[32mPASS[0m in 0.06s]
[0m00:14:37.836763 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m00:14:37.835417 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m00:14:37.837242 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m00:14:37.837728 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m00:14:37.837885 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m00:14:37.838379 [info ] [Thread-1 (]: 16 of 25 START test not_null_stg_kev_run_date .................................. [RUN]
[0m00:14:37.838233 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m00:14:37.838107 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m00:14:37.838635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_url_events_date_day.d658eee263, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m00:14:37.838855 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m00:14:37.839037 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:37.839194 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m00:14:37.839339 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:37.841046 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m00:14:37.841184 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m00:14:37.842144 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: ROLLBACK
[0m00:14:37.843418 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m00:14:37.843570 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m00:14:37.843690 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: Close
[0m00:14:37.844561 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m00:14:37.844766 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m00:14:37.844934 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m00:14:37.845309 [info ] [Thread-4 (]: 13 of 25 PASS not_null_fact_url_events_url_key ................................. [[32mPASS[0m in 0.05s]
[0m00:14:37.845756 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m00:14:37.845980 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m00:14:37.846113 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m00:14:37.846801 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m00:14:37.846632 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m00:14:37.846365 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m00:14:37.846933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:37.847210 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m00:14:37.847749 [info ] [Thread-4 (]: 17 of 25 START test not_null_stg_kev_vendor_project ............................ [RUN]
[0m00:14:37.848009 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m00:14:37.848230 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m00:14:37.850688 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m00:14:37.850956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:14:37.851134 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m00:14:37.851326 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m00:14:37.851511 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m00:14:37.852563 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m00:14:37.853007 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m00:14:37.853196 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m00:14:37.853375 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:14:37.856850 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m00:14:37.856985 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m00:14:37.857158 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m00:14:37.857955 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m00:14:37.858106 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m00:14:37.858629 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m00:14:37.859184 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m00:14:37.859416 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m00:14:37.859518 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m00:14:37.859756 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m00:14:37.859952 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m00:14:37.860204 [info ] [Thread-1 (]: 16 of 25 PASS not_null_stg_kev_run_date ........................................ [[32mPASS[0m in 0.02s]
[0m00:14:37.861783 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m00:14:37.860867 [info ] [Thread-2 (]: 14 of 25 PASS not_null_stg_kev_cve_id .......................................... [[32mPASS[0m in 0.03s]
[0m00:14:37.861458 [info ] [Thread-3 (]: 15 of 25 PASS not_null_stg_kev_product ......................................... [[32mPASS[0m in 0.03s]
[0m00:14:37.860523 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m00:14:37.861973 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m00:14:37.862212 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m00:14:37.862475 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m00:14:37.862740 [info ] [Thread-1 (]: 18 of 25 START test not_null_stg_urlhaus_run_date .............................. [RUN]
[0m00:14:37.862993 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m00:14:37.863219 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m00:14:37.863491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93)
[0m00:14:37.863679 [info ] [Thread-2 (]: 19 of 25 START test not_null_stg_urlhaus_url ................................... [RUN]
[0m00:14:37.863954 [info ] [Thread-3 (]: 20 of 25 START test not_null_stg_urlhaus_url_status ............................ [RUN]
[0m00:14:37.864156 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m00:14:37.864432 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m00:14:37.864698 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m00:14:37.866530 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m00:14:37.866778 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m00:14:37.866998 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m00:14:37.869560 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m00:14:37.869770 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m00:14:37.869875 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m00:14:37.871114 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m00:14:37.871860 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m00:14:37.872062 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m00:14:37.872830 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m00:14:37.873885 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m00:14:37.874006 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m00:14:37.874132 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m00:14:37.874550 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m00:14:37.874920 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m00:14:37.874753 [info ] [Thread-4 (]: 17 of 25 PASS not_null_stg_kev_vendor_project .................................. [[32mPASS[0m in 0.03s]
[0m00:14:37.875785 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m00:14:37.875952 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m00:14:37.876123 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m00:14:37.876369 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m00:14:37.877125 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m00:14:37.876807 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:37.876923 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m00:14:37.876672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:37.877293 [info ] [Thread-4 (]: 21 of 25 START test unique_dim_product_product_key ............................. [RUN]
[0m00:14:37.877725 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m00:14:37.878075 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m00:14:37.878339 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:37.878638 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m00:14:37.882013 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m00:14:37.883477 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m00:14:37.884297 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m00:14:37.884640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m00:14:37.884813 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m00:14:37.885013 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m00:14:37.885148 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m00:14:37.885294 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m00:14:37.885961 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m00:14:37.885646 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m00:14:37.885799 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: BEGIN
[0m00:14:37.885504 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m00:14:37.886209 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m00:14:37.886401 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:14:37.886668 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m00:14:37.891928 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m00:14:37.893176 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m00:14:37.895674 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:37.897002 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m00:14:37.897131 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:14:37.897785 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m00:14:37.897940 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m00:14:37.898433 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m00:14:37.898684 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m00:14:37.898819 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m00:14:37.899194 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m00:14:37.899523 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: Close
[0m00:14:37.899964 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m00:14:37.900296 [info ] [Thread-2 (]: 19 of 25 PASS not_null_stg_urlhaus_url ......................................... [[32mPASS[0m in 0.04s]
[0m00:14:37.900678 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m00:14:37.900929 [info ] [Thread-4 (]: 21 of 25 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.02s]
[0m00:14:37.901366 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m00:14:37.901546 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m00:14:37.901839 [info ] [Thread-3 (]: 20 of 25 PASS not_null_stg_urlhaus_url_status .................................. [[32mPASS[0m in 0.04s]
[0m00:14:37.902119 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m00:14:37.902438 [info ] [Thread-1 (]: 18 of 25 PASS not_null_stg_urlhaus_run_date .................................... [[32mPASS[0m in 0.04s]
[0m00:14:37.902774 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m00:14:37.903094 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m00:14:37.903335 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m00:14:37.903622 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m00:14:37.903817 [info ] [Thread-2 (]: 22 of 25 START test unique_dim_url_url ......................................... [RUN]
[0m00:14:37.904121 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m00:14:37.904327 [info ] [Thread-4 (]: 23 of 25 START test unique_dim_url_url_key ..................................... [RUN]
[0m00:14:37.904600 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m00:14:37.904821 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now test.threat_risk.unique_dim_url_url.4c561dc36d)
[0m00:14:37.905030 [info ] [Thread-3 (]: 24 of 25 START test unique_dim_vendor_vendor_key ............................... [RUN]
[0m00:14:37.905393 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_product_product_key.1753236bd0, now test.threat_risk.unique_dim_url_url_key.d67ee5b979)
[0m00:14:37.905602 [info ] [Thread-1 (]: 25 of 25 START test unique_dim_vendor_vendor_project ........................... [RUN]
[0m00:14:37.905873 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m00:14:37.906094 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m00:14:37.906281 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m00:14:37.906519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m00:14:37.908136 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m00:14:37.908369 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m00:14:37.909654 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m00:14:37.909863 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m00:14:37.911292 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m00:14:37.911581 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m00:14:37.912849 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m00:14:37.913836 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m00:14:37.913966 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m00:14:37.914147 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m00:14:37.914474 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m00:14:37.916342 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m00:14:37.916572 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m00:14:37.917332 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m00:14:37.918131 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m00:14:37.918455 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: BEGIN
[0m00:14:37.918643 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m00:14:37.919027 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:37.919221 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m00:14:37.919387 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m00:14:37.919541 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: BEGIN
[0m00:14:37.919847 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: BEGIN
[0m00:14:37.920022 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: BEGIN
[0m00:14:37.920173 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:14:37.920384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:37.920560 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:37.924769 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m00:14:37.924955 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m00:14:37.925115 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url.4c561dc36d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:37.928325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m00:14:37.928548 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m00:14:37.928685 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m00:14:37.928938 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_project as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_project is not null
group by vendor_project
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:37.929094 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m00:14:37.929258 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m00:14:37.929502 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m00:14:37.929697 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_key is not null
group by vendor_key
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:37.929863 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url_key.d67ee5b979"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url_key is not null
group by url_key
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:37.930068 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:14:37.930837 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: ROLLBACK
[0m00:14:37.930969 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m00:14:37.931093 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:14:37.931344 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: Close
[0m00:14:37.931803 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: ROLLBACK
[0m00:14:37.932370 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: ROLLBACK
[0m00:14:37.932710 [info ] [Thread-1 (]: 25 of 25 PASS unique_dim_vendor_vendor_project ................................. [[32mPASS[0m in 0.03s]
[0m00:14:37.933054 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: Close
[0m00:14:37.933262 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: Close
[0m00:14:37.933487 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m00:14:37.933808 [info ] [Thread-2 (]: 22 of 25 PASS unique_dim_url_url ............................................... [[32mPASS[0m in 0.03s]
[0m00:14:37.934164 [info ] [Thread-3 (]: 24 of 25 PASS unique_dim_vendor_vendor_key ..................................... [[32mPASS[0m in 0.03s]
[0m00:14:37.934689 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m00:14:37.934973 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m00:14:37.935468 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m00:14:37.935945 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: ROLLBACK
[0m00:14:37.936172 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: Close
[0m00:14:37.936405 [info ] [Thread-4 (]: 23 of 25 PASS unique_dim_url_url_key ........................................... [[32mPASS[0m in 0.03s]
[0m00:14:37.936702 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m00:14:37.937578 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:37.937790 [debug] [MainThread]: On master: BEGIN
[0m00:14:37.937945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:14:37.941146 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:14:37.941345 [debug] [MainThread]: On master: COMMIT
[0m00:14:37.941504 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:37.941639 [debug] [MainThread]: On master: COMMIT
[0m00:14:37.941831 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:14:37.941966 [debug] [MainThread]: On master: Close
[0m00:14:37.942161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:37.942318 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url.4c561dc36d' was properly closed.
[0m00:14:37.942458 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96' was properly closed.
[0m00:14:37.942617 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68' was properly closed.
[0m00:14:37.942756 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url_key.d67ee5b979' was properly closed.
[0m00:14:37.942957 [info ] [MainThread]: 
[0m00:14:37.943171 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m00:14:37.944368 [debug] [MainThread]: Command end result
[0m00:14:37.960545 [info ] [MainThread]: 
[0m00:14:37.960786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:14:37.960995 [info ] [MainThread]: 
[0m00:14:37.961214 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m00:14:37.961729 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5126647, "process_user_time": 0.883587, "process_kernel_time": 0.094127, "process_mem_max_rss": "121992", "process_out_blocks": "3945", "process_in_blocks": "0"}
[0m00:14:37.961947 [debug] [MainThread]: Command `dbt test` succeeded at 00:14:37.961916 after 0.51 seconds
[0m00:14:37.962116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa72d0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa72d0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4fb8dd0>]}
[0m00:14:37.962294 [debug] [MainThread]: Flushing usage events
[0m00:54:37.849385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1de5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1d9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e2d9110>]}


============================== 00:54:37.852136 | 87c9aa44-e74c-4749-b885-179e9f5ac8b2 ==============================
[0m00:54:37.852136 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:54:37.852407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/logs', 'fail_fast': 'False', 'profiles_dir': '/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m00:54:37.915884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d48eb90>]}
[0m00:54:37.931930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7a5c50>]}
[0m00:54:37.932302 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:54:37.954732 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:54:38.004430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:54:38.004644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:54:38.017221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d122910>]}
[0m00:54:38.061604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf6f110>]}
[0m00:54:38.061838 [info ] [MainThread]: Found 8 models, 25 data tests, 429 macros
[0m00:54:38.063182 [info ] [MainThread]: 
[0m00:54:38.063468 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:54:38.065095 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m00:54:38.065378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m00:54:38.084649 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m00:54:38.084805 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m00:54:38.085110 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m00:54:38.084970 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m00:54:38.085355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:38.085245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:38.099707 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.014 seconds
[0m00:54:38.099853 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.015 seconds
[0m00:54:38.100782 [debug] [ThreadPool]: On list_threat_risk: Close
[0m00:54:38.100359 [debug] [ThreadPool]: On list_threat_risk: Close
[0m00:54:38.101896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_marts)
[0m00:54:38.102188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_staging)
[0m00:54:38.104463 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m00:54:38.105181 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m00:54:38.105390 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m00:54:38.105553 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m00:54:38.105690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:38.105819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:38.109939 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:54:38.110047 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:54:38.110187 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m00:54:38.110343 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m00:54:38.110492 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:54:38.110640 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m00:54:38.115899 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m00:54:38.116007 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m00:54:38.116524 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m00:54:38.116952 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m00:54:38.117152 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m00:54:38.117280 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m00:54:38.119606 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:38.119793 [debug] [MainThread]: On master: BEGIN
[0m00:54:38.119913 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:54:38.122532 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:54:38.122671 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:38.122824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:54:38.127498 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m00:54:38.127953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e27a2d0>]}
[0m00:54:38.128137 [debug] [MainThread]: On master: ROLLBACK
[0m00:54:38.128301 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:38.128429 [debug] [MainThread]: On master: BEGIN
[0m00:54:38.128655 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:54:38.128793 [debug] [MainThread]: On master: COMMIT
[0m00:54:38.128907 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:38.129003 [debug] [MainThread]: On master: COMMIT
[0m00:54:38.129130 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:54:38.129241 [debug] [MainThread]: On master: Close
[0m00:54:38.129432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:54:38.129593 [info ] [MainThread]: 
[0m00:54:38.133523 [debug] [Thread-1 (]: Began running node model.threat_risk.stg_kev
[0m00:54:38.133680 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_urlhaus
[0m00:54:38.133913 [info ] [Thread-1 (]: 1 of 33 START sql view model staging.stg_kev ................................... [RUN]
[0m00:54:38.134173 [info ] [Thread-2 (]: 2 of 33 START sql view model staging.stg_urlhaus ............................... [RUN]
[0m00:54:38.134394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now model.threat_risk.stg_kev)
[0m00:54:38.134595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now model.threat_risk.stg_urlhaus)
[0m00:54:38.134760 [debug] [Thread-1 (]: Began compiling node model.threat_risk.stg_kev
[0m00:54:38.134928 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_urlhaus
[0m00:54:38.137272 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.stg_kev"
[0m00:54:38.137997 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus"
[0m00:54:38.139262 [debug] [Thread-1 (]: Began executing node model.threat_risk.stg_kev
[0m00:54:38.139419 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_urlhaus
[0m00:54:38.150918 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.stg_kev"
[0m00:54:38.152107 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.stg_urlhaus"
[0m00:54:38.153055 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m00:54:38.153176 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m00:54:38.153428 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: BEGIN
[0m00:54:38.153305 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: BEGIN
[0m00:54:38.153662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:38.153546 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.156743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m00:54:38.156901 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m00:54:38.157043 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */

  create view "threat_risk"."staging"."stg_kev__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.kev
),
clean as (
  select
    nullif(trim(cve_id), '') as cve_id,
    nullif(trim(vendor_project), '') as vendor_project,
    nullif(trim(product), '') as product,
    nullif(trim(vulnerability_name), '') as vulnerability_name,
    date_added,
    short_description,
    required_action,
    due_date,
    notes,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m00:54:38.157935 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m00:54:38.158083 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m00:54:38.158280 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */

  create view "threat_risk"."staging"."stg_urlhaus__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.urlhaus_recent
),
clean as (
  select
    nullif(trim(url), '') as url,
    nullif(trim(url_status), '') as url_status,
    nullif(trim(host), '') as host,
    date_added,
    nullif(trim(threat), '') as threat,
    nullif(trim(tags), '') as tags,
    nullif(trim(urlhaus_link), '') as urlhaus_link,
    nullif(trim(reporter), '') as reporter,
    larted,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m00:54:38.163158 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m00:54:38.163282 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m00:54:38.165773 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m00:54:38.166866 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus" rename to "stg_urlhaus__dbt_backup"
[0m00:54:38.166729 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m00:54:38.167067 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev" rename to "stg_kev__dbt_backup"
[0m00:54:38.167659 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:54:38.167786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:54:38.168704 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m00:54:38.169824 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus__dbt_tmp" rename to "stg_urlhaus"
[0m00:54:38.169653 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m00:54:38.170028 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev__dbt_tmp" rename to "stg_kev"
[0m00:54:38.170149 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:54:38.175511 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m00:54:38.175605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m00:54:38.176124 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m00:54:38.175743 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m00:54:38.176389 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m00:54:38.176266 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m00:54:38.176556 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m00:54:38.176961 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m00:54:38.177070 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m00:54:38.179892 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."staging"."stg_urlhaus__dbt_backup"
[0m00:54:38.180651 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."staging"."stg_kev__dbt_backup"
[0m00:54:38.182466 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m00:54:38.182258 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m00:54:38.182728 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
drop view if exists "threat_risk"."staging"."stg_urlhaus__dbt_backup" cascade
[0m00:54:38.182601 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
drop view if exists "threat_risk"."staging"."stg_kev__dbt_backup" cascade
[0m00:54:38.185208 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m00:54:38.186170 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: Close
[0m00:54:38.185332 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m00:54:38.186766 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1f01d0>]}
[0m00:54:38.187491 [info ] [Thread-2 (]: 2 of 33 OK created sql view model staging.stg_urlhaus .......................... [[32mCREATE VIEW[0m in 0.05s]
[0m00:54:38.187208 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: Close
[0m00:54:38.187994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d308d50>]}
[0m00:54:38.187758 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_urlhaus
[0m00:54:38.188255 [info ] [Thread-1 (]: 1 of 33 OK created sql view model staging.stg_kev .............................. [[32mCREATE VIEW[0m in 0.05s]
[0m00:54:38.188693 [debug] [Thread-1 (]: Finished running node model.threat_risk.stg_kev
[0m00:54:38.188860 [debug] [Thread-4 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m00:54:38.189009 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m00:54:38.189146 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m00:54:38.190027 [info ] [Thread-2 (]: 5 of 33 START test not_null_stg_urlhaus_url .................................... [RUN]
[0m00:54:38.189562 [info ] [Thread-4 (]: 3 of 33 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m00:54:38.189828 [info ] [Thread-3 (]: 4 of 33 START test not_null_stg_urlhaus_run_date ............................... [RUN]
[0m00:54:38.189302 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m00:54:38.190858 [info ] [Thread-1 (]: 6 of 33 START test not_null_stg_urlhaus_url_status ............................. [RUN]
[0m00:54:38.190471 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41'
[0m00:54:38.190701 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93'
[0m00:54:38.190207 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m00:54:38.191595 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m00:54:38.191241 [debug] [Thread-4 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m00:54:38.191434 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m00:54:38.191044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_kev, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m00:54:38.200143 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m00:54:38.198601 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m00:54:38.199956 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m00:54:38.195549 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m00:54:38.201456 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m00:54:38.202704 [debug] [Thread-4 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m00:54:38.202926 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m00:54:38.207771 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m00:54:38.207900 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m00:54:38.208054 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m00:54:38.208860 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m00:54:38.209787 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m00:54:38.210569 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m00:54:38.210775 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m00:54:38.211552 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m00:54:38.211456 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m00:54:38.211264 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m00:54:38.211690 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:54:38.211885 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m00:54:38.212475 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m00:54:38.212175 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m00:54:38.212042 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m00:54:38.212625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:38.212800 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:54:38.212976 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.216425 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m00:54:38.217383 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m00:54:38.217724 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m00:54:38.217876 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m00:54:38.218170 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m00:54:38.218385 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m00:54:38.218669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m00:54:38.218852 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m00:54:38.219139 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m00:54:38.219032 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m00:54:38.219532 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m00:54:38.219712 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m00:54:38.268145 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.050 seconds
[0m00:54:38.268390 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.048 seconds
[0m00:54:38.268566 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.050 seconds
[0m00:54:38.268753 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.049 seconds
[0m00:54:38.270331 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m00:54:38.270908 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m00:54:38.271564 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m00:54:38.272104 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m00:54:38.272427 [debug] [Thread-4 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m00:54:38.272599 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m00:54:38.272801 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m00:54:38.273012 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m00:54:38.273304 [info ] [Thread-4 (]: 3 of 33 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown .. [[32mPASS[0m in 0.08s]
[0m00:54:38.273657 [info ] [Thread-3 (]: 4 of 33 PASS not_null_stg_urlhaus_run_date ..................................... [[32mPASS[0m in 0.08s]
[0m00:54:38.273984 [info ] [Thread-2 (]: 5 of 33 PASS not_null_stg_urlhaus_url .......................................... [[32mPASS[0m in 0.08s]
[0m00:54:38.274343 [info ] [Thread-1 (]: 6 of 33 PASS not_null_stg_urlhaus_url_status ................................... [[32mPASS[0m in 0.08s]
[0m00:54:38.274666 [debug] [Thread-4 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m00:54:38.274995 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m00:54:38.275353 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m00:54:38.275595 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m00:54:38.275858 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m00:54:38.276142 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m00:54:38.276386 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m00:54:38.276610 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m00:54:38.276929 [info ] [Thread-4 (]: 7 of 33 START test not_null_stg_kev_cve_id ..................................... [RUN]
[0m00:54:38.277160 [info ] [Thread-3 (]: 8 of 33 START test not_null_stg_kev_product .................................... [RUN]
[0m00:54:38.277431 [info ] [Thread-2 (]: 9 of 33 START test not_null_stg_kev_run_date ................................... [RUN]
[0m00:54:38.277657 [info ] [Thread-1 (]: 10 of 33 START test not_null_stg_kev_vendor_project ............................ [RUN]
[0m00:54:38.277919 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0)
[0m00:54:38.278130 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now test.threat_risk.not_null_stg_kev_product.9b2d2b4877)
[0m00:54:38.278344 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m00:54:38.278555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m00:54:38.278767 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m00:54:38.278945 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m00:54:38.279192 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m00:54:38.279389 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m00:54:38.281904 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m00:54:38.303427 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m00:54:38.304730 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m00:54:38.306138 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m00:54:38.306967 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m00:54:38.307247 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m00:54:38.309107 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m00:54:38.308312 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m00:54:38.307559 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m00:54:38.309277 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m00:54:38.310260 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m00:54:38.310396 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m00:54:38.311244 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m00:54:38.311379 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m00:54:38.311648 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m00:54:38.311868 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m00:54:38.312496 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m00:54:38.312207 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m00:54:38.312336 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:54:38.312045 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m00:54:38.312994 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:54:38.312760 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m00:54:38.312619 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.313343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:38.317941 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m00:54:38.318213 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m00:54:38.318392 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m00:54:38.318636 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m00:54:38.318964 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m00:54:38.319323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m00:54:38.319622 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m00:54:38.319968 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m00:54:38.320094 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m00:54:38.320357 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m00:54:38.320598 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m00:54:38.320808 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m00:54:38.336168 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m00:54:38.336368 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m00:54:38.336501 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m00:54:38.336650 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m00:54:38.338892 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m00:54:38.337794 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m00:54:38.338365 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m00:54:38.337239 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m00:54:38.339130 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m00:54:38.339306 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m00:54:38.339485 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m00:54:38.339660 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m00:54:38.339900 [info ] [Thread-4 (]: 7 of 33 PASS not_null_stg_kev_cve_id ........................................... [[32mPASS[0m in 0.06s]
[0m00:54:38.340225 [info ] [Thread-3 (]: 8 of 33 PASS not_null_stg_kev_product .......................................... [[32mPASS[0m in 0.06s]
[0m00:54:38.340546 [info ] [Thread-1 (]: 10 of 33 PASS not_null_stg_kev_vendor_project .................................. [[32mPASS[0m in 0.06s]
[0m00:54:38.340839 [info ] [Thread-2 (]: 9 of 33 PASS not_null_stg_kev_run_date ......................................... [[32mPASS[0m in 0.06s]
[0m00:54:38.341072 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m00:54:38.341311 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m00:54:38.341561 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m00:54:38.341768 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m00:54:38.341975 [debug] [Thread-4 (]: Began running node model.threat_risk.dim_url
[0m00:54:38.342207 [debug] [Thread-3 (]: Began running node model.threat_risk.fact_url_events
[0m00:54:38.342667 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_date
[0m00:54:38.342793 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_product
[0m00:54:38.343791 [info ] [Thread-2 (]: 14 of 33 START sql table model marts.dim_product ............................... [RUN]
[0m00:54:38.343273 [info ] [Thread-3 (]: 12 of 33 START sql table model marts.fact_url_events ........................... [RUN]
[0m00:54:38.343548 [info ] [Thread-1 (]: 13 of 33 START sql table model marts.dim_date .................................. [RUN]
[0m00:54:38.342985 [info ] [Thread-4 (]: 11 of 33 START sql table model marts.dim_url ................................... [RUN]
[0m00:54:38.344002 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now model.threat_risk.dim_product)
[0m00:54:38.344223 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now model.threat_risk.fact_url_events)
[0m00:54:38.344448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now model.threat_risk.dim_date)
[0m00:54:38.344654 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now model.threat_risk.dim_url)
[0m00:54:38.345394 [debug] [Thread-4 (]: Began compiling node model.threat_risk.dim_url
[0m00:54:38.345027 [debug] [Thread-3 (]: Began compiling node model.threat_risk.fact_url_events
[0m00:54:38.345218 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_date
[0m00:54:38.344817 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_product
[0m00:54:38.346541 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.dim_url"
[0m00:54:38.347515 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.fact_url_events"
[0m00:54:38.348612 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_date"
[0m00:54:38.349481 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_product"
[0m00:54:38.350570 [debug] [Thread-3 (]: Began executing node model.threat_risk.fact_url_events
[0m00:54:38.350690 [debug] [Thread-4 (]: Began executing node model.threat_risk.dim_url
[0m00:54:38.350914 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_date
[0m00:54:38.359453 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.fact_url_events"
[0m00:54:38.359682 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_product
[0m00:54:38.360739 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.dim_url"
[0m00:54:38.361801 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.dim_date"
[0m00:54:38.363210 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.dim_product"
[0m00:54:38.363854 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m00:54:38.364109 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_url"
[0m00:54:38.364273 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: BEGIN
[0m00:54:38.364400 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_date"
[0m00:54:38.364663 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m00:54:38.364796 [debug] [Thread-4 (]: On model.threat_risk.dim_url: BEGIN
[0m00:54:38.365518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:54:38.365165 [debug] [Thread-1 (]: On model.threat_risk.dim_date: BEGIN
[0m00:54:38.365363 [debug] [Thread-2 (]: On model.threat_risk.dim_product: BEGIN
[0m00:54:38.364992 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:54:38.365784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:38.366077 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.371619 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m00:54:38.371827 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_url"
[0m00:54:38.371984 [debug] [Thread-4 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */

  
    

  create  table "threat_risk"."marts"."dim_url__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  url,
  host
from (
  select distinct url, host
  from "threat_risk"."staging"."stg_urlhaus"
  where url is not null
) u
  );
  
[0m00:54:38.373199 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m00:54:38.373433 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m00:54:38.373674 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */

  
    

  create  table "threat_risk"."marts"."fact_url_events__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  run_date as date_day,
  url_status,
  threat,
  tags,
  date_added,
  reporter,
  larted
from "threat_risk"."staging"."stg_urlhaus"
where url is not null
  );
  
[0m00:54:38.373910 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m00:54:38.374062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m00:54:38.374262 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m00:54:38.374435 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_date"
[0m00:54:38.374651 [debug] [Thread-2 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */

  
    

  create  table "threat_risk"."marts"."dim_product__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  md5(coalesce(vendor_project,'')) as vendor_key,
  vendor_project,
  product
from (
  select distinct vendor_project, product
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null and product is not null
) p
  );
  
[0m00:54:38.374914 [debug] [Thread-1 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */

  
    

  create  table "threat_risk"."marts"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with dates as (
  select distinct run_date as d from "threat_risk"."staging"."stg_kev"
  union
  select distinct run_date as d from "threat_risk"."staging"."stg_urlhaus"
),
final as (
  select
    d as date_day,
    extract(year from d)::int as year,
    extract(month from d)::int as month,
    extract(day from d)::int as day
  from dates
)
select * from final
  );
  
[0m00:54:38.389608 [debug] [Thread-2 (]: SQL status: SELECT 633 in 0.014 seconds
[0m00:54:38.391627 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m00:54:38.391917 [debug] [Thread-2 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product" rename to "dim_product__dbt_backup"
[0m00:54:38.392473 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:54:38.393468 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m00:54:38.393729 [debug] [Thread-2 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m00:54:38.394184 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:54:38.396160 [debug] [Thread-2 (]: On model.threat_risk.dim_product: COMMIT
[0m00:54:38.396303 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m00:54:38.396529 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m00:54:38.397723 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_date"
[0m00:54:38.397958 [debug] [Thread-2 (]: On model.threat_risk.dim_product: COMMIT
[0m00:54:38.398163 [debug] [Thread-1 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date" rename to "dim_date__dbt_backup"
[0m00:54:38.398755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:54:38.400016 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_date"
[0m00:54:38.400143 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m00:54:38.400348 [debug] [Thread-1 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date__dbt_tmp" rename to "dim_date"
[0m00:54:38.401624 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."marts"."dim_product__dbt_backup"
[0m00:54:38.403301 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_product"
[0m00:54:38.403457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:54:38.403654 [debug] [Thread-2 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
drop table if exists "threat_risk"."marts"."dim_product__dbt_backup" cascade
[0m00:54:38.404382 [debug] [Thread-1 (]: On model.threat_risk.dim_date: COMMIT
[0m00:54:38.404664 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_date"
[0m00:54:38.404840 [debug] [Thread-1 (]: On model.threat_risk.dim_date: COMMIT
[0m00:54:38.405757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:54:38.406996 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."marts"."dim_date__dbt_backup"
[0m00:54:38.407126 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m00:54:38.407410 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_date"
[0m00:54:38.408029 [debug] [Thread-2 (]: On model.threat_risk.dim_product: Close
[0m00:54:38.408215 [debug] [Thread-1 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
drop table if exists "threat_risk"."marts"."dim_date__dbt_backup" cascade
[0m00:54:38.408589 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf801d0>]}
[0m00:54:38.408999 [info ] [Thread-2 (]: 14 of 33 OK created sql table model marts.dim_product .......................... [[32mSELECT 633[0m in 0.06s]
[0m00:54:38.409349 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_product
[0m00:54:38.409650 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_vendor
[0m00:54:38.409848 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m00:54:38.410161 [info ] [Thread-2 (]: 15 of 33 START sql table model marts.dim_vendor ................................ [RUN]
[0m00:54:38.410784 [debug] [Thread-1 (]: On model.threat_risk.dim_date: Close
[0m00:54:38.411027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_product, now model.threat_risk.dim_vendor)
[0m00:54:38.411322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf7bd90>]}
[0m00:54:38.411513 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_vendor
[0m00:54:38.411776 [info ] [Thread-1 (]: 13 of 33 OK created sql table model marts.dim_date ............................. [[32mSELECT 1[0m in 0.07s]
[0m00:54:38.414400 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_vendor"
[0m00:54:38.414666 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_date
[0m00:54:38.415106 [debug] [Thread-1 (]: Began running node model.threat_risk.fact_kev
[0m00:54:38.415383 [info ] [Thread-1 (]: 16 of 33 START sql table model marts.fact_kev .................................. [RUN]
[0m00:54:38.415632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_date, now model.threat_risk.fact_kev)
[0m00:54:38.415785 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_vendor
[0m00:54:38.415956 [debug] [Thread-1 (]: Began compiling node model.threat_risk.fact_kev
[0m00:54:38.417385 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.dim_vendor"
[0m00:54:38.418535 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.fact_kev"
[0m00:54:38.419041 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m00:54:38.419166 [debug] [Thread-1 (]: Began executing node model.threat_risk.fact_kev
[0m00:54:38.419282 [debug] [Thread-2 (]: On model.threat_risk.dim_vendor: BEGIN
[0m00:54:38.420740 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.420551 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.fact_kev"
[0m00:54:38.421533 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m00:54:38.421717 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: BEGIN
[0m00:54:38.421862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:38.425341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m00:54:38.425588 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m00:54:38.425866 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */

  
    

  create  table "threat_risk"."marts"."fact_kev__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(cve_id,'')) as cve_key,
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  run_date as date_day,
  cve_id,
  vulnerability_name,
  date_added,
  due_date,
  required_action,
  notes
from "threat_risk"."staging"."stg_kev"
where cve_id is not null
  );
  
[0m00:54:38.425769 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m00:54:38.426110 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m00:54:38.426273 [debug] [Thread-2 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */

  
    

  create  table "threat_risk"."marts"."dim_vendor__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project, '')) as vendor_key,
  vendor_project
from (
  select distinct vendor_project
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null
) v
  );
  
[0m00:54:38.436278 [debug] [Thread-2 (]: SQL status: SELECT 248 in 0.010 seconds
[0m00:54:38.437852 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m00:54:38.438047 [debug] [Thread-2 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor" rename to "dim_vendor__dbt_backup"
[0m00:54:38.438520 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:54:38.439540 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m00:54:38.439717 [debug] [Thread-2 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor__dbt_tmp" rename to "dim_vendor"
[0m00:54:38.440146 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:54:38.440827 [debug] [Thread-2 (]: On model.threat_risk.dim_vendor: COMMIT
[0m00:54:38.441009 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m00:54:38.441161 [debug] [Thread-2 (]: On model.threat_risk.dim_vendor: COMMIT
[0m00:54:38.443903 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m00:54:38.444968 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."marts"."dim_vendor__dbt_backup"
[0m00:54:38.445239 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m00:54:38.445408 [debug] [Thread-2 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
drop table if exists "threat_risk"."marts"."dim_vendor__dbt_backup" cascade
[0m00:54:38.447680 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m00:54:38.448274 [debug] [Thread-2 (]: On model.threat_risk.dim_vendor: Close
[0m00:54:38.448574 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1cc290>]}
[0m00:54:38.448853 [info ] [Thread-2 (]: 15 of 33 OK created sql table model marts.dim_vendor ........................... [[32mSELECT 248[0m in 0.04s]
[0m00:54:38.449121 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_vendor
[0m00:54:38.449322 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m00:54:38.449664 [info ] [Thread-2 (]: 17 of 33 START test not_null_dim_product_product ............................... [RUN]
[0m00:54:38.449963 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_vendor, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m00:54:38.450145 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m00:54:38.451965 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m00:54:38.452835 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m00:54:38.453676 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m00:54:38.454246 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m00:54:38.454444 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: BEGIN
[0m00:54:38.454627 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.458235 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m00:54:38.458452 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m00:54:38.458651 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product.56a877bc84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."marts"."dim_product"
where product is null



      
    ) dbt_internal_test
[0m00:54:38.459304 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m00:54:38.459977 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: ROLLBACK
[0m00:54:38.460273 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: Close
[0m00:54:38.460637 [info ] [Thread-2 (]: 17 of 33 PASS not_null_dim_product_product ..................................... [[32mPASS[0m in 0.01s]
[0m00:54:38.460972 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m00:54:38.461235 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m00:54:38.461461 [info ] [Thread-2 (]: 18 of 33 START test not_null_dim_product_product_key ........................... [RUN]
[0m00:54:38.461698 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.not_null_dim_product_product_key.f0e1d838d3)
[0m00:54:38.461861 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m00:54:38.464616 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m00:54:38.465200 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m00:54:38.466174 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m00:54:38.466667 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m00:54:38.466836 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m00:54:38.466982 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.470284 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m00:54:38.470526 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m00:54:38.470724 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "threat_risk"."marts"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m00:54:38.471386 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m00:54:38.472076 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m00:54:38.472324 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: Close
[0m00:54:38.472650 [info ] [Thread-2 (]: 18 of 33 PASS not_null_dim_product_product_key ................................. [[32mPASS[0m in 0.01s]
[0m00:54:38.473001 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m00:54:38.473264 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m00:54:38.473504 [info ] [Thread-2 (]: 19 of 33 START test not_null_dim_product_vendor_key ............................ [RUN]
[0m00:54:38.473767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.not_null_dim_product_vendor_key.78836999d2)
[0m00:54:38.474009 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m00:54:38.477104 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m00:54:38.477710 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m00:54:38.478631 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m00:54:38.479131 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m00:54:38.479329 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: BEGIN
[0m00:54:38.479523 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.482986 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m00:54:38.483158 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m00:54:38.483361 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_product"
where vendor_key is null



      
    ) dbt_internal_test
[0m00:54:38.483981 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m00:54:38.484608 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: ROLLBACK
[0m00:54:38.484886 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: Close
[0m00:54:38.485174 [info ] [Thread-2 (]: 19 of 33 PASS not_null_dim_product_vendor_key .................................. [[32mPASS[0m in 0.01s]
[0m00:54:38.485509 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m00:54:38.485773 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m00:54:38.486006 [info ] [Thread-2 (]: 20 of 33 START test not_null_dim_product_vendor_project ........................ [RUN]
[0m00:54:38.486289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m00:54:38.486499 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m00:54:38.488188 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m00:54:38.488762 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m00:54:38.489994 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m00:54:38.490671 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m00:54:38.490858 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: BEGIN
[0m00:54:38.491026 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.494463 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m00:54:38.494683 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m00:54:38.494870 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_product"
where vendor_project is null



      
    ) dbt_internal_test
[0m00:54:38.495525 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m00:54:38.496253 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: ROLLBACK
[0m00:54:38.496395 [debug] [Thread-1 (]: SQL status: SELECT 20845 in 0.070 seconds
[0m00:54:38.496522 [debug] [Thread-4 (]: SQL status: SELECT 32344 in 0.124 seconds
[0m00:54:38.496744 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: Close
[0m00:54:38.499407 [info ] [Thread-2 (]: 20 of 33 PASS not_null_dim_product_vendor_project .............................. [[32mPASS[0m in 0.01s]
[0m00:54:38.499121 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_url"
[0m00:54:38.497938 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m00:54:38.499666 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m00:54:38.499896 [debug] [Thread-4 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url" rename to "dim_url__dbt_backup"
[0m00:54:38.500120 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev" rename to "fact_kev__dbt_backup"
[0m00:54:38.500412 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m00:54:38.500936 [info ] [Thread-2 (]: 21 of 33 START test unique_dim_product_product_key ............................. [RUN]
[0m00:54:38.501157 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:54:38.501360 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m00:54:38.502780 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m00:54:38.502555 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_url"
[0m00:54:38.501512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:54:38.505099 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m00:54:38.505348 [debug] [Thread-4 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url__dbt_tmp" rename to "dim_url"
[0m00:54:38.506398 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m00:54:38.506931 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev__dbt_tmp" rename to "fact_kev"
[0m00:54:38.507062 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:54:38.507194 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m00:54:38.507819 [debug] [Thread-4 (]: On model.threat_risk.dim_url: COMMIT
[0m00:54:38.507925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:54:38.508955 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m00:54:38.509420 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_url"
[0m00:54:38.510323 [debug] [Thread-4 (]: On model.threat_risk.dim_url: COMMIT
[0m00:54:38.509948 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: COMMIT
[0m00:54:38.510609 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m00:54:38.510925 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: BEGIN
[0m00:54:38.510767 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m00:54:38.511056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.511185 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: COMMIT
[0m00:54:38.513380 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m00:54:38.514058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m00:54:38.515179 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."marts"."dim_url__dbt_backup"
[0m00:54:38.516256 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."marts"."fact_kev__dbt_backup"
[0m00:54:38.516891 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m00:54:38.516651 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_url"
[0m00:54:38.516406 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m00:54:38.517406 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m00:54:38.517235 [debug] [Thread-4 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
drop table if exists "threat_risk"."marts"."dim_url__dbt_backup" cascade
[0m00:54:38.517048 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
drop table if exists "threat_risk"."marts"."fact_kev__dbt_backup" cascade
[0m00:54:38.517553 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:38.518643 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:54:38.519372 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m00:54:38.519630 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m00:54:38.519793 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m00:54:38.520843 [debug] [Thread-1 (]: On model.threat_risk.fact_kev: Close
[0m00:54:38.520376 [debug] [Thread-4 (]: On model.threat_risk.dim_url: Close
[0m00:54:38.519925 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: Close
[0m00:54:38.521598 [info ] [Thread-2 (]: 21 of 33 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.02s]
[0m00:54:38.521339 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d236c10>]}
[0m00:54:38.521104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d41d4d0>]}
[0m00:54:38.522543 [info ] [Thread-1 (]: 16 of 33 OK created sql table model marts.fact_kev ............................. [[32mSELECT 20845[0m in 0.11s]
[0m00:54:38.522272 [info ] [Thread-4 (]: 11 of 33 OK created sql table model marts.dim_url .............................. [[32mSELECT 32344[0m in 0.18s]
[0m00:54:38.521899 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m00:54:38.522772 [debug] [Thread-1 (]: Finished running node model.threat_risk.fact_kev
[0m00:54:38.523041 [debug] [Thread-4 (]: Finished running node model.threat_risk.dim_url
[0m00:54:38.523222 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m00:54:38.523981 [info ] [Thread-2 (]: 22 of 33 START test not_null_dim_vendor_vendor_key ............................. [RUN]
[0m00:54:38.523724 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m00:54:38.523443 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m00:54:38.524661 [info ] [Thread-1 (]: 23 of 33 START test not_null_dim_vendor_vendor_project ......................... [RUN]
[0m00:54:38.524451 [info ] [Thread-4 (]: 24 of 33 START test unique_dim_vendor_vendor_key ............................... [RUN]
[0m00:54:38.524214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_product_product_key.1753236bd0, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m00:54:38.524856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_kev, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m00:54:38.525065 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_url, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m00:54:38.525234 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m00:54:38.525376 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m00:54:38.525552 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m00:54:38.528205 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m00:54:38.529473 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m00:54:38.530865 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m00:54:38.531537 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m00:54:38.531695 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m00:54:38.532822 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m00:54:38.532701 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m00:54:38.533957 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m00:54:38.534907 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m00:54:38.535600 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m00:54:38.535806 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: BEGIN
[0m00:54:38.536015 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m00:54:38.536366 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.536549 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m00:54:38.536716 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: BEGIN
[0m00:54:38.536973 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: BEGIN
[0m00:54:38.537448 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:54:38.537260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:38.543068 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m00:54:38.543304 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m00:54:38.543484 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m00:54:38.543650 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_vendor"
where vendor_key is null



      
    ) dbt_internal_test
[0m00:54:38.543902 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m00:54:38.544050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m00:54:38.544492 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m00:54:38.544272 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_key is not null
group by vendor_key
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:38.544616 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m00:54:38.544765 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_vendor"
where vendor_project is null



      
    ) dbt_internal_test
[0m00:54:38.545499 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: ROLLBACK
[0m00:54:38.545641 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:54:38.545950 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: Close
[0m00:54:38.546422 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: ROLLBACK
[0m00:54:38.546531 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:54:38.546833 [info ] [Thread-2 (]: 22 of 33 PASS not_null_dim_vendor_vendor_key ................................... [[32mPASS[0m in 0.02s]
[0m00:54:38.547092 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: Close
[0m00:54:38.548026 [info ] [Thread-4 (]: 24 of 33 PASS unique_dim_vendor_vendor_key ..................................... [[32mPASS[0m in 0.02s]
[0m00:54:38.547790 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m00:54:38.547537 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: ROLLBACK
[0m00:54:38.548326 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m00:54:38.548600 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m00:54:38.548946 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: Close
[0m00:54:38.549668 [info ] [Thread-1 (]: 23 of 33 PASS not_null_dim_vendor_vendor_project ............................... [[32mPASS[0m in 0.02s]
[0m00:54:38.549307 [info ] [Thread-2 (]: 25 of 33 START test unique_dim_vendor_vendor_project ........................... [RUN]
[0m00:54:38.549078 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m00:54:38.550421 [info ] [Thread-4 (]: 26 of 33 START test not_null_fact_kev_cve_id ................................... [RUN]
[0m00:54:38.550184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m00:54:38.549963 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m00:54:38.550660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m00:54:38.550928 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m00:54:38.551178 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m00:54:38.553343 [info ] [Thread-1 (]: 27 of 33 START test not_null_fact_kev_date_day ................................. [RUN]
[0m00:54:38.553103 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m00:54:38.551429 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m00:54:38.553598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m00:54:38.555663 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m00:54:38.555430 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m00:54:38.557198 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m00:54:38.557353 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m00:54:38.558464 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m00:54:38.558672 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m00:54:38.558887 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m00:54:38.559686 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m00:54:38.559884 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m00:54:38.560626 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m00:54:38.560916 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: BEGIN
[0m00:54:38.561153 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m00:54:38.561317 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.561499 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: BEGIN
[0m00:54:38.561611 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m00:54:38.561872 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:54:38.562151 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: BEGIN
[0m00:54:38.562447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:38.565266 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m00:54:38.565525 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m00:54:38.566851 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m00:54:38.567104 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m00:54:38.567291 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_project as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_project is not null
group by vendor_project
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:38.567524 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."marts"."fact_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m00:54:38.567721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:54:38.568050 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m00:54:38.568209 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_kev"
where date_day is null



      
    ) dbt_internal_test
[0m00:54:38.568572 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:54:38.569595 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: ROLLBACK
[0m00:54:38.569946 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: Close
[0m00:54:38.570347 [info ] [Thread-2 (]: 25 of 33 PASS unique_dim_vendor_vendor_project ................................. [[32mPASS[0m in 0.02s]
[0m00:54:38.570805 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m00:54:38.571060 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m00:54:38.571265 [info ] [Thread-2 (]: 28 of 33 START test not_null_dim_url_url ....................................... [RUN]
[0m00:54:38.571540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96, now test.threat_risk.not_null_dim_url_url.2b67971659)
[0m00:54:38.571763 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_url_url.2b67971659
[0m00:54:38.574845 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m00:54:38.574994 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m00:54:38.575138 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m00:54:38.576042 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: ROLLBACK
[0m00:54:38.576569 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: ROLLBACK
[0m00:54:38.576685 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_url_url.2b67971659
[0m00:54:38.576927 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: Close
[0m00:54:38.577179 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: Close
[0m00:54:38.577997 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m00:54:38.578272 [info ] [Thread-4 (]: 26 of 33 PASS not_null_fact_kev_cve_id ......................................... [[32mPASS[0m in 0.03s]
[0m00:54:38.579153 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m00:54:38.578677 [info ] [Thread-1 (]: 27 of 33 PASS not_null_fact_kev_date_day ....................................... [[32mPASS[0m in 0.03s]
[0m00:54:38.579731 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m00:54:38.579431 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m00:54:38.579875 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m00:54:38.580043 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m00:54:38.580583 [info ] [Thread-1 (]: 30 of 33 START test unique_dim_url_url ......................................... [RUN]
[0m00:54:38.580434 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: BEGIN
[0m00:54:38.580205 [info ] [Thread-4 (]: 29 of 33 START test not_null_dim_url_url_key ................................... [RUN]
[0m00:54:38.580763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_date_day.64362f7a33, now test.threat_risk.unique_dim_url_url.4c561dc36d)
[0m00:54:38.580928 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.581075 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8, now test.threat_risk.not_null_dim_url_url_key.89914b0872)
[0m00:54:38.581484 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m00:54:38.581237 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m00:54:38.582998 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m00:54:38.584422 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m00:54:38.584833 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m00:54:38.585151 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m00:54:38.585053 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m00:54:38.585309 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m00:54:38.585406 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url.2b67971659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."dim_url"
where url is null



      
    ) dbt_internal_test
[0m00:54:38.586203 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m00:54:38.586979 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m00:54:38.587536 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m00:54:38.587920 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: BEGIN
[0m00:54:38.587782 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m00:54:38.588327 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: BEGIN
[0m00:54:38.588112 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:54:38.588618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:38.589781 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m00:54:38.590434 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: ROLLBACK
[0m00:54:38.590679 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: Close
[0m00:54:38.590920 [info ] [Thread-2 (]: 28 of 33 PASS not_null_dim_url_url ............................................. [[32mPASS[0m in 0.02s]
[0m00:54:38.591209 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m00:54:38.591479 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m00:54:38.591707 [info ] [Thread-2 (]: 31 of 33 START test unique_dim_url_url_key ..................................... [RUN]
[0m00:54:38.591928 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url.2b67971659, now test.threat_risk.unique_dim_url_url_key.d67ee5b979)
[0m00:54:38.592085 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m00:54:38.593586 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m00:54:38.593876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m00:54:38.594132 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m00:54:38.593987 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m00:54:38.594543 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m00:54:38.594417 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m00:54:38.594288 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url.4c561dc36d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:38.594675 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url_key.89914b0872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."dim_url"
where url_key is null



      
    ) dbt_internal_test
[0m00:54:38.595532 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m00:54:38.596115 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m00:54:38.596261 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: BEGIN
[0m00:54:38.596386 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:38.597081 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m00:54:38.597682 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: ROLLBACK
[0m00:54:38.598456 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: Close
[0m00:54:38.598916 [info ] [Thread-4 (]: 29 of 33 PASS not_null_dim_url_url_key ......................................... [[32mPASS[0m in 0.02s]
[0m00:54:38.599482 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m00:54:38.601119 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m00:54:38.601293 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m00:54:38.601451 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url_key.d67ee5b979"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url_key is not null
group by url_key
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:38.603533 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m00:54:38.604192 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: ROLLBACK
[0m00:54:38.604461 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: Close
[0m00:54:38.604728 [info ] [Thread-1 (]: 30 of 33 PASS unique_dim_url_url ............................................... [[32mPASS[0m in 0.02s]
[0m00:54:38.605031 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m00:54:38.608549 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m00:54:38.609023 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: ROLLBACK
[0m00:54:38.609215 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: Close
[0m00:54:38.609432 [info ] [Thread-2 (]: 31 of 33 PASS unique_dim_url_url_key ........................................... [[32mPASS[0m in 0.02s]
[0m00:54:38.609694 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m00:54:38.669520 [debug] [Thread-3 (]: SQL status: SELECT 198325 in 0.295 seconds
[0m00:54:38.670987 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m00:54:38.671182 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events" rename to "fact_url_events__dbt_backup"
[0m00:54:38.671643 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:54:38.672578 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m00:54:38.672759 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events__dbt_tmp" rename to "fact_url_events"
[0m00:54:38.673067 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:54:38.673640 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: COMMIT
[0m00:54:38.673818 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m00:54:38.674004 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: COMMIT
[0m00:54:38.677049 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m00:54:38.678010 [debug] [Thread-3 (]: Applying DROP to: "threat_risk"."marts"."fact_url_events__dbt_backup"
[0m00:54:38.678287 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m00:54:38.678590 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
drop table if exists "threat_risk"."marts"."fact_url_events__dbt_backup" cascade
[0m00:54:38.680027 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m00:54:38.680540 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: Close
[0m00:54:38.680810 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c9aa44-e74c-4749-b885-179e9f5ac8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c21a710>]}
[0m00:54:38.681116 [info ] [Thread-3 (]: 12 of 33 OK created sql table model marts.fact_url_events ...................... [[32mSELECT 198325[0m in 0.34s]
[0m00:54:38.681524 [debug] [Thread-3 (]: Finished running node model.threat_risk.fact_url_events
[0m00:54:38.682018 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m00:54:38.682239 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m00:54:38.682430 [info ] [Thread-4 (]: 32 of 33 START test not_null_fact_url_events_date_day .......................... [RUN]
[0m00:54:38.682681 [info ] [Thread-1 (]: 33 of 33 START test not_null_fact_url_events_url_key ........................... [RUN]
[0m00:54:38.682895 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url_key.89914b0872, now test.threat_risk.not_null_fact_url_events_date_day.d658eee263)
[0m00:54:38.683101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_url_url.4c561dc36d, now test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d)
[0m00:54:38.683269 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m00:54:38.683453 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m00:54:38.685035 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m00:54:38.687436 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m00:54:38.687974 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m00:54:38.688099 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m00:54:38.688847 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m00:54:38.689542 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m00:54:38.689936 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m00:54:38.690057 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m00:54:38.690166 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: BEGIN
[0m00:54:38.690288 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: BEGIN
[0m00:54:38.690510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:38.690399 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:54:38.693656 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m00:54:38.693805 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m00:54:38.693938 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."fact_url_events"
where url_key is null



      
    ) dbt_internal_test
[0m00:54:38.694946 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m00:54:38.695169 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m00:54:38.695385 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_url_events"
where date_day is null



      
    ) dbt_internal_test
[0m00:54:38.713801 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.018 seconds
[0m00:54:38.713981 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m00:54:38.715037 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: ROLLBACK
[0m00:54:38.714592 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: ROLLBACK
[0m00:54:38.715311 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: Close
[0m00:54:38.715667 [info ] [Thread-1 (]: 33 of 33 PASS not_null_fact_url_events_url_key ................................. [[32mPASS[0m in 0.03s]
[0m00:54:38.715399 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: Close
[0m00:54:38.716007 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m00:54:38.716272 [info ] [Thread-4 (]: 32 of 33 PASS not_null_fact_url_events_date_day ................................ [[32mPASS[0m in 0.03s]
[0m00:54:38.716686 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m00:54:38.717507 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:38.717677 [debug] [MainThread]: On master: BEGIN
[0m00:54:38.717813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:54:38.720982 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:54:38.721152 [debug] [MainThread]: On master: COMMIT
[0m00:54:38.721298 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:38.721450 [debug] [MainThread]: On master: COMMIT
[0m00:54:38.721646 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:54:38.721785 [debug] [MainThread]: On master: Close
[0m00:54:38.721967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:54:38.722123 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url_key.d67ee5b979' was properly closed.
[0m00:54:38.722267 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d' was properly closed.
[0m00:54:38.722408 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_date_day.d658eee263' was properly closed.
[0m00:54:38.722547 [debug] [MainThread]: Connection 'model.threat_risk.fact_url_events' was properly closed.
[0m00:54:38.722758 [info ] [MainThread]: 
[0m00:54:38.722932 [info ] [MainThread]: Finished running 2 view models, 25 data tests, 6 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m00:54:38.724327 [debug] [MainThread]: Command end result
[0m00:54:38.741201 [info ] [MainThread]: 
[0m00:54:38.741526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:54:38.741680 [info ] [MainThread]: 
[0m00:54:38.741845 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 TOTAL=33
[0m00:54:38.742771 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.9091111, "process_user_time": 1.031819, "process_kernel_time": 0.104005, "process_mem_max_rss": "122680", "process_in_blocks": "90656", "process_out_blocks": "4058"}
[0m00:54:38.742998 [debug] [MainThread]: Command `dbt build` succeeded at 00:54:38.742961 after 0.91 seconds
[0m00:54:38.743149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e548390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ef0450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0785d90>]}
[0m00:54:38.743309 [debug] [MainThread]: Flushing usage events
[0m01:44:59.329647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859d9e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d3cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859db110>]}


============================== 01:44:59.332214 | 9c7c0b62-7dce-4585-8a03-4b5edaccf1a3 ==============================
[0m01:44:59.332214 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:44:59.332475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/logs', 'profiles_dir': '/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:44:59.378700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a30fd0>]}
[0m01:44:59.395628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84abdc50>]}
[0m01:44:59.395950 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:44:59.415797 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:44:59.457807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:44:59.457973 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:44:59.470951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848da390>]}
[0m01:44:59.511329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8452fe90>]}
[0m01:44:59.511560 [info ] [MainThread]: Found 8 models, 25 data tests, 429 macros
[0m01:44:59.512933 [info ] [MainThread]: 
[0m01:44:59.513221 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:44:59.514817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m01:44:59.515046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m01:44:59.527779 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m01:44:59.527907 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m01:44:59.528076 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m01:44:59.528305 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m01:44:59.528479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:59.528664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:59.540036 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m01:44:59.540184 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m01:44:59.540714 [debug] [ThreadPool]: On list_threat_risk: Close
[0m01:44:59.541223 [debug] [ThreadPool]: On list_threat_risk: Close
[0m01:44:59.542228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_staging)
[0m01:44:59.542526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_marts)
[0m01:44:59.544799 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m01:44:59.545526 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m01:44:59.545690 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m01:44:59.545819 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m01:44:59.545940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:44:59.546056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:44:59.549570 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:44:59.549709 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:44:59.549838 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m01:44:59.549996 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m01:44:59.550157 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m01:44:59.550339 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m01:44:59.555148 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m01:44:59.555254 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m01:44:59.555707 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m01:44:59.556164 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m01:44:59.556359 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m01:44:59.556476 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m01:44:59.559111 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:59.559288 [debug] [MainThread]: On master: BEGIN
[0m01:44:59.559412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:44:59.562386 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:44:59.562515 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:59.562693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:44:59.567546 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m01:44:59.567979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84520a50>]}
[0m01:44:59.568172 [debug] [MainThread]: On master: ROLLBACK
[0m01:44:59.568342 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:59.568468 [debug] [MainThread]: On master: BEGIN
[0m01:44:59.568660 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:44:59.568787 [debug] [MainThread]: On master: COMMIT
[0m01:44:59.568901 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:59.569008 [debug] [MainThread]: On master: COMMIT
[0m01:44:59.569163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:44:59.569277 [debug] [MainThread]: On master: Close
[0m01:44:59.569450 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:44:59.569770 [info ] [MainThread]: 
[0m01:44:59.573170 [debug] [Thread-1 (]: Began running node model.threat_risk.stg_kev
[0m01:44:59.573320 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_urlhaus
[0m01:44:59.573537 [info ] [Thread-1 (]: 1 of 33 START sql view model staging.stg_kev ................................... [RUN]
[0m01:44:59.573803 [info ] [Thread-2 (]: 2 of 33 START sql view model staging.stg_urlhaus ............................... [RUN]
[0m01:44:59.574040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now model.threat_risk.stg_kev)
[0m01:44:59.574235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now model.threat_risk.stg_urlhaus)
[0m01:44:59.574423 [debug] [Thread-1 (]: Began compiling node model.threat_risk.stg_kev
[0m01:44:59.574581 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_urlhaus
[0m01:44:59.576948 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.stg_kev"
[0m01:44:59.577661 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus"
[0m01:44:59.578915 [debug] [Thread-1 (]: Began executing node model.threat_risk.stg_kev
[0m01:44:59.579032 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_urlhaus
[0m01:44:59.590370 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.stg_kev"
[0m01:44:59.591664 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.stg_urlhaus"
[0m01:44:59.592444 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m01:44:59.592568 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m01:44:59.592839 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: BEGIN
[0m01:44:59.592706 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: BEGIN
[0m01:44:59.593058 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:59.592949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:59.596453 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m01:44:59.596608 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m01:44:59.596812 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */

  create view "threat_risk"."staging"."stg_urlhaus__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.urlhaus_recent
),
clean as (
  select
    nullif(trim(url), '') as url,
    nullif(trim(url_status), '') as url_status,
    nullif(trim(host), '') as host,
    date_added,
    nullif(trim(threat), '') as threat,
    nullif(trim(tags), '') as tags,
    nullif(trim(urlhaus_link), '') as urlhaus_link,
    nullif(trim(reporter), '') as reporter,
    larted,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m01:44:59.596984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:44:59.597130 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m01:44:59.597290 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */

  create view "threat_risk"."staging"."stg_kev__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.kev
),
clean as (
  select
    nullif(trim(cve_id), '') as cve_id,
    nullif(trim(vendor_project), '') as vendor_project,
    nullif(trim(product), '') as product,
    nullif(trim(vulnerability_name), '') as vulnerability_name,
    date_added,
    short_description,
    required_action,
    due_date,
    notes,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m01:44:59.602818 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m01:44:59.602925 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m01:44:59.605382 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m01:44:59.606570 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus" rename to "stg_urlhaus__dbt_backup"
[0m01:44:59.606389 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m01:44:59.606794 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev" rename to "stg_kev__dbt_backup"
[0m01:44:59.607500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:44:59.607606 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:44:59.608510 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m01:44:59.609577 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev__dbt_tmp" rename to "stg_kev"
[0m01:44:59.609428 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m01:44:59.609776 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus__dbt_tmp" rename to "stg_urlhaus"
[0m01:44:59.609897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:44:59.615756 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m01:44:59.615998 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m01:44:59.615877 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m01:44:59.616547 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m01:44:59.616123 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m01:44:59.616678 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m01:44:59.616863 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m01:44:59.617124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m01:44:59.617240 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m01:44:59.619910 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."staging"."stg_urlhaus__dbt_backup"
[0m01:44:59.619131 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."staging"."stg_kev__dbt_backup"
[0m01:44:59.621606 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m01:44:59.621424 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m01:44:59.621841 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
drop view if exists "threat_risk"."staging"."stg_urlhaus__dbt_backup" cascade
[0m01:44:59.621725 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
drop view if exists "threat_risk"."staging"."stg_kev__dbt_backup" cascade
[0m01:44:59.623957 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:44:59.624953 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: Close
[0m01:44:59.624082 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:44:59.625780 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: Close
[0m01:44:59.626006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83240a50>]}
[0m01:44:59.626444 [info ] [Thread-1 (]: 1 of 33 OK created sql view model staging.stg_kev .............................. [[32mCREATE VIEW[0m in 0.05s]
[0m01:44:59.626204 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831bebd0>]}
[0m01:44:59.626954 [info ] [Thread-2 (]: 2 of 33 OK created sql view model staging.stg_urlhaus .......................... [[32mCREATE VIEW[0m in 0.05s]
[0m01:44:59.626722 [debug] [Thread-1 (]: Finished running node model.threat_risk.stg_kev
[0m01:44:59.627171 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_urlhaus
[0m01:44:59.627566 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m01:44:59.627758 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m01:44:59.627868 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m01:44:59.628696 [info ] [Thread-1 (]: 5 of 33 START test not_null_stg_kev_run_date ................................... [RUN]
[0m01:44:59.628121 [info ] [Thread-4 (]: 3 of 33 START test not_null_stg_kev_cve_id ..................................... [RUN]
[0m01:44:59.628310 [info ] [Thread-3 (]: 4 of 33 START test not_null_stg_kev_product .................................... [RUN]
[0m01:44:59.627964 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m01:44:59.629442 [info ] [Thread-2 (]: 6 of 33 START test not_null_stg_kev_vendor_project ............................. [RUN]
[0m01:44:59.629109 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0'
[0m01:44:59.629304 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.threat_risk.not_null_stg_kev_product.9b2d2b4877'
[0m01:44:59.628889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_kev, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m01:44:59.630027 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m01:44:59.629766 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m01:44:59.629903 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m01:44:59.629596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m01:44:59.637783 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m01:44:59.636303 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m01:44:59.637620 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m01:44:59.634871 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m01:44:59.638955 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m01:44:59.640269 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m01:44:59.640472 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m01:44:59.640645 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m01:44:59.645365 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m01:44:59.645581 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m01:44:59.646286 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m01:44:59.647005 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m01:44:59.648495 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m01:44:59.648936 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m01:44:59.649184 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m01:44:59.649375 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m01:44:59.649496 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m01:44:59.649647 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m01:44:59.649735 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m01:44:59.650339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:59.650028 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m01:44:59.650180 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m01:44:59.649879 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:44:59.650626 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:44:59.650904 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:59.658197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m01:44:59.658439 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m01:44:59.658668 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m01:44:59.658840 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m01:44:59.659035 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m01:44:59.659185 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m01:44:59.659345 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m01:44:59.659527 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m01:44:59.659711 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m01:44:59.659878 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m01:44:59.660060 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m01:44:59.660274 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m01:44:59.679713 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.019 seconds
[0m01:44:59.679919 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m01:44:59.680065 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.020 seconds
[0m01:44:59.680221 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m01:44:59.681486 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m01:44:59.682013 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m01:44:59.682531 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m01:44:59.683008 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m01:44:59.683267 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m01:44:59.683390 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m01:44:59.683596 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m01:44:59.683791 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m01:44:59.684035 [info ] [Thread-2 (]: 6 of 33 PASS not_null_stg_kev_vendor_project ................................... [[32mPASS[0m in 0.05s]
[0m01:44:59.684405 [info ] [Thread-4 (]: 3 of 33 PASS not_null_stg_kev_cve_id ........................................... [[32mPASS[0m in 0.06s]
[0m01:44:59.684740 [info ] [Thread-3 (]: 4 of 33 PASS not_null_stg_kev_product .......................................... [[32mPASS[0m in 0.06s]
[0m01:44:59.685022 [info ] [Thread-1 (]: 5 of 33 PASS not_null_stg_kev_run_date ......................................... [[32mPASS[0m in 0.06s]
[0m01:44:59.685299 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m01:44:59.685526 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m01:44:59.685757 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m01:44:59.685955 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m01:44:59.686188 [debug] [Thread-2 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m01:44:59.686406 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m01:44:59.686625 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m01:44:59.686816 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m01:44:59.687080 [info ] [Thread-2 (]: 7 of 33 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m01:44:59.687321 [info ] [Thread-4 (]: 8 of 33 START test not_null_stg_urlhaus_run_date ............................... [RUN]
[0m01:44:59.687523 [info ] [Thread-3 (]: 9 of 33 START test not_null_stg_urlhaus_url .................................... [RUN]
[0m01:44:59.687718 [info ] [Thread-1 (]: 10 of 33 START test not_null_stg_urlhaus_url_status ............................ [RUN]
[0m01:44:59.687944 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41)
[0m01:44:59.688133 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93)
[0m01:44:59.688339 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m01:44:59.688517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m01:44:59.688695 [debug] [Thread-2 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m01:44:59.688841 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m01:44:59.689009 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m01:44:59.689184 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m01:44:59.712360 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m01:44:59.713759 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m01:44:59.715074 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m01:44:59.716382 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m01:44:59.717469 [debug] [Thread-2 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m01:44:59.717708 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m01:44:59.717997 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m01:44:59.718788 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m01:44:59.719019 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m01:44:59.719662 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m01:44:59.720390 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m01:44:59.721382 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m01:44:59.721603 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m01:44:59.722038 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m01:44:59.722389 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m01:44:59.722533 [debug] [Thread-2 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m01:44:59.722752 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m01:44:59.722870 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m01:44:59.723510 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:44:59.723210 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:59.723370 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m01:44:59.723035 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m01:44:59.724048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:59.724312 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:44:59.728388 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m01:44:59.728565 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m01:44:59.728746 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m01:44:59.729379 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m01:44:59.729737 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m01:44:59.729937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m01:44:59.730082 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m01:44:59.730323 [debug] [Thread-2 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m01:44:59.730630 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m01:44:59.730844 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m01:44:59.731206 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m01:44:59.731453 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m01:44:59.778711 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.050 seconds
[0m01:44:59.778957 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m01:44:59.779152 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.048 seconds
[0m01:44:59.779901 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m01:44:59.780044 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.048 seconds
[0m01:44:59.780578 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m01:44:59.781088 [debug] [Thread-2 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m01:44:59.781372 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m01:44:59.781816 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m01:44:59.782108 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m01:44:59.782586 [info ] [Thread-4 (]: 8 of 33 PASS not_null_stg_urlhaus_run_date ..................................... [[32mPASS[0m in 0.09s]
[0m01:44:59.782326 [debug] [Thread-2 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m01:44:59.782881 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m01:44:59.783086 [info ] [Thread-1 (]: 10 of 33 PASS not_null_stg_urlhaus_url_status .................................. [[32mPASS[0m in 0.09s]
[0m01:44:59.783358 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m01:44:59.783636 [info ] [Thread-2 (]: 7 of 33 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown .. [[32mPASS[0m in 0.10s]
[0m01:44:59.783954 [info ] [Thread-3 (]: 9 of 33 PASS not_null_stg_urlhaus_url .......................................... [[32mPASS[0m in 0.10s]
[0m01:44:59.784226 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m01:44:59.784481 [debug] [Thread-4 (]: Began running node model.threat_risk.dim_product
[0m01:44:59.785690 [info ] [Thread-4 (]: 11 of 33 START sql table model marts.dim_product ............................... [RUN]
[0m01:44:59.785106 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m01:44:59.785401 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_vendor
[0m01:44:59.784811 [debug] [Thread-2 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m01:44:59.785889 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now model.threat_risk.dim_product)
[0m01:44:59.786130 [debug] [Thread-3 (]: Began running node model.threat_risk.fact_kev
[0m01:44:59.786422 [info ] [Thread-1 (]: 12 of 33 START sql table model marts.dim_vendor ................................ [RUN]
[0m01:44:59.786853 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_date
[0m01:44:59.786940 [debug] [Thread-4 (]: Began compiling node model.threat_risk.dim_product
[0m01:44:59.787168 [info ] [Thread-3 (]: 13 of 33 START sql table model marts.fact_kev .................................. [RUN]
[0m01:44:59.787432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now model.threat_risk.dim_vendor)
[0m01:44:59.787648 [info ] [Thread-2 (]: 14 of 33 START sql table model marts.dim_date .................................. [RUN]
[0m01:44:59.789556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now model.threat_risk.dim_date)
[0m01:44:59.789172 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now model.threat_risk.fact_kev)
[0m01:44:59.789370 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_vendor
[0m01:44:59.788915 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.dim_product"
[0m01:44:59.789716 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_date
[0m01:44:59.789903 [debug] [Thread-3 (]: Began compiling node model.threat_risk.fact_kev
[0m01:44:59.790879 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_vendor"
[0m01:44:59.792064 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_date"
[0m01:44:59.794052 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.fact_kev"
[0m01:44:59.794287 [debug] [Thread-4 (]: Began executing node model.threat_risk.dim_product
[0m01:44:59.794931 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_vendor
[0m01:44:59.795085 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_date
[0m01:44:59.802688 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.dim_product"
[0m01:44:59.803893 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.dim_vendor"
[0m01:44:59.804023 [debug] [Thread-3 (]: Began executing node model.threat_risk.fact_kev
[0m01:44:59.805250 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.dim_date"
[0m01:44:59.806672 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.fact_kev"
[0m01:44:59.806987 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_product"
[0m01:44:59.807127 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m01:44:59.807519 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m01:44:59.808079 [debug] [Thread-2 (]: On model.threat_risk.dim_date: BEGIN
[0m01:44:59.807806 [debug] [Thread-1 (]: On model.threat_risk.dim_vendor: BEGIN
[0m01:44:59.807923 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m01:44:59.807634 [debug] [Thread-4 (]: On model.threat_risk.dim_product: BEGIN
[0m01:44:59.808702 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:44:59.808391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:59.808557 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: BEGIN
[0m01:44:59.808219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:59.809132 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:44:59.813440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:44:59.813666 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m01:44:59.813826 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m01:44:59.814054 [debug] [Thread-1 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */

  
    

  create  table "threat_risk"."marts"."dim_vendor__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project, '')) as vendor_key,
  vendor_project
from (
  select distinct vendor_project
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null
) v
  );
  
[0m01:44:59.814211 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m01:44:59.814369 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_product"
[0m01:44:59.814910 [debug] [Thread-4 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */

  
    

  create  table "threat_risk"."marts"."dim_product__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  md5(coalesce(vendor_project,'')) as vendor_key,
  vendor_project,
  product
from (
  select distinct vendor_project, product
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null and product is not null
) p
  );
  
[0m01:44:59.814749 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m01:44:59.814637 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m01:44:59.815157 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */

  
    

  create  table "threat_risk"."marts"."fact_kev__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(cve_id,'')) as cve_key,
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  run_date as date_day,
  cve_id,
  vulnerability_name,
  date_added,
  due_date,
  required_action,
  notes
from "threat_risk"."staging"."stg_kev"
where cve_id is not null
  );
  
[0m01:44:59.815386 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m01:44:59.815698 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */

  
    

  create  table "threat_risk"."marts"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with dates as (
  select distinct run_date as d from "threat_risk"."staging"."stg_kev"
  union
  select distinct run_date as d from "threat_risk"."staging"."stg_urlhaus"
),
final as (
  select
    d as date_day,
    extract(year from d)::int as year,
    extract(month from d)::int as month,
    extract(day from d)::int as day
  from dates
)
select * from final
  );
  
[0m01:44:59.823326 [debug] [Thread-1 (]: SQL status: SELECT 251 in 0.009 seconds
[0m01:44:59.824940 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m01:44:59.825198 [debug] [Thread-1 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor" rename to "dim_vendor__dbt_backup"
[0m01:44:59.825870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:44:59.827113 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m01:44:59.827364 [debug] [Thread-1 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor__dbt_tmp" rename to "dim_vendor"
[0m01:44:59.827763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:44:59.830307 [debug] [Thread-1 (]: On model.threat_risk.dim_vendor: COMMIT
[0m01:44:59.830475 [debug] [Thread-4 (]: SQL status: SELECT 641 in 0.015 seconds
[0m01:44:59.830673 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m01:44:59.832077 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_product"
[0m01:44:59.832298 [debug] [Thread-1 (]: On model.threat_risk.dim_vendor: COMMIT
[0m01:44:59.832518 [debug] [Thread-4 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product" rename to "dim_product__dbt_backup"
[0m01:44:59.833308 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:44:59.834685 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_product"
[0m01:44:59.834912 [debug] [Thread-4 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m01:44:59.835225 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:44:59.835407 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:44:59.836431 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."marts"."dim_vendor__dbt_backup"
[0m01:44:59.836574 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.021 seconds
[0m01:44:59.837078 [debug] [Thread-4 (]: On model.threat_risk.dim_product: COMMIT
[0m01:44:59.838203 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m01:44:59.840037 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m01:44:59.840526 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date" rename to "dim_date__dbt_backup"
[0m01:44:59.840375 [debug] [Thread-1 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
drop table if exists "threat_risk"."marts"."dim_vendor__dbt_backup" cascade
[0m01:44:59.840203 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_product"
[0m01:44:59.840937 [debug] [Thread-4 (]: On model.threat_risk.dim_product: COMMIT
[0m01:44:59.840847 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:44:59.842234 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m01:44:59.842586 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date__dbt_tmp" rename to "dim_date"
[0m01:44:59.842406 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m01:44:59.842794 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:44:59.842916 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:44:59.844847 [debug] [Thread-2 (]: On model.threat_risk.dim_date: COMMIT
[0m01:44:59.844360 [debug] [Thread-1 (]: On model.threat_risk.dim_vendor: Close
[0m01:44:59.843829 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."marts"."dim_product__dbt_backup"
[0m01:44:59.845527 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_product"
[0m01:44:59.845314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8452fa50>]}
[0m01:44:59.844993 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m01:44:59.845672 [debug] [Thread-4 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
drop table if exists "threat_risk"."marts"."dim_product__dbt_backup" cascade
[0m01:44:59.845954 [info ] [Thread-1 (]: 12 of 33 OK created sql table model marts.dim_vendor ........................... [[32mSELECT 251[0m in 0.06s]
[0m01:44:59.846194 [debug] [Thread-2 (]: On model.threat_risk.dim_date: COMMIT
[0m01:44:59.846543 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_vendor
[0m01:44:59.846900 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_url
[0m01:44:59.847282 [info ] [Thread-1 (]: 15 of 33 START sql table model marts.dim_url ................................... [RUN]
[0m01:44:59.847567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_vendor, now model.threat_risk.dim_url)
[0m01:44:59.847740 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m01:44:59.847852 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_url
[0m01:44:59.848830 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."marts"."dim_date__dbt_backup"
[0m01:44:59.848964 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m01:44:59.850001 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_url"
[0m01:44:59.850248 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m01:44:59.850722 [debug] [Thread-4 (]: On model.threat_risk.dim_product: Close
[0m01:44:59.851048 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
drop table if exists "threat_risk"."marts"."dim_date__dbt_backup" cascade
[0m01:44:59.851317 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8322f5d0>]}
[0m01:44:59.851449 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_url
[0m01:44:59.851768 [info ] [Thread-4 (]: 11 of 33 OK created sql table model marts.dim_product .......................... [[32mSELECT 641[0m in 0.07s]
[0m01:44:59.853148 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.dim_url"
[0m01:44:59.853289 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:44:59.853477 [debug] [Thread-4 (]: Finished running node model.threat_risk.dim_product
[0m01:44:59.854074 [debug] [Thread-2 (]: On model.threat_risk.dim_date: Close
[0m01:44:59.854286 [debug] [Thread-4 (]: Began running node model.threat_risk.fact_url_events
[0m01:44:59.854477 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m01:44:59.854745 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832544d0>]}
[0m01:44:59.855474 [info ] [Thread-2 (]: 14 of 33 OK created sql table model marts.dim_date ............................. [[32mSELECT 1[0m in 0.07s]
[0m01:44:59.855203 [debug] [Thread-1 (]: On model.threat_risk.dim_url: BEGIN
[0m01:44:59.854937 [info ] [Thread-4 (]: 16 of 33 START sql table model marts.fact_url_events ........................... [RUN]
[0m01:44:59.856063 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_product, now model.threat_risk.fact_url_events)
[0m01:44:59.855862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:59.855701 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_date
[0m01:44:59.856575 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m01:44:59.856207 [debug] [Thread-4 (]: Began compiling node model.threat_risk.fact_url_events
[0m01:44:59.856739 [info ] [Thread-2 (]: 17 of 33 START test not_null_dim_vendor_vendor_key ............................. [RUN]
[0m01:44:59.858051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_date, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m01:44:59.857832 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.fact_url_events"
[0m01:44:59.858224 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m01:44:59.860008 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m01:44:59.860375 [debug] [Thread-4 (]: Began executing node model.threat_risk.fact_url_events
[0m01:44:59.860524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m01:44:59.861742 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.fact_url_events"
[0m01:44:59.861943 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m01:44:59.862057 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m01:44:59.862338 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */

  
    

  create  table "threat_risk"."marts"."dim_url__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  url,
  host
from (
  select distinct url, host
  from "threat_risk"."staging"."stg_urlhaus"
  where url is not null
) u
  );
  
[0m01:44:59.863158 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m01:44:59.863289 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m01:44:59.863629 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: BEGIN
[0m01:44:59.864021 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:44:59.864307 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m01:44:59.864471 [debug] [Thread-3 (]: SQL status: SELECT 22369 in 0.049 seconds
[0m01:44:59.864607 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: BEGIN
[0m01:44:59.866934 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:59.866369 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m01:44:59.867225 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev" rename to "fact_kev__dbt_backup"
[0m01:44:59.867555 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m01:44:59.867751 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:44:59.867872 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m01:44:59.871191 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m01:44:59.871396 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */

  
    

  create  table "threat_risk"."marts"."fact_url_events__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  run_date as date_day,
  url_status,
  threat,
  tags,
  date_added,
  reporter,
  larted
from "threat_risk"."staging"."stg_urlhaus"
where url is not null
  );
  
[0m01:44:59.871532 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m01:44:59.871888 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m01:44:59.871656 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev__dbt_tmp" rename to "fact_kev"
[0m01:44:59.872018 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_vendor"
where vendor_key is null



      
    ) dbt_internal_test
[0m01:44:59.872323 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:44:59.872942 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: COMMIT
[0m01:44:59.873080 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:44:59.873212 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m01:44:59.873823 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: ROLLBACK
[0m01:44:59.874058 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: COMMIT
[0m01:44:59.874517 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: Close
[0m01:44:59.874854 [info ] [Thread-2 (]: 17 of 33 PASS not_null_dim_vendor_vendor_key ................................... [[32mPASS[0m in 0.02s]
[0m01:44:59.875192 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m01:44:59.875417 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m01:44:59.875659 [info ] [Thread-2 (]: 18 of 33 START test not_null_dim_vendor_vendor_project ......................... [RUN]
[0m01:44:59.875888 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m01:44:59.876105 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m01:44:59.877684 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m01:44:59.877812 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m01:44:59.879001 [debug] [Thread-3 (]: Applying DROP to: "threat_risk"."marts"."fact_kev__dbt_backup"
[0m01:44:59.879267 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m01:44:59.879392 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m01:44:59.879524 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
drop table if exists "threat_risk"."marts"."fact_kev__dbt_backup" cascade
[0m01:44:59.880357 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m01:44:59.880892 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m01:44:59.881074 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: BEGIN
[0m01:44:59.881268 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:59.882191 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:44:59.882766 [debug] [Thread-3 (]: On model.threat_risk.fact_kev: Close
[0m01:44:59.883531 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831a76d0>]}
[0m01:44:59.884525 [info ] [Thread-3 (]: 13 of 33 OK created sql table model marts.fact_kev ............................. [[32mSELECT 22369[0m in 0.09s]
[0m01:44:59.884812 [debug] [Thread-3 (]: Finished running node model.threat_risk.fact_kev
[0m01:44:59.884999 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m01:44:59.885447 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m01:44:59.885638 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m01:44:59.885346 [info ] [Thread-3 (]: 19 of 33 START test unique_dim_vendor_vendor_key ............................... [RUN]
[0m01:44:59.885966 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_kev, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m01:44:59.885801 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_vendor"
where vendor_project is null



      
    ) dbt_internal_test
[0m01:44:59.886102 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m01:44:59.888673 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m01:44:59.888804 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:44:59.889702 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: ROLLBACK
[0m01:44:59.890164 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m01:44:59.890341 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: Close
[0m01:44:59.891463 [info ] [Thread-2 (]: 18 of 33 PASS not_null_dim_vendor_vendor_project ............................... [[32mPASS[0m in 0.02s]
[0m01:44:59.891209 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m01:44:59.891747 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m01:44:59.892086 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m01:44:59.892297 [info ] [Thread-2 (]: 20 of 33 START test unique_dim_vendor_vendor_project ........................... [RUN]
[0m01:44:59.892650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m01:44:59.892480 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m01:44:59.892948 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: BEGIN
[0m01:44:59.892812 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m01:44:59.893067 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:44:59.894561 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m01:44:59.895408 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m01:44:59.897555 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m01:44:59.897997 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m01:44:59.898202 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: BEGIN
[0m01:44:59.898354 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:59.898449 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m01:44:59.898829 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m01:44:59.899043 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_key is not null
group by vendor_key
having count(*) > 1



      
    ) dbt_internal_test
[0m01:44:59.899900 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:44:59.901618 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: ROLLBACK
[0m01:44:59.901875 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m01:44:59.901974 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: Close
[0m01:44:59.902107 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m01:44:59.902539 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_project as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_project is not null
group by vendor_project
having count(*) > 1



      
    ) dbt_internal_test
[0m01:44:59.902373 [info ] [Thread-3 (]: 19 of 33 PASS unique_dim_vendor_vendor_key ..................................... [[32mPASS[0m in 0.02s]
[0m01:44:59.902797 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m01:44:59.902960 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m01:44:59.903152 [info ] [Thread-3 (]: 21 of 33 START test not_null_dim_product_product ............................... [RUN]
[0m01:44:59.903444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m01:44:59.903284 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:44:59.903990 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: ROLLBACK
[0m01:44:59.903583 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m01:44:59.904192 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: Close
[0m01:44:59.905886 [info ] [Thread-2 (]: 20 of 33 PASS unique_dim_vendor_vendor_project ................................. [[32mPASS[0m in 0.01s]
[0m01:44:59.905660 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m01:44:59.906109 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m01:44:59.906483 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m01:44:59.906741 [info ] [Thread-2 (]: 22 of 33 START test not_null_dim_product_product_key ........................... [RUN]
[0m01:44:59.906915 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m01:44:59.907927 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m01:44:59.907088 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96, now test.threat_risk.not_null_dim_product_product_key.f0e1d838d3)
[0m01:44:59.908196 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m01:44:59.909643 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m01:44:59.909833 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m01:44:59.910083 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: BEGIN
[0m01:44:59.910255 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:44:59.910390 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m01:44:59.911415 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m01:44:59.913538 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m01:44:59.913716 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m01:44:59.913915 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:59.914043 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m01:44:59.914445 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m01:44:59.914685 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product.56a877bc84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."marts"."dim_product"
where product is null



      
    ) dbt_internal_test
[0m01:44:59.916759 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:44:59.917452 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: ROLLBACK
[0m01:44:59.917724 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: Close
[0m01:44:59.917827 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m01:44:59.918177 [info ] [Thread-3 (]: 21 of 33 PASS not_null_dim_product_product ..................................... [[32mPASS[0m in 0.01s]
[0m01:44:59.918604 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m01:44:59.918836 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m01:44:59.919018 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "threat_risk"."marts"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m01:44:59.919333 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m01:44:59.919668 [info ] [Thread-3 (]: 23 of 33 START test not_null_dim_product_vendor_key ............................ [RUN]
[0m01:44:59.920059 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.not_null_dim_product_vendor_key.78836999d2)
[0m01:44:59.919931 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m01:44:59.920710 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m01:44:59.920224 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m01:44:59.920941 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: Close
[0m01:44:59.923802 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m01:44:59.924103 [info ] [Thread-2 (]: 22 of 33 PASS not_null_dim_product_product_key ................................. [[32mPASS[0m in 0.02s]
[0m01:44:59.924551 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m01:44:59.924769 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m01:44:59.925040 [info ] [Thread-2 (]: 24 of 33 START test not_null_dim_product_vendor_project ........................ [RUN]
[0m01:44:59.924914 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m01:44:59.925248 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m01:44:59.926388 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m01:44:59.926200 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m01:44:59.927936 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m01:44:59.928470 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m01:44:59.928724 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: BEGIN
[0m01:44:59.928844 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:44:59.928640 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m01:44:59.931422 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m01:44:59.931991 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m01:44:59.932319 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: BEGIN
[0m01:44:59.932144 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m01:44:59.932626 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m01:44:59.932473 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:59.932762 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_product"
where vendor_key is null



      
    ) dbt_internal_test
[0m01:44:59.933428 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m01:44:59.934616 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: ROLLBACK
[0m01:44:59.935607 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: Close
[0m01:44:59.935971 [info ] [Thread-3 (]: 23 of 33 PASS not_null_dim_product_vendor_key .................................. [[32mPASS[0m in 0.02s]
[0m01:44:59.936743 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m01:44:59.936550 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m01:44:59.937073 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m01:44:59.936919 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m01:44:59.937370 [info ] [Thread-3 (]: 25 of 33 START test unique_dim_product_product_key ............................. [RUN]
[0m01:44:59.937210 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_product"
where vendor_project is null



      
    ) dbt_internal_test
[0m01:44:59.937567 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m01:44:59.937773 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m01:44:59.939308 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m01:44:59.939414 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:44:59.940045 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: ROLLBACK
[0m01:44:59.940326 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m01:44:59.940510 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: Close
[0m01:44:59.941674 [info ] [Thread-2 (]: 24 of 33 PASS not_null_dim_product_vendor_project .............................. [[32mPASS[0m in 0.02s]
[0m01:44:59.941411 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m01:44:59.941954 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m01:44:59.942329 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m01:44:59.942595 [info ] [Thread-2 (]: 26 of 33 START test not_null_fact_kev_cve_id ................................... [RUN]
[0m01:44:59.943036 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m01:44:59.942840 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m01:44:59.943387 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: BEGIN
[0m01:44:59.943231 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m01:44:59.943515 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:44:59.944981 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m01:44:59.945709 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m01:44:59.946610 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m01:44:59.947082 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m01:44:59.947318 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: BEGIN
[0m01:44:59.947505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:59.948801 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m01:44:59.950028 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m01:44:59.950213 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m01:44:59.950634 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m01:44:59.950828 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m01:44:59.950986 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."marts"."fact_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m01:44:59.951119 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m01:44:59.952079 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m01:44:59.952497 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: Close
[0m01:44:59.952859 [info ] [Thread-3 (]: 25 of 33 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.02s]
[0m01:44:59.953235 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m01:44:59.953537 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m01:44:59.953844 [info ] [Thread-3 (]: 27 of 33 START test not_null_fact_kev_date_day ................................. [RUN]
[0m01:44:59.954119 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_product_product_key.1753236bd0, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m01:44:59.954284 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m01:44:59.956167 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m01:44:59.956298 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:44:59.956999 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: ROLLBACK
[0m01:44:59.957223 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m01:44:59.957309 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: Close
[0m01:44:59.958431 [info ] [Thread-2 (]: 26 of 33 PASS not_null_fact_kev_cve_id ......................................... [[32mPASS[0m in 0.02s]
[0m01:44:59.958197 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m01:44:59.958713 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m01:44:59.959226 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m01:44:59.959387 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: BEGIN
[0m01:44:59.959516 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:44:59.962764 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m01:44:59.962957 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m01:44:59.963134 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_kev"
where date_day is null



      
    ) dbt_internal_test
[0m01:44:59.965222 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:44:59.965803 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: ROLLBACK
[0m01:44:59.966028 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: Close
[0m01:44:59.966286 [info ] [Thread-3 (]: 27 of 33 PASS not_null_fact_kev_date_day ....................................... [[32mPASS[0m in 0.01s]
[0m01:44:59.966577 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m01:44:59.997008 [debug] [Thread-1 (]: SQL status: SELECT 42277 in 0.134 seconds
[0m01:44:59.998406 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m01:44:59.998599 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url" rename to "dim_url__dbt_backup"
[0m01:44:59.999008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:44:59.999953 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m01:45:00.000126 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url__dbt_tmp" rename to "dim_url"
[0m01:45:00.000435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:45:00.000910 [debug] [Thread-1 (]: On model.threat_risk.dim_url: COMMIT
[0m01:45:00.001079 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m01:45:00.001244 [debug] [Thread-1 (]: On model.threat_risk.dim_url: COMMIT
[0m01:45:00.010104 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m01:45:00.012297 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."marts"."dim_url__dbt_backup"
[0m01:45:00.012522 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m01:45:00.012656 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
drop table if exists "threat_risk"."marts"."dim_url__dbt_backup" cascade
[0m01:45:00.014283 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m01:45:00.014769 [debug] [Thread-1 (]: On model.threat_risk.dim_url: Close
[0m01:45:00.015018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808480d0>]}
[0m01:45:00.015273 [info ] [Thread-1 (]: 15 of 33 OK created sql table model marts.dim_url .............................. [[32mSELECT 42277[0m in 0.17s]
[0m01:45:00.015516 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_url
[0m01:45:00.015828 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m01:45:00.015959 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m01:45:00.016086 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m01:45:00.016243 [info ] [Thread-2 (]: 28 of 33 START test not_null_dim_url_url ....................................... [RUN]
[0m01:45:00.016448 [info ] [Thread-3 (]: 29 of 33 START test not_null_dim_url_url_key ................................... [RUN]
[0m01:45:00.017080 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_date_day.64362f7a33, now test.threat_risk.not_null_dim_url_url_key.89914b0872)
[0m01:45:00.016916 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8, now test.threat_risk.not_null_dim_url_url.2b67971659)
[0m01:45:00.016681 [info ] [Thread-1 (]: 30 of 33 START test unique_dim_url_url ......................................... [RUN]
[0m01:45:00.017226 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m01:45:00.017368 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_url_url.2b67971659
[0m01:45:00.017544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_url, now test.threat_risk.unique_dim_url_url.4c561dc36d)
[0m01:45:00.019105 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m01:45:00.020430 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m01:45:00.020628 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m01:45:00.022441 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m01:45:00.022687 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_url_url.2b67971659
[0m01:45:00.022829 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m01:45:00.023656 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m01:45:00.023815 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m01:45:00.024550 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m01:45:00.025463 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m01:45:00.025739 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m01:45:00.026020 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: BEGIN
[0m01:45:00.026303 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:45:00.026159 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m01:45:00.026467 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m01:45:00.026806 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: BEGIN
[0m01:45:00.026661 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: BEGIN
[0m01:45:00.026966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:00.027109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:45:00.032147 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m01:45:00.032311 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m01:45:00.032457 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url.2b67971659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."dim_url"
where url is null



      
    ) dbt_internal_test
[0m01:45:00.033746 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m01:45:00.033913 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m01:45:00.034063 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url_key.89914b0872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."dim_url"
where url_key is null



      
    ) dbt_internal_test
[0m01:45:00.034610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m01:45:00.034811 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m01:45:00.034998 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url.4c561dc36d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m01:45:00.035286 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m01:45:00.035937 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: ROLLBACK
[0m01:45:00.036070 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:45:00.036271 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: Close
[0m01:45:00.036679 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: ROLLBACK
[0m01:45:00.036958 [info ] [Thread-2 (]: 28 of 33 PASS not_null_dim_url_url ............................................. [[32mPASS[0m in 0.02s]
[0m01:45:00.037226 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: Close
[0m01:45:00.037413 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m01:45:00.037664 [info ] [Thread-3 (]: 29 of 33 PASS not_null_dim_url_url_key ......................................... [[32mPASS[0m in 0.02s]
[0m01:45:00.037881 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m01:45:00.038106 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m01:45:00.038304 [info ] [Thread-2 (]: 31 of 33 START test unique_dim_url_url_key ..................................... [RUN]
[0m01:45:00.038658 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url.2b67971659, now test.threat_risk.unique_dim_url_url_key.d67ee5b979)
[0m01:45:00.038810 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m01:45:00.040638 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m01:45:00.041371 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m01:45:00.042187 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m01:45:00.042625 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m01:45:00.042779 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: BEGIN
[0m01:45:00.042922 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:45:00.044509 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m01:45:00.045964 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: ROLLBACK
[0m01:45:00.046368 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m01:45:00.046765 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m01:45:00.046611 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: Close
[0m01:45:00.046956 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url_key.d67ee5b979"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url_key is not null
group by url_key
having count(*) > 1



      
    ) dbt_internal_test
[0m01:45:00.047260 [info ] [Thread-1 (]: 30 of 33 PASS unique_dim_url_url ............................................... [[32mPASS[0m in 0.03s]
[0m01:45:00.047665 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m01:45:00.058565 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m01:45:00.059450 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: ROLLBACK
[0m01:45:00.059914 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: Close
[0m01:45:00.060355 [info ] [Thread-2 (]: 31 of 33 PASS unique_dim_url_url_key ........................................... [[32mPASS[0m in 0.02s]
[0m01:45:00.060687 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m01:45:00.182719 [debug] [Thread-4 (]: SQL status: SELECT 218717 in 0.311 seconds
[0m01:45:00.184543 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m01:45:00.184744 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events" rename to "fact_url_events__dbt_backup"
[0m01:45:00.185129 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:45:00.186069 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m01:45:00.186250 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events__dbt_tmp" rename to "fact_url_events"
[0m01:45:00.186573 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:45:00.187035 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: COMMIT
[0m01:45:00.187214 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m01:45:00.187397 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: COMMIT
[0m01:45:00.191452 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m01:45:00.192385 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."marts"."fact_url_events__dbt_backup"
[0m01:45:00.192644 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m01:45:00.192931 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
drop table if exists "threat_risk"."marts"."fact_url_events__dbt_backup" cascade
[0m01:45:00.194558 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m01:45:00.195079 [debug] [Thread-4 (]: On model.threat_risk.fact_url_events: Close
[0m01:45:00.195394 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c7c0b62-7dce-4585-8a03-4b5edaccf1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83134450>]}
[0m01:45:00.195702 [info ] [Thread-4 (]: 16 of 33 OK created sql table model marts.fact_url_events ...................... [[32mSELECT 218717[0m in 0.34s]
[0m01:45:00.196164 [debug] [Thread-4 (]: Finished running node model.threat_risk.fact_url_events
[0m01:45:00.196730 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m01:45:00.196855 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m01:45:00.196999 [info ] [Thread-3 (]: 32 of 33 START test not_null_fact_url_events_date_day .......................... [RUN]
[0m01:45:00.197191 [info ] [Thread-1 (]: 33 of 33 START test not_null_fact_url_events_url_key ........................... [RUN]
[0m01:45:00.197424 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url_key.89914b0872, now test.threat_risk.not_null_fact_url_events_date_day.d658eee263)
[0m01:45:00.197618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_url_url.4c561dc36d, now test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d)
[0m01:45:00.197792 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m01:45:00.197940 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m01:45:00.200585 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m01:45:00.201941 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m01:45:00.202662 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m01:45:00.202806 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m01:45:00.203589 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m01:45:00.204357 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m01:45:00.204910 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m01:45:00.205195 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: BEGIN
[0m01:45:00.205332 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:45:00.205099 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m01:45:00.205660 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: BEGIN
[0m01:45:00.205940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:00.208744 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m01:45:00.208895 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m01:45:00.209033 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_url_events"
where date_day is null



      
    ) dbt_internal_test
[0m01:45:00.209846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m01:45:00.210032 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m01:45:00.210236 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."fact_url_events"
where url_key is null



      
    ) dbt_internal_test
[0m01:45:00.230199 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m01:45:00.230364 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.021 seconds
[0m01:45:00.230961 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: ROLLBACK
[0m01:45:00.231414 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: ROLLBACK
[0m01:45:00.231653 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: Close
[0m01:45:00.232048 [info ] [Thread-1 (]: 33 of 33 PASS not_null_fact_url_events_url_key ................................. [[32mPASS[0m in 0.03s]
[0m01:45:00.231812 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: Close
[0m01:45:00.232728 [info ] [Thread-3 (]: 32 of 33 PASS not_null_fact_url_events_date_day ................................ [[32mPASS[0m in 0.04s]
[0m01:45:00.232469 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m01:45:00.233106 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m01:45:00.234232 [debug] [MainThread]: Using postgres connection "master"
[0m01:45:00.234408 [debug] [MainThread]: On master: BEGIN
[0m01:45:00.234551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:45:00.237778 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:45:00.237945 [debug] [MainThread]: On master: COMMIT
[0m01:45:00.238083 [debug] [MainThread]: Using postgres connection "master"
[0m01:45:00.238235 [debug] [MainThread]: On master: COMMIT
[0m01:45:00.238453 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:45:00.238587 [debug] [MainThread]: On master: Close
[0m01:45:00.238769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:00.238929 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d' was properly closed.
[0m01:45:00.239074 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url_key.d67ee5b979' was properly closed.
[0m01:45:00.239218 [debug] [MainThread]: Connection 'model.threat_risk.fact_url_events' was properly closed.
[0m01:45:00.239371 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_date_day.d658eee263' was properly closed.
[0m01:45:00.239582 [info ] [MainThread]: 
[0m01:45:00.239755 [info ] [MainThread]: Finished running 2 view models, 25 data tests, 6 table models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m01:45:00.241107 [debug] [MainThread]: Command end result
[0m01:45:00.256808 [info ] [MainThread]: 
[0m01:45:00.257221 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:45:00.257392 [info ] [MainThread]: 
[0m01:45:00.257570 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 TOTAL=33
[0m01:45:00.258007 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.9444995, "process_user_time": 0.987881, "process_kernel_time": 0.099193, "process_mem_max_rss": "123636", "process_out_blocks": "4058", "process_in_blocks": "0"}
[0m01:45:00.258246 [debug] [MainThread]: Command `dbt build` succeeded at 01:45:00.258208 after 0.94 seconds
[0m01:45:00.258409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a670d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a670410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6713d0>]}
[0m01:45:00.258761 [debug] [MainThread]: Flushing usage events
[0m02:11:39.920501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80da3d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80bbd390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80bbe950>]}


============================== 02:11:39.923596 | 7b979a90-e148-4efe-b0a4-bc1ad4ced415 ==============================
[0m02:11:39.923596 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:11:39.923912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:11:39.974057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80bf9750>]}
[0m02:11:39.991281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a25c50>]}
[0m02:11:39.991733 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:11:40.013711 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:11:40.059368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m02:11:40.059703 [debug] [MainThread]: Partial parsing: added file: threat_risk://models/staging/stg_urlhaus_events.sql
[0m02:11:40.059872 [debug] [MainThread]: Partial parsing: added file: threat_risk://models/marts/fct_urlhaus_threat_events.yml
[0m02:11:40.060003 [debug] [MainThread]: Partial parsing: added file: threat_risk://models/marts/fct_urlhaus_threat_events.sql
[0m02:11:40.060126 [debug] [MainThread]: Partial parsing: added file: threat_risk://models/sources/sources_raw.yml
[0m02:11:40.136438 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:11:40.136816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e01f7d0>]}
[0m02:11:40.223387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df6f5d0>]}
[0m02:11:40.271948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd88150>]}
[0m02:11:40.272232 [info ] [MainThread]: Found 10 models, 33 data tests, 1 source, 429 macros
[0m02:11:40.274011 [info ] [MainThread]: 
[0m02:11:40.274327 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:11:40.276101 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m02:11:40.276344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m02:11:40.314072 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m02:11:40.314246 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m02:11:40.314456 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m02:11:40.314681 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m02:11:40.314910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:40.315105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:40.321718 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m02:11:40.321853 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m02:11:40.322354 [debug] [ThreadPool]: On list_threat_risk: Close
[0m02:11:40.322889 [debug] [ThreadPool]: On list_threat_risk: Close
[0m02:11:40.323991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_marts)
[0m02:11:40.324309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_staging)
[0m02:11:40.326410 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m02:11:40.327117 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m02:11:40.327324 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m02:11:40.327529 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m02:11:40.327867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:11:40.328034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:11:40.331720 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:11:40.331921 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m02:11:40.332096 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m02:11:40.332920 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.333108 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m02:11:40.333276 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m02:11:40.334504 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m02:11:40.335094 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m02:11:40.335201 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m02:11:40.335448 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m02:11:40.335793 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m02:11:40.336564 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m02:11:40.338634 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:40.338815 [debug] [MainThread]: On master: BEGIN
[0m02:11:40.338957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:11:40.342051 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:11:40.342234 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:40.342434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:11:40.344999 [debug] [MainThread]: SQL status: SELECT 4 in 0.002 seconds
[0m02:11:40.345474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0fd650>]}
[0m02:11:40.345701 [debug] [MainThread]: On master: ROLLBACK
[0m02:11:40.345902 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:40.346040 [debug] [MainThread]: On master: BEGIN
[0m02:11:40.346299 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:11:40.346465 [debug] [MainThread]: On master: COMMIT
[0m02:11:40.346603 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:40.346736 [debug] [MainThread]: On master: COMMIT
[0m02:11:40.346925 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:11:40.347054 [debug] [MainThread]: On master: Close
[0m02:11:40.347254 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:11:40.347515 [info ] [MainThread]: 
[0m02:11:40.351305 [debug] [Thread-1 (]: Began running node model.threat_risk.stg_kev
[0m02:11:40.351461 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_urlhaus
[0m02:11:40.351598 [debug] [Thread-3 (]: Began running node test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26
[0m02:11:40.351762 [debug] [Thread-4 (]: Began running node test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3
[0m02:11:40.351940 [info ] [Thread-1 (]: 1 of 43 START sql view model staging.stg_kev ................................... [RUN]
[0m02:11:40.352308 [info ] [Thread-2 (]: 2 of 43 START sql view model staging.stg_urlhaus ............................... [RUN]
[0m02:11:40.352640 [info ] [Thread-3 (]: 3 of 43 START test source_not_null_raw_urlhaus_events_event_id ................. [RUN]
[0m02:11:40.352922 [info ] [Thread-4 (]: 4 of 43 START test source_not_null_raw_urlhaus_events_ingested_at .............. [RUN]
[0m02:11:40.353213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now model.threat_risk.stg_kev)
[0m02:11:40.353520 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now model.threat_risk.stg_urlhaus)
[0m02:11:40.353774 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26'
[0m02:11:40.354030 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3'
[0m02:11:40.354231 [debug] [Thread-1 (]: Began compiling node model.threat_risk.stg_kev
[0m02:11:40.354465 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_urlhaus
[0m02:11:40.354694 [debug] [Thread-3 (]: Began compiling node test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26
[0m02:11:40.354891 [debug] [Thread-4 (]: Began compiling node test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3
[0m02:11:40.357206 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.stg_kev"
[0m02:11:40.357894 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus"
[0m02:11:40.362440 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"
[0m02:11:40.363842 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"
[0m02:11:40.366191 [debug] [Thread-1 (]: Began executing node model.threat_risk.stg_kev
[0m02:11:40.366367 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_urlhaus
[0m02:11:40.378145 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.stg_kev"
[0m02:11:40.379448 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.stg_urlhaus"
[0m02:11:40.379776 [debug] [Thread-3 (]: Began executing node test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26
[0m02:11:40.379988 [debug] [Thread-4 (]: Began executing node test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3
[0m02:11:40.385359 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"
[0m02:11:40.385674 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m02:11:40.386512 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"
[0m02:11:40.386672 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m02:11:40.386987 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: BEGIN
[0m02:11:40.387312 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: BEGIN
[0m02:11:40.387591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:40.388077 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:40.388339 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"
[0m02:11:40.388500 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"
[0m02:11:40.389020 [debug] [Thread-3 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26: BEGIN
[0m02:11:40.389374 [debug] [Thread-4 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3: BEGIN
[0m02:11:40.389828 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:11:40.390350 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:11:40.393376 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.393740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:40.393900 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m02:11:40.394151 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m02:11:40.394407 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */

  create view "threat_risk"."staging"."stg_urlhaus__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.urlhaus_recent
),
clean as (
  select
    nullif(trim(url), '') as url,
    nullif(trim(url_status), '') as url_status,
    nullif(trim(host), '') as host,
    date_added,
    nullif(trim(threat), '') as threat,
    nullif(trim(tags), '') as tags,
    nullif(trim(urlhaus_link), '') as urlhaus_link,
    nullif(trim(reporter), '') as reporter,
    larted,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m02:11:40.394639 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */

  create view "threat_risk"."staging"."stg_kev__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.kev
),
clean as (
  select
    nullif(trim(cve_id), '') as cve_id,
    nullif(trim(vendor_project), '') as vendor_project,
    nullif(trim(product), '') as product,
    nullif(trim(vulnerability_name), '') as vulnerability_name,
    date_added,
    short_description,
    required_action,
    due_date,
    notes,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m02:11:40.395305 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.395680 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"
[0m02:11:40.396027 [debug] [Thread-3 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "threat_risk"."raw"."urlhaus_events"
where event_id is null



      
    ) dbt_internal_test
[0m02:11:40.396199 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:40.396498 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"
[0m02:11:40.396736 [debug] [Thread-4 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingested_at
from "threat_risk"."raw"."urlhaus_events"
where ingested_at is null



      
    ) dbt_internal_test
[0m02:11:40.397446 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:40.399398 [debug] [Thread-3 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26: ROLLBACK
[0m02:11:40.399544 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m02:11:40.399683 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m02:11:40.399827 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:11:40.400067 [debug] [Thread-3 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26: Close
[0m02:11:40.402746 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m02:11:40.404245 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m02:11:40.404857 [debug] [Thread-4 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3: ROLLBACK
[0m02:11:40.405377 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus" rename to "stg_urlhaus__dbt_backup"
[0m02:11:40.405219 [info ] [Thread-3 (]: 3 of 43 PASS source_not_null_raw_urlhaus_events_event_id ....................... [[32mPASS[0m in 0.05s]
[0m02:11:40.405718 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev" rename to "stg_kev__dbt_backup"
[0m02:11:40.406040 [debug] [Thread-4 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3: Close
[0m02:11:40.406849 [info ] [Thread-4 (]: 4 of 43 PASS source_not_null_raw_urlhaus_events_ingested_at .................... [[32mPASS[0m in 0.05s]
[0m02:11:40.406353 [debug] [Thread-3 (]: Finished running node test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26
[0m02:11:40.407477 [debug] [Thread-3 (]: Began running node test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67
[0m02:11:40.407193 [debug] [Thread-4 (]: Finished running node test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3
[0m02:11:40.408037 [debug] [Thread-4 (]: Began running node test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286
[0m02:11:40.407770 [info ] [Thread-3 (]: 5 of 43 START test source_not_null_raw_urlhaus_events_source ................... [RUN]
[0m02:11:40.409052 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26, now test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67)
[0m02:11:40.408640 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m02:11:40.408800 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m02:11:40.408435 [info ] [Thread-4 (]: 6 of 43 START test source_unique_raw_urlhaus_events_event_id ................... [RUN]
[0m02:11:40.413105 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3, now test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286)
[0m02:11:40.410703 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m02:11:40.412817 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m02:11:40.409287 [debug] [Thread-3 (]: Began compiling node test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67
[0m02:11:40.413336 [debug] [Thread-4 (]: Began compiling node test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286
[0m02:11:40.413626 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus__dbt_tmp" rename to "stg_urlhaus"
[0m02:11:40.413938 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev__dbt_tmp" rename to "stg_kev"
[0m02:11:40.415797 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"
[0m02:11:40.418155 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"
[0m02:11:40.418858 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.419057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.425005 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m02:11:40.426416 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m02:11:40.426020 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m02:11:40.426265 [debug] [Thread-3 (]: Began executing node test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67
[0m02:11:40.425373 [debug] [Thread-4 (]: Began executing node test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286
[0m02:11:40.426557 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m02:11:40.426712 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m02:11:40.427788 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"
[0m02:11:40.428694 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"
[0m02:11:40.428960 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m02:11:40.429340 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m02:11:40.432183 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."staging"."stg_urlhaus__dbt_backup"
[0m02:11:40.432367 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m02:11:40.432547 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"
[0m02:11:40.434399 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m02:11:40.434563 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"
[0m02:11:40.436104 [debug] [Thread-4 (]: On test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286: BEGIN
[0m02:11:40.435660 [debug] [Thread-3 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67: BEGIN
[0m02:11:40.435865 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
drop view if exists "threat_risk"."staging"."stg_urlhaus__dbt_backup" cascade
[0m02:11:40.435470 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."staging"."stg_kev__dbt_backup"
[0m02:11:40.436745 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m02:11:40.436412 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.436258 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:40.436934 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
drop view if exists "threat_risk"."staging"."stg_kev__dbt_backup" cascade
[0m02:11:40.438002 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m02:11:40.438697 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: Close
[0m02:11:40.440067 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb99750>]}
[0m02:11:40.438840 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m02:11:40.440446 [info ] [Thread-2 (]: 2 of 43 OK created sql view model staging.stg_urlhaus .......................... [[32mCREATE VIEW[0m in 0.09s]
[0m02:11:40.441117 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: Close
[0m02:11:40.441473 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_urlhaus
[0m02:11:40.441637 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.442274 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:40.442099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7de4db50>]}
[0m02:11:40.442737 [debug] [Thread-2 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m02:11:40.442886 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"
[0m02:11:40.443090 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"
[0m02:11:40.443393 [info ] [Thread-1 (]: 1 of 43 OK created sql view model staging.stg_kev .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m02:11:40.443670 [info ] [Thread-2 (]: 7 of 43 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m02:11:40.444005 [debug] [Thread-3 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select source
from "threat_risk"."raw"."urlhaus_events"
where source is null



      
    ) dbt_internal_test
[0m02:11:40.444260 [debug] [Thread-4 (]: On test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "threat_risk"."raw"."urlhaus_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:40.444537 [debug] [Thread-1 (]: Finished running node model.threat_risk.stg_kev
[0m02:11:40.444769 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus, now test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41)
[0m02:11:40.445358 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m02:11:40.445722 [debug] [Thread-2 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m02:11:40.445994 [info ] [Thread-1 (]: 8 of 43 START test not_null_stg_urlhaus_run_date ............................... [RUN]
[0m02:11:40.450678 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m02:11:40.451121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_kev, now test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93)
[0m02:11:40.451418 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m02:11:40.451675 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m02:11:40.452745 [debug] [Thread-3 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67: ROLLBACK
[0m02:11:40.452940 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m02:11:40.454642 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m02:11:40.454820 [debug] [Thread-2 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m02:11:40.455462 [debug] [Thread-4 (]: On test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286: ROLLBACK
[0m02:11:40.455599 [debug] [Thread-3 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67: Close
[0m02:11:40.457034 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m02:11:40.457375 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m02:11:40.457651 [debug] [Thread-4 (]: On test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286: Close
[0m02:11:40.457910 [info ] [Thread-3 (]: 5 of 43 PASS source_not_null_raw_urlhaus_events_source ......................... [[32mPASS[0m in 0.05s]
[0m02:11:40.460297 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m02:11:40.460796 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m02:11:40.461077 [info ] [Thread-4 (]: 6 of 43 PASS source_unique_raw_urlhaus_events_event_id ......................... [[32mPASS[0m in 0.05s]
[0m02:11:40.461455 [debug] [Thread-3 (]: Finished running node test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67
[0m02:11:40.461908 [debug] [Thread-2 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m02:11:40.462188 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m02:11:40.462404 [debug] [Thread-4 (]: Finished running node test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286
[0m02:11:40.462621 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m02:11:40.462832 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:40.463006 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m02:11:40.463284 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m02:11:40.463704 [info ] [Thread-3 (]: 9 of 43 START test not_null_stg_urlhaus_url .................................... [RUN]
[0m02:11:40.464265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:40.464522 [info ] [Thread-4 (]: 10 of 43 START test not_null_stg_urlhaus_url_status ............................ [RUN]
[0m02:11:40.464876 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m02:11:40.465332 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m02:11:40.466530 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m02:11:40.466319 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m02:11:40.468583 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m02:11:40.470308 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m02:11:40.470523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:40.470670 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m02:11:40.471250 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m02:11:40.471430 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m02:11:40.471683 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m02:11:40.471820 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m02:11:40.474120 [debug] [Thread-2 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m02:11:40.473067 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m02:11:40.473922 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m02:11:40.472074 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m02:11:40.474744 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m02:11:40.474965 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m02:11:40.475309 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:40.475191 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m02:11:40.475705 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m02:11:40.476016 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.480953 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:40.481297 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m02:11:40.481606 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m02:11:40.481441 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.481883 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m02:11:40.482056 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m02:11:40.499000 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m02:11:40.499242 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.025 seconds
[0m02:11:40.500038 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m02:11:40.500805 [debug] [Thread-2 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m02:11:40.501308 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m02:11:40.501586 [debug] [Thread-2 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m02:11:40.501893 [info ] [Thread-1 (]: 8 of 43 PASS not_null_stg_urlhaus_run_date ..................................... [[32mPASS[0m in 0.05s]
[0m02:11:40.502324 [info ] [Thread-2 (]: 7 of 43 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown .. [[32mPASS[0m in 0.06s]
[0m02:11:40.502527 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m02:11:40.502954 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m02:11:40.503284 [debug] [Thread-2 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m02:11:40.503991 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m02:11:40.504311 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m02:11:40.504638 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m02:11:40.504984 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m02:11:40.505123 [info ] [Thread-1 (]: 11 of 43 START test not_null_stg_kev_cve_id .................................... [RUN]
[0m02:11:40.505340 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.023 seconds
[0m02:11:40.505575 [info ] [Thread-2 (]: 12 of 43 START test not_null_stg_kev_product ................................... [RUN]
[0m02:11:40.505963 [info ] [Thread-4 (]: 10 of 43 PASS not_null_stg_urlhaus_url_status .................................. [[32mPASS[0m in 0.04s]
[0m02:11:40.506218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0)
[0m02:11:40.506806 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m02:11:40.507042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now test.threat_risk.not_null_stg_kev_product.9b2d2b4877)
[0m02:11:40.507329 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m02:11:40.507554 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m02:11:40.507853 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m02:11:40.508075 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m02:11:40.508325 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m02:11:40.510216 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m02:11:40.510728 [info ] [Thread-3 (]: 9 of 43 PASS not_null_stg_urlhaus_url .......................................... [[32mPASS[0m in 0.05s]
[0m02:11:40.512661 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m02:11:40.512924 [info ] [Thread-4 (]: 13 of 43 START test not_null_stg_kev_run_date .................................. [RUN]
[0m02:11:40.513712 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m02:11:40.514054 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m02:11:40.514314 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m02:11:40.514541 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m02:11:40.514708 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m02:11:40.515821 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m02:11:40.516092 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m02:11:40.517034 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m02:11:40.517233 [info ] [Thread-3 (]: 14 of 43 START test not_null_stg_kev_vendor_project ............................ [RUN]
[0m02:11:40.519040 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m02:11:40.519373 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m02:11:40.520091 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m02:11:40.519808 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m02:11:40.519579 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m02:11:40.520266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:40.520458 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m02:11:40.520600 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m02:11:40.520750 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m02:11:40.521823 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m02:11:40.522320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:40.524063 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m02:11:40.524779 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m02:11:40.525175 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m02:11:40.525392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.525714 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m02:11:40.526010 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:40.526213 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m02:11:40.528330 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m02:11:40.528636 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:40.528892 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m02:11:40.529298 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m02:11:40.531071 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m02:11:40.531787 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m02:11:40.531684 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:40.531441 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m02:11:40.531984 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.532189 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m02:11:40.532660 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m02:11:40.536158 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:40.536666 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m02:11:40.536857 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m02:11:40.539172 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m02:11:40.539339 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m02:11:40.539473 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m02:11:40.540270 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m02:11:40.540857 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m02:11:40.541446 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m02:11:40.541596 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m02:11:40.541869 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m02:11:40.542013 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m02:11:40.542653 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m02:11:40.542784 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m02:11:40.543147 [info ] [Thread-4 (]: 13 of 43 PASS not_null_stg_kev_run_date ........................................ [[32mPASS[0m in 0.03s]
[0m02:11:40.543454 [info ] [Thread-2 (]: 12 of 43 PASS not_null_stg_kev_product ......................................... [[32mPASS[0m in 0.04s]
[0m02:11:40.543990 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m02:11:40.544326 [info ] [Thread-1 (]: 11 of 43 PASS not_null_stg_kev_cve_id .......................................... [[32mPASS[0m in 0.04s]
[0m02:11:40.544683 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m02:11:40.544960 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m02:11:40.545262 [info ] [Thread-3 (]: 14 of 43 PASS not_null_stg_kev_vendor_project .................................. [[32mPASS[0m in 0.03s]
[0m02:11:40.545565 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m02:11:40.545870 [debug] [Thread-4 (]: Began running node model.threat_risk.stg_urlhaus_events
[0m02:11:40.546149 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_url
[0m02:11:40.546517 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m02:11:40.546770 [debug] [Thread-1 (]: Began running node model.threat_risk.fact_url_events
[0m02:11:40.547071 [info ] [Thread-4 (]: 15 of 43 START sql view model staging.stg_urlhaus_events ....................... [RUN]
[0m02:11:40.547349 [info ] [Thread-2 (]: 16 of 43 START sql table model marts.dim_url ................................... [RUN]
[0m02:11:40.548697 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now model.threat_risk.dim_url)
[0m02:11:40.548024 [info ] [Thread-1 (]: 17 of 43 START sql table model marts.fact_url_events ........................... [RUN]
[0m02:11:40.548432 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now model.threat_risk.stg_urlhaus_events)
[0m02:11:40.547760 [debug] [Thread-3 (]: Began running node model.threat_risk.dim_date
[0m02:11:40.549548 [info ] [Thread-3 (]: 18 of 43 START sql table model marts.dim_date .................................. [RUN]
[0m02:11:40.549093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now model.threat_risk.fact_url_events)
[0m02:11:40.549324 [debug] [Thread-4 (]: Began compiling node model.threat_risk.stg_urlhaus_events
[0m02:11:40.548863 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_url
[0m02:11:40.549792 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now model.threat_risk.dim_date)
[0m02:11:40.550022 [debug] [Thread-1 (]: Began compiling node model.threat_risk.fact_url_events
[0m02:11:40.551606 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus_events"
[0m02:11:40.553253 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_url"
[0m02:11:40.553528 [debug] [Thread-3 (]: Began compiling node model.threat_risk.dim_date
[0m02:11:40.554696 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.fact_url_events"
[0m02:11:40.556266 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.dim_date"
[0m02:11:40.556495 [debug] [Thread-4 (]: Began executing node model.threat_risk.stg_urlhaus_events
[0m02:11:40.556987 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_url
[0m02:11:40.557350 [debug] [Thread-1 (]: Began executing node model.threat_risk.fact_url_events
[0m02:11:40.558916 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.stg_urlhaus_events"
[0m02:11:40.559184 [debug] [Thread-3 (]: Began executing node model.threat_risk.dim_date
[0m02:11:40.567464 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.dim_url"
[0m02:11:40.569089 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.fact_url_events"
[0m02:11:40.570735 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.dim_date"
[0m02:11:40.571379 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus_events"
[0m02:11:40.572025 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_url"
[0m02:11:40.572191 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus_events: BEGIN
[0m02:11:40.572477 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m02:11:40.572627 [debug] [Thread-2 (]: On model.threat_risk.dim_url: BEGIN
[0m02:11:40.572783 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_date"
[0m02:11:40.572914 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:40.573071 [debug] [Thread-1 (]: On model.threat_risk.fact_url_events: BEGIN
[0m02:11:40.573219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:40.573361 [debug] [Thread-3 (]: On model.threat_risk.dim_date: BEGIN
[0m02:11:40.573974 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.573681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:40.579726 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:40.579967 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m02:11:40.580143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:40.580375 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m02:11:40.580494 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_date"
[0m02:11:40.580728 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_url"
[0m02:11:40.580979 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m02:11:40.581182 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus_events"
[0m02:11:40.582088 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus_events"} */

  create view "threat_risk"."staging"."stg_urlhaus_events__dbt_tmp"
    
    
  as (
    

with src as (
  select
    event_id,
    event_time,
    ingested_at,
    source,
    url,
    feed,
    payload,
    _consumer_ingested_at,
    _kafka_topic,
    _kafka_partition,
    _kafka_offset,
    inserted_at
  from "threat_risk"."raw"."urlhaus_events"
)

select
  event_id,
  event_time,
  ingested_at,
  source,
  url,
  feed,
  payload,
  inserted_at
from src
  );
[0m02:11:40.581644 [debug] [Thread-2 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */

  
    

  create  table "threat_risk"."marts"."dim_url__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  url,
  host
from (
  select distinct url, host
  from "threat_risk"."staging"."stg_urlhaus"
  where url is not null
) u
  );
  
[0m02:11:40.581885 [debug] [Thread-1 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */

  
    

  create  table "threat_risk"."marts"."fact_url_events__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  run_date as date_day,
  url_status,
  threat,
  tags,
  date_added,
  reporter,
  larted
from "threat_risk"."staging"."stg_urlhaus"
where url is not null
  );
  
[0m02:11:40.581432 [debug] [Thread-3 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */

  
    

  create  table "threat_risk"."marts"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with dates as (
  select distinct run_date as d from "threat_risk"."staging"."stg_kev"
  union
  select distinct run_date as d from "threat_risk"."staging"."stg_urlhaus"
),
final as (
  select
    d as date_day,
    extract(year from d)::int as year,
    extract(month from d)::int as month,
    extract(day from d)::int as day
  from dates
)
select * from final
  );
  
[0m02:11:40.583504 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m02:11:40.585056 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus_events"
[0m02:11:40.585314 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus_events"} */
alter table "threat_risk"."staging"."stg_urlhaus_events__dbt_tmp" rename to "stg_urlhaus_events"
[0m02:11:40.585861 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.586493 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus_events: COMMIT
[0m02:11:40.586674 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus_events"
[0m02:11:40.586827 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus_events: COMMIT
[0m02:11:40.587518 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m02:11:40.588771 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."staging"."stg_urlhaus_events__dbt_backup"
[0m02:11:40.589110 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.stg_urlhaus_events"
[0m02:11:40.589317 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus_events"} */
drop view if exists "threat_risk"."staging"."stg_urlhaus_events__dbt_backup" cascade
[0m02:11:40.589611 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:11:40.590205 [debug] [Thread-4 (]: On model.threat_risk.stg_urlhaus_events: Close
[0m02:11:40.590508 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca49010>]}
[0m02:11:40.590794 [info ] [Thread-4 (]: 15 of 43 OK created sql view model staging.stg_urlhaus_events .................. [[32mCREATE VIEW[0m in 0.04s]
[0m02:11:40.591143 [debug] [Thread-4 (]: Finished running node model.threat_risk.stg_urlhaus_events
[0m02:11:40.591551 [debug] [Thread-4 (]: Began running node model.threat_risk.dim_product
[0m02:11:40.591883 [info ] [Thread-4 (]: 19 of 43 START sql table model marts.dim_product ............................... [RUN]
[0m02:11:40.592290 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus_events, now model.threat_risk.dim_product)
[0m02:11:40.592493 [debug] [Thread-4 (]: Began compiling node model.threat_risk.dim_product
[0m02:11:40.594945 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.dim_product"
[0m02:11:40.595599 [debug] [Thread-4 (]: Began executing node model.threat_risk.dim_product
[0m02:11:40.597111 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.dim_product"
[0m02:11:40.597563 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_product"
[0m02:11:40.597711 [debug] [Thread-4 (]: On model.threat_risk.dim_product: BEGIN
[0m02:11:40.597862 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:40.601637 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:40.601948 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_product"
[0m02:11:40.601790 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m02:11:40.602096 [debug] [Thread-4 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */

  
    

  create  table "threat_risk"."marts"."dim_product__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  md5(coalesce(vendor_project,'')) as vendor_key,
  vendor_project,
  product
from (
  select distinct vendor_project, product
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null and product is not null
) p
  );
  
[0m02:11:40.603394 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_date"
[0m02:11:40.603614 [debug] [Thread-3 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date" rename to "dim_date__dbt_backup"
[0m02:11:40.603941 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.605022 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_date"
[0m02:11:40.605194 [debug] [Thread-3 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date__dbt_tmp" rename to "dim_date"
[0m02:11:40.605523 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.607997 [debug] [Thread-3 (]: On model.threat_risk.dim_date: COMMIT
[0m02:11:40.608185 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_date"
[0m02:11:40.608334 [debug] [Thread-3 (]: On model.threat_risk.dim_date: COMMIT
[0m02:11:40.615844 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m02:11:40.617285 [debug] [Thread-3 (]: Applying DROP to: "threat_risk"."marts"."dim_date__dbt_backup"
[0m02:11:40.618576 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_date"
[0m02:11:40.618760 [debug] [Thread-3 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
drop table if exists "threat_risk"."marts"."dim_date__dbt_backup" cascade
[0m02:11:40.618962 [debug] [Thread-4 (]: SQL status: SELECT 641 in 0.015 seconds
[0m02:11:40.620468 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_product"
[0m02:11:40.620749 [debug] [Thread-4 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product" rename to "dim_product__dbt_backup"
[0m02:11:40.620590 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:11:40.621410 [debug] [Thread-3 (]: On model.threat_risk.dim_date: Close
[0m02:11:40.621511 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:11:40.621786 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca78390>]}
[0m02:11:40.622943 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_product"
[0m02:11:40.623463 [debug] [Thread-4 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m02:11:40.623216 [info ] [Thread-3 (]: 18 of 43 OK created sql table model marts.dim_date ............................. [[32mSELECT 1[0m in 0.07s]
[0m02:11:40.623872 [debug] [Thread-3 (]: Finished running node model.threat_risk.dim_date
[0m02:11:40.624009 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.624851 [debug] [Thread-4 (]: On model.threat_risk.dim_product: COMMIT
[0m02:11:40.624183 [debug] [Thread-3 (]: Began running node model.threat_risk.dim_vendor
[0m02:11:40.625005 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_product"
[0m02:11:40.625364 [debug] [Thread-4 (]: On model.threat_risk.dim_product: COMMIT
[0m02:11:40.625190 [info ] [Thread-3 (]: 20 of 43 START sql table model marts.dim_vendor ................................ [RUN]
[0m02:11:40.625747 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_date, now model.threat_risk.dim_vendor)
[0m02:11:40.625953 [debug] [Thread-3 (]: Began compiling node model.threat_risk.dim_vendor
[0m02:11:40.627181 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.dim_vendor"
[0m02:11:40.627309 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m02:11:40.628270 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."marts"."dim_product__dbt_backup"
[0m02:11:40.628516 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.dim_product"
[0m02:11:40.628646 [debug] [Thread-3 (]: Began executing node model.threat_risk.dim_vendor
[0m02:11:40.628781 [debug] [Thread-4 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
drop table if exists "threat_risk"."marts"."dim_product__dbt_backup" cascade
[0m02:11:40.629836 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.dim_vendor"
[0m02:11:40.630293 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m02:11:40.630569 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: BEGIN
[0m02:11:40.630745 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.631734 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:11:40.632522 [debug] [Thread-4 (]: On model.threat_risk.dim_product: Close
[0m02:11:40.633570 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c14bed0>]}
[0m02:11:40.634173 [info ] [Thread-4 (]: 19 of 43 OK created sql table model marts.dim_product .......................... [[32mSELECT 641[0m in 0.04s]
[0m02:11:40.634578 [debug] [Thread-4 (]: Finished running node model.threat_risk.dim_product
[0m02:11:40.634896 [debug] [Thread-4 (]: Began running node model.threat_risk.fact_kev
[0m02:11:40.635097 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:40.635673 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m02:11:40.635397 [info ] [Thread-4 (]: 21 of 43 START sql table model marts.fact_kev .................................. [RUN]
[0m02:11:40.635849 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */

  
    

  create  table "threat_risk"."marts"."dim_vendor__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project, '')) as vendor_key,
  vendor_project
from (
  select distinct vendor_project
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null
) v
  );
  
[0m02:11:40.636073 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_product, now model.threat_risk.fact_kev)
[0m02:11:40.636501 [debug] [Thread-4 (]: Began compiling node model.threat_risk.fact_kev
[0m02:11:40.637918 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.fact_kev"
[0m02:11:40.638420 [debug] [Thread-4 (]: Began executing node model.threat_risk.fact_kev
[0m02:11:40.640737 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.fact_kev"
[0m02:11:40.641155 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m02:11:40.641318 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: BEGIN
[0m02:11:40.641457 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:40.644908 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m02:11:40.645122 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m02:11:40.645273 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */

  
    

  create  table "threat_risk"."marts"."fact_kev__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(cve_id,'')) as cve_key,
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  run_date as date_day,
  cve_id,
  vulnerability_name,
  date_added,
  due_date,
  required_action,
  notes
from "threat_risk"."staging"."stg_kev"
where cve_id is not null
  );
  
[0m02:11:40.645389 [debug] [Thread-3 (]: SQL status: SELECT 251 in 0.009 seconds
[0m02:11:40.646748 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m02:11:40.646926 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor" rename to "dim_vendor__dbt_backup"
[0m02:11:40.647290 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.648714 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m02:11:40.648969 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor__dbt_tmp" rename to "dim_vendor"
[0m02:11:40.649521 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.650202 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: COMMIT
[0m02:11:40.650406 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m02:11:40.650562 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: COMMIT
[0m02:11:40.656806 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m02:11:40.657881 [debug] [Thread-3 (]: Applying DROP to: "threat_risk"."marts"."dim_vendor__dbt_backup"
[0m02:11:40.658247 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m02:11:40.658459 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
drop table if exists "threat_risk"."marts"."dim_vendor__dbt_backup" cascade
[0m02:11:40.661370 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:11:40.662038 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: Close
[0m02:11:40.662397 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c152950>]}
[0m02:11:40.662689 [info ] [Thread-3 (]: 20 of 43 OK created sql table model marts.dim_vendor ........................... [[32mSELECT 251[0m in 0.04s]
[0m02:11:40.663020 [debug] [Thread-3 (]: Finished running node model.threat_risk.dim_vendor
[0m02:11:40.663337 [debug] [Thread-3 (]: Began running node model.threat_risk.fct_urlhaus_threat_events
[0m02:11:40.663714 [info ] [Thread-3 (]: 22 of 43 START sql incremental model marts.fct_urlhaus_threat_events ........... [RUN]
[0m02:11:40.663993 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_vendor, now model.threat_risk.fct_urlhaus_threat_events)
[0m02:11:40.664193 [debug] [Thread-3 (]: Began compiling node model.threat_risk.fct_urlhaus_threat_events
[0m02:11:40.665919 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:40.666450 [debug] [Thread-3 (]: Began executing node model.threat_risk.fct_urlhaus_threat_events
[0m02:11:40.678974 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:40.679809 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:40.679960 [debug] [Thread-3 (]: On model.threat_risk.fct_urlhaus_threat_events: BEGIN
[0m02:11:40.680160 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.683904 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:40.684166 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:40.684424 [debug] [Thread-3 (]: On model.threat_risk.fct_urlhaus_threat_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fct_urlhaus_threat_events"} */

      
  
    

  create  table "threat_risk"."marts"."fct_urlhaus_threat_events"
  
  
    as
  
  (
    

with base as (
  select
    event_id,
    event_time,
    ingested_at,
    source,
    url,
    feed
  from "threat_risk"."staging"."stg_urlhaus_events"

  
)

select * from base
  );
  
  
[0m02:11:40.708424 [debug] [Thread-3 (]: SQL status: SELECT 20403 in 0.024 seconds
[0m02:11:40.709340 [debug] [Thread-3 (]: On model.threat_risk.fct_urlhaus_threat_events: COMMIT
[0m02:11:40.709606 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:40.709860 [debug] [Thread-3 (]: On model.threat_risk.fct_urlhaus_threat_events: COMMIT
[0m02:11:40.715198 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m02:11:40.715528 [debug] [Thread-3 (]: On model.threat_risk.fct_urlhaus_threat_events: Close
[0m02:11:40.715775 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df4de50>]}
[0m02:11:40.716193 [info ] [Thread-3 (]: 22 of 43 OK created sql incremental model marts.fct_urlhaus_threat_events ...... [[32mSELECT 20403[0m in 0.05s]
[0m02:11:40.716558 [debug] [Thread-3 (]: Finished running node model.threat_risk.fct_urlhaus_threat_events
[0m02:11:40.716871 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m02:11:40.717190 [info ] [Thread-3 (]: 23 of 43 START test not_null_dim_product_product ............................... [RUN]
[0m02:11:40.717524 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.fct_urlhaus_threat_events, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m02:11:40.717759 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m02:11:40.719507 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m02:11:40.720403 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m02:11:40.721383 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m02:11:40.721882 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m02:11:40.722055 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: BEGIN
[0m02:11:40.722187 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.726013 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:40.726254 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m02:11:40.726432 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product.56a877bc84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."marts"."dim_product"
where product is null



      
    ) dbt_internal_test
[0m02:11:40.727142 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:40.727842 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: ROLLBACK
[0m02:11:40.728084 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: Close
[0m02:11:40.728380 [info ] [Thread-3 (]: 23 of 43 PASS not_null_dim_product_product ..................................... [[32mPASS[0m in 0.01s]
[0m02:11:40.728708 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m02:11:40.728946 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m02:11:40.729196 [info ] [Thread-3 (]: 24 of 43 START test not_null_dim_product_product_key ........................... [RUN]
[0m02:11:40.729565 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.not_null_dim_product_product_key.f0e1d838d3)
[0m02:11:40.729739 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m02:11:40.731721 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m02:11:40.732215 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m02:11:40.733181 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m02:11:40.733682 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m02:11:40.733903 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m02:11:40.734077 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.735015 [debug] [Thread-4 (]: SQL status: SELECT 23893 in 0.089 seconds
[0m02:11:40.738408 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m02:11:40.738650 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev" rename to "fact_kev__dbt_backup"
[0m02:11:40.738759 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.739012 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m02:11:40.739300 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "threat_risk"."marts"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m02:11:40.739157 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.740461 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m02:11:40.740565 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:40.740710 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev__dbt_tmp" rename to "fact_kev"
[0m02:11:40.741322 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m02:11:40.741669 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: Close
[0m02:11:40.742080 [info ] [Thread-3 (]: 24 of 43 PASS not_null_dim_product_product_key ................................. [[32mPASS[0m in 0.01s]
[0m02:11:40.741816 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.743012 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: COMMIT
[0m02:11:40.742362 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m02:11:40.743186 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m02:11:40.743566 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m02:11:40.743931 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: COMMIT
[0m02:11:40.744136 [info ] [Thread-3 (]: 25 of 43 START test not_null_dim_product_vendor_key ............................ [RUN]
[0m02:11:40.744627 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.not_null_dim_product_vendor_key.78836999d2)
[0m02:11:40.744832 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m02:11:40.746676 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m02:11:40.747137 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m02:11:40.748619 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m02:11:40.749059 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m02:11:40.749267 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: BEGIN
[0m02:11:40.749423 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.753153 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:40.753431 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m02:11:40.753596 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_product"
where vendor_key is null



      
    ) dbt_internal_test
[0m02:11:40.754209 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m02:11:40.754883 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: ROLLBACK
[0m02:11:40.755073 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: Close
[0m02:11:40.755426 [info ] [Thread-3 (]: 25 of 43 PASS not_null_dim_product_vendor_key .................................. [[32mPASS[0m in 0.01s]
[0m02:11:40.755757 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m02:11:40.756066 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m02:11:40.756284 [info ] [Thread-3 (]: 26 of 43 START test not_null_dim_product_vendor_project ........................ [RUN]
[0m02:11:40.756624 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m02:11:40.756422 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m02:11:40.756771 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m02:11:40.757792 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."marts"."fact_kev__dbt_backup"
[0m02:11:40.759847 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m02:11:40.759534 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m02:11:40.759999 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
drop table if exists "threat_risk"."marts"."fact_kev__dbt_backup" cascade
[0m02:11:40.760451 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m02:11:40.761450 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m02:11:40.761580 [debug] [Thread-2 (]: SQL status: SELECT 42290 in 0.179 seconds
[0m02:11:40.763129 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_url"
[0m02:11:40.763274 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:11:40.764004 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: Close
[0m02:11:40.763541 [debug] [Thread-2 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url" rename to "dim_url__dbt_backup"
[0m02:11:40.763447 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m02:11:40.764294 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c190a50>]}
[0m02:11:40.764604 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: BEGIN
[0m02:11:40.764754 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.764987 [info ] [Thread-4 (]: 21 of 43 OK created sql table model marts.fact_kev ............................. [[32mSELECT 23893[0m in 0.13s]
[0m02:11:40.765210 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.766326 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_url"
[0m02:11:40.766867 [debug] [Thread-2 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url__dbt_tmp" rename to "dim_url"
[0m02:11:40.766553 [debug] [Thread-4 (]: Finished running node model.threat_risk.fact_kev
[0m02:11:40.767177 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m02:11:40.767755 [info ] [Thread-4 (]: 27 of 43 START test unique_dim_product_product_key ............................. [RUN]
[0m02:11:40.767971 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_kev, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m02:11:40.767618 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:11:40.768800 [debug] [Thread-2 (]: On model.threat_risk.dim_url: COMMIT
[0m02:11:40.768177 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m02:11:40.769007 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_url"
[0m02:11:40.770945 [debug] [Thread-2 (]: On model.threat_risk.dim_url: COMMIT
[0m02:11:40.770753 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m02:11:40.771064 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:40.771494 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m02:11:40.771827 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m02:11:40.771956 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_product"
where vendor_project is null



      
    ) dbt_internal_test
[0m02:11:40.772138 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m02:11:40.773143 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m02:11:40.774281 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."marts"."dim_url__dbt_backup"
[0m02:11:40.774429 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:40.774802 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_url"
[0m02:11:40.775484 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: ROLLBACK
[0m02:11:40.775627 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m02:11:40.775786 [debug] [Thread-2 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
drop table if exists "threat_risk"."marts"."dim_url__dbt_backup" cascade
[0m02:11:40.776055 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: Close
[0m02:11:40.776148 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: BEGIN
[0m02:11:40.776538 [info ] [Thread-3 (]: 26 of 43 PASS not_null_dim_product_vendor_project .............................. [[32mPASS[0m in 0.02s]
[0m02:11:40.776775 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:40.777050 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m02:11:40.777520 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m02:11:40.777770 [info ] [Thread-3 (]: 28 of 43 START test not_null_dim_vendor_vendor_key ............................. [RUN]
[0m02:11:40.778135 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m02:11:40.777920 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:11:40.778914 [debug] [Thread-2 (]: On model.threat_risk.dim_url: Close
[0m02:11:40.778359 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m02:11:40.779174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca68710>]}
[0m02:11:40.781955 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m02:11:40.782272 [info ] [Thread-2 (]: 16 of 43 OK created sql table model marts.dim_url .............................. [[32mSELECT 42290[0m in 0.23s]
[0m02:11:40.782425 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:40.783123 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_url
[0m02:11:40.783381 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m02:11:40.784680 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:40.784343 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m02:11:40.784097 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m02:11:40.784941 [info ] [Thread-2 (]: 29 of 43 START test not_null_dim_vendor_vendor_project ......................... [RUN]
[0m02:11:40.786302 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_url, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m02:11:40.786121 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:40.785981 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m02:11:40.786443 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m02:11:40.787042 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m02:11:40.788742 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m02:11:40.788971 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m02:11:40.789077 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: Close
[0m02:11:40.789275 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: BEGIN
[0m02:11:40.789660 [info ] [Thread-4 (]: 27 of 43 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.02s]
[0m02:11:40.789849 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m02:11:40.790043 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.790325 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m02:11:40.791257 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m02:11:40.791626 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m02:11:40.792055 [info ] [Thread-4 (]: 30 of 43 START test unique_dim_vendor_vendor_key ............................... [RUN]
[0m02:11:40.792370 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_product_product_key.1753236bd0, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m02:11:40.792630 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m02:11:40.792763 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m02:11:40.793538 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: BEGIN
[0m02:11:40.795945 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m02:11:40.796165 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:40.796301 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:40.796900 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m02:11:40.797134 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_vendor"
where vendor_key is null



      
    ) dbt_internal_test
[0m02:11:40.797284 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m02:11:40.798307 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m02:11:40.798418 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:40.799128 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: ROLLBACK
[0m02:11:40.799386 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m02:11:40.799589 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: Close
[0m02:11:40.799682 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: BEGIN
[0m02:11:40.800316 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:40.799975 [info ] [Thread-3 (]: 28 of 43 PASS not_null_dim_vendor_vendor_key ................................... [[32mPASS[0m in 0.02s]
[0m02:11:40.800440 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:40.800912 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m02:11:40.801099 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m02:11:40.801511 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_vendor"
where vendor_project is null



      
    ) dbt_internal_test
[0m02:11:40.801308 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m02:11:40.801752 [info ] [Thread-3 (]: 31 of 43 START test unique_dim_vendor_vendor_project ........................... [RUN]
[0m02:11:40.802041 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m02:11:40.803350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m02:11:40.803969 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: ROLLBACK
[0m02:11:40.804161 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m02:11:40.804350 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:40.804525 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: Close
[0m02:11:40.806045 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m02:11:40.806199 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m02:11:40.806464 [info ] [Thread-2 (]: 29 of 43 PASS not_null_dim_vendor_vendor_project ............................... [[32mPASS[0m in 0.02s]
[0m02:11:40.806867 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_key is not null
group by vendor_key
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:40.807124 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m02:11:40.807533 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb
[0m02:11:40.807269 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m02:11:40.807750 [info ] [Thread-2 (]: 32 of 43 START test not_null_fct_urlhaus_threat_events_event_id ................ [RUN]
[0m02:11:40.809594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb)
[0m02:11:40.809367 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:11:40.809157 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m02:11:40.809752 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb
[0m02:11:40.810425 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: ROLLBACK
[0m02:11:40.812307 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"
[0m02:11:40.812680 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m02:11:40.812803 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: Close
[0m02:11:40.813041 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: BEGIN
[0m02:11:40.813551 [info ] [Thread-4 (]: 30 of 43 PASS unique_dim_vendor_vendor_key ..................................... [[32mPASS[0m in 0.02s]
[0m02:11:40.813965 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.814271 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb
[0m02:11:40.814480 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m02:11:40.815883 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"
[0m02:11:40.817735 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125
[0m02:11:40.818182 [info ] [Thread-4 (]: 33 of 43 START test not_null_fct_urlhaus_threat_events_ingested_at ............. [RUN]
[0m02:11:40.818677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68, now test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125)
[0m02:11:40.818888 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.819514 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m02:11:40.819386 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"
[0m02:11:40.819179 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125
[0m02:11:40.819679 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_project as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_project is not null
group by vendor_project
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:40.819858 [debug] [Thread-2 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb: BEGIN
[0m02:11:40.821577 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"
[0m02:11:40.821927 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:40.822656 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:40.822861 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125
[0m02:11:40.825109 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: ROLLBACK
[0m02:11:40.826117 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"
[0m02:11:40.826362 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: Close
[0m02:11:40.826508 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.826769 [info ] [Thread-3 (]: 31 of 43 PASS unique_dim_vendor_vendor_project ................................. [[32mPASS[0m in 0.02s]
[0m02:11:40.827025 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"
[0m02:11:40.827773 [debug] [Thread-2 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "threat_risk"."marts"."fct_urlhaus_threat_events"
where event_id is null



      
    ) dbt_internal_test
[0m02:11:40.827520 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m02:11:40.827345 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"
[0m02:11:40.828071 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b
[0m02:11:40.828334 [debug] [Thread-4 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125: BEGIN
[0m02:11:40.828562 [info ] [Thread-3 (]: 34 of 43 START test not_null_fct_urlhaus_threat_events_url ..................... [RUN]
[0m02:11:40.828873 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:40.829115 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96, now test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b)
[0m02:11:40.829432 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b
[0m02:11:40.832408 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"
[0m02:11:40.832550 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m02:11:40.832845 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:40.833642 [debug] [Thread-2 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb: ROLLBACK
[0m02:11:40.834135 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"
[0m02:11:40.834293 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b
[0m02:11:40.834592 [debug] [Thread-2 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb: Close
[0m02:11:40.834738 [debug] [Thread-4 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingested_at
from "threat_risk"."marts"."fct_urlhaus_threat_events"
where ingested_at is null



      
    ) dbt_internal_test
[0m02:11:40.835862 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"
[0m02:11:40.836169 [info ] [Thread-2 (]: 32 of 43 PASS not_null_fct_urlhaus_threat_events_event_id ...................... [[32mPASS[0m in 0.03s]
[0m02:11:40.836750 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb
[0m02:11:40.837189 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4
[0m02:11:40.837423 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"
[0m02:11:40.837984 [debug] [Thread-3 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b: BEGIN
[0m02:11:40.837763 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:40.837591 [info ] [Thread-2 (]: 35 of 43 START test unique_fct_urlhaus_threat_events_event_id .................. [RUN]
[0m02:11:40.838960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb, now test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4)
[0m02:11:40.838737 [debug] [Thread-4 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125: ROLLBACK
[0m02:11:40.838134 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.839109 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4
[0m02:11:40.839411 [debug] [Thread-4 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125: Close
[0m02:11:40.842677 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"
[0m02:11:40.843001 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.843333 [info ] [Thread-4 (]: 33 of 43 PASS not_null_fct_urlhaus_threat_events_ingested_at ................... [[32mPASS[0m in 0.02s]
[0m02:11:40.843682 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"
[0m02:11:40.844106 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125
[0m02:11:40.844313 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4
[0m02:11:40.844542 [debug] [Thread-3 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."fct_urlhaus_threat_events"
where url is null



      
    ) dbt_internal_test
[0m02:11:40.844876 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m02:11:40.846039 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"
[0m02:11:40.846401 [info ] [Thread-4 (]: 36 of 43 START test not_null_fact_kev_cve_id ................................... [RUN]
[0m02:11:40.846935 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m02:11:40.847182 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m02:11:40.847401 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"
[0m02:11:40.849084 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m02:11:40.849275 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:11:40.849514 [debug] [Thread-2 (]: On test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4: BEGIN
[0m02:11:40.850427 [debug] [Thread-3 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b: ROLLBACK
[0m02:11:40.850667 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:40.850857 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m02:11:40.851245 [debug] [Thread-3 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b: Close
[0m02:11:40.852676 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m02:11:40.855254 [info ] [Thread-3 (]: 34 of 43 PASS not_null_fct_urlhaus_threat_events_url ........................... [[32mPASS[0m in 0.03s]
[0m02:11:40.855687 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.855916 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b
[0m02:11:40.856161 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"
[0m02:11:40.856311 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m02:11:40.856514 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m02:11:40.857108 [info ] [Thread-3 (]: 37 of 43 START test not_null_fact_kev_date_day ................................. [RUN]
[0m02:11:40.856925 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: BEGIN
[0m02:11:40.856725 [debug] [Thread-2 (]: On test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."fct_urlhaus_threat_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:40.857348 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m02:11:40.857556 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:40.857805 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m02:11:40.860011 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m02:11:40.860538 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m02:11:40.861542 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m02:11:40.861841 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:40.862033 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m02:11:40.862338 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."marts"."fact_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m02:11:40.862171 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m02:11:40.862555 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: BEGIN
[0m02:11:40.862692 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.863574 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m02:11:40.864290 [debug] [Thread-2 (]: On test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4: ROLLBACK
[0m02:11:40.864587 [debug] [Thread-2 (]: On test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4: Close
[0m02:11:40.864876 [info ] [Thread-2 (]: 35 of 43 PASS unique_fct_urlhaus_threat_events_event_id ........................ [[32mPASS[0m in 0.03s]
[0m02:11:40.865261 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4
[0m02:11:40.865527 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m02:11:40.865775 [info ] [Thread-2 (]: 38 of 43 START test not_null_dim_url_url ....................................... [RUN]
[0m02:11:40.866094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4, now test.threat_risk.not_null_dim_url_url.2b67971659)
[0m02:11:40.866371 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_url_url.2b67971659
[0m02:11:40.866530 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:40.866640 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:11:40.868429 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m02:11:40.868627 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m02:11:40.869816 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_kev"
where date_day is null



      
    ) dbt_internal_test
[0m02:11:40.869213 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: ROLLBACK
[0m02:11:40.870260 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_url_url.2b67971659
[0m02:11:40.870420 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: Close
[0m02:11:40.871800 [info ] [Thread-4 (]: 36 of 43 PASS not_null_fact_kev_cve_id ......................................... [[32mPASS[0m in 0.02s]
[0m02:11:40.871461 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m02:11:40.872140 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m02:11:40.872535 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m02:11:40.872723 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:11:40.872903 [info ] [Thread-4 (]: 39 of 43 START test not_null_dim_url_url_key ................................... [RUN]
[0m02:11:40.873186 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m02:11:40.873819 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: ROLLBACK
[0m02:11:40.874061 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8, now test.threat_risk.not_null_dim_url_url_key.89914b0872)
[0m02:11:40.874273 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: BEGIN
[0m02:11:40.874513 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m02:11:40.874625 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: Close
[0m02:11:40.874810 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:40.876537 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m02:11:40.876933 [info ] [Thread-3 (]: 37 of 43 PASS not_null_fact_kev_date_day ....................................... [[32mPASS[0m in 0.02s]
[0m02:11:40.877574 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m02:11:40.877828 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m02:11:40.878305 [info ] [Thread-3 (]: 40 of 43 START test unique_dim_url_url ......................................... [RUN]
[0m02:11:40.877991 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m02:11:40.878576 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_date_day.64362f7a33, now test.threat_risk.unique_dim_url_url.4c561dc36d)
[0m02:11:40.879794 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m02:11:40.879609 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m02:11:40.882728 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m02:11:40.883078 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m02:11:40.883396 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m02:11:40.883586 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m02:11:40.884109 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: BEGIN
[0m02:11:40.883950 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m02:11:40.883815 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url.2b67971659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."dim_url"
where url is null



      
    ) dbt_internal_test
[0m02:11:40.884266 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:40.885194 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m02:11:40.886409 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m02:11:40.886678 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: BEGIN
[0m02:11:40.888370 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:40.888515 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:11:40.889329 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: ROLLBACK
[0m02:11:40.889602 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.889844 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m02:11:40.889716 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: Close
[0m02:11:40.889992 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url_key.89914b0872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."dim_url"
where url_key is null



      
    ) dbt_internal_test
[0m02:11:40.890272 [info ] [Thread-2 (]: 38 of 43 PASS not_null_dim_url_url ............................................. [[32mPASS[0m in 0.02s]
[0m02:11:40.890728 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m02:11:40.890964 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m02:11:40.891174 [info ] [Thread-2 (]: 41 of 43 START test unique_dim_url_url_key ..................................... [RUN]
[0m02:11:40.891449 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url.2b67971659, now test.threat_risk.unique_dim_url_url_key.d67ee5b979)
[0m02:11:40.891648 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m02:11:40.893398 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m02:11:40.893575 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:11:40.893722 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:40.894424 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: ROLLBACK
[0m02:11:40.894673 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m02:11:40.895211 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m02:11:40.895510 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: Close
[0m02:11:40.895633 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url.4c561dc36d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:40.896739 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m02:11:40.897042 [info ] [Thread-4 (]: 39 of 43 PASS not_null_dim_url_url_key ......................................... [[32mPASS[0m in 0.02s]
[0m02:11:40.897645 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m02:11:40.897912 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m02:11:40.898172 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: BEGIN
[0m02:11:40.898351 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:40.901851 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m02:11:40.902292 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m02:11:40.902518 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url_key.d67ee5b979"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url_key is not null
group by url_key
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:40.916802 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m02:11:40.917593 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: ROLLBACK
[0m02:11:40.917878 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: Close
[0m02:11:40.918205 [info ] [Thread-3 (]: 40 of 43 PASS unique_dim_url_url ............................................... [[32mPASS[0m in 0.04s]
[0m02:11:40.918518 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m02:11:40.920136 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.017 seconds
[0m02:11:40.920686 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: ROLLBACK
[0m02:11:40.920930 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: Close
[0m02:11:40.921192 [info ] [Thread-2 (]: 41 of 43 PASS unique_dim_url_url_key ........................................... [[32mPASS[0m in 0.03s]
[0m02:11:40.921592 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m02:11:40.982679 [debug] [Thread-1 (]: SQL status: SELECT 239122 in 0.400 seconds
[0m02:11:40.984093 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m02:11:40.984301 [debug] [Thread-1 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events" rename to "fact_url_events__dbt_backup"
[0m02:11:40.984792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.985909 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m02:11:40.986116 [debug] [Thread-1 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events__dbt_tmp" rename to "fact_url_events"
[0m02:11:40.986450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:40.986963 [debug] [Thread-1 (]: On model.threat_risk.fact_url_events: COMMIT
[0m02:11:40.987146 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m02:11:40.987327 [debug] [Thread-1 (]: On model.threat_risk.fact_url_events: COMMIT
[0m02:11:40.990906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m02:11:40.991826 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."marts"."fact_url_events__dbt_backup"
[0m02:11:40.992169 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m02:11:40.992380 [debug] [Thread-1 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
drop table if exists "threat_risk"."marts"."fact_url_events__dbt_backup" cascade
[0m02:11:40.995323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:11:40.995841 [debug] [Thread-1 (]: On model.threat_risk.fact_url_events: Close
[0m02:11:40.996132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b979a90-e148-4efe-b0a4-bc1ad4ced415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cadb950>]}
[0m02:11:40.996432 [info ] [Thread-1 (]: 17 of 43 OK created sql table model marts.fact_url_events ...................... [[32mSELECT 239122[0m in 0.45s]
[0m02:11:40.996725 [debug] [Thread-1 (]: Finished running node model.threat_risk.fact_url_events
[0m02:11:40.997220 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m02:11:40.997388 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m02:11:40.997557 [info ] [Thread-4 (]: 42 of 43 START test not_null_fact_url_events_date_day .......................... [RUN]
[0m02:11:40.997874 [info ] [Thread-3 (]: 43 of 43 START test not_null_fact_url_events_url_key ........................... [RUN]
[0m02:11:40.998132 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url_key.89914b0872, now test.threat_risk.not_null_fact_url_events_date_day.d658eee263)
[0m02:11:40.998318 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_url_url.4c561dc36d, now test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d)
[0m02:11:40.998495 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m02:11:40.998675 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m02:11:41.000347 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m02:11:41.001685 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m02:11:41.002252 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m02:11:41.002388 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m02:11:41.004088 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m02:11:41.003286 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m02:11:41.004681 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m02:11:41.004963 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: BEGIN
[0m02:11:41.005097 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:41.004850 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m02:11:41.005395 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: BEGIN
[0m02:11:41.005655 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:41.008883 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m02:11:41.009034 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m02:11:41.009178 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_url_events"
where date_day is null



      
    ) dbt_internal_test
[0m02:11:41.009430 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:41.009594 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m02:11:41.009751 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."fact_url_events"
where url_key is null



      
    ) dbt_internal_test
[0m02:11:41.029958 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m02:11:41.030129 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.020 seconds
[0m02:11:41.030721 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: ROLLBACK
[0m02:11:41.031193 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: ROLLBACK
[0m02:11:41.031463 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: Close
[0m02:11:41.031864 [info ] [Thread-4 (]: 42 of 43 PASS not_null_fact_url_events_date_day ................................ [[32mPASS[0m in 0.03s]
[0m02:11:41.031616 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: Close
[0m02:11:41.032537 [info ] [Thread-3 (]: 43 of 43 PASS not_null_fact_url_events_url_key ................................. [[32mPASS[0m in 0.03s]
[0m02:11:41.032177 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m02:11:41.032901 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m02:11:41.033944 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:41.034125 [debug] [MainThread]: On master: BEGIN
[0m02:11:41.034298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:11:41.037574 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:11:41.037751 [debug] [MainThread]: On master: COMMIT
[0m02:11:41.037897 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:41.038032 [debug] [MainThread]: On master: COMMIT
[0m02:11:41.038237 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:11:41.038383 [debug] [MainThread]: On master: Close
[0m02:11:41.038573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:11:41.038726 [debug] [MainThread]: Connection 'model.threat_risk.fact_url_events' was properly closed.
[0m02:11:41.038908 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url_key.d67ee5b979' was properly closed.
[0m02:11:41.039057 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d' was properly closed.
[0m02:11:41.039202 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_date_day.d658eee263' was properly closed.
[0m02:11:41.039431 [info ] [MainThread]: 
[0m02:11:41.039692 [info ] [MainThread]: Finished running 33 data tests, 3 view models, 6 table models, 1 incremental model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m02:11:41.041603 [debug] [MainThread]: Command end result
[0m02:11:41.059682 [info ] [MainThread]: 
[0m02:11:41.059924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:11:41.060154 [info ] [MainThread]: 
[0m02:11:41.060428 [info ] [MainThread]: Done. PASS=43 WARN=0 ERROR=0 SKIP=0 TOTAL=43
[0m02:11:41.060901 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.1584698, "process_user_time": 1.335539, "process_kernel_time": 0.145695, "process_mem_max_rss": "129824", "process_out_blocks": "5209", "process_in_blocks": "0"}
[0m02:11:41.061105 [debug] [MainThread]: Command `dbt build` succeeded at 02:11:41.061073 after 1.16 seconds
[0m02:11:41.061268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80bbee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80bbd4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80da3e10>]}
[0m02:11:41.061419 [debug] [MainThread]: Flushing usage events
[0m02:11:57.432113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d7ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8edfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa933cb90>]}


============================== 02:11:57.434497 | 29b5aed9-a3ea-466f-b1c9-cf790e8672f2 ==============================
[0m02:11:57.434497 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:11:57.434817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/logs', 'version_check': 'True', 'profiles_dir': '/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m02:11:57.480903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7fcdc50>]}
[0m02:11:57.497211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c25c50>]}
[0m02:11:57.497676 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:11:57.518208 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:11:57.565093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:11:57.565286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:11:57.580660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8dd0d90>]}
[0m02:11:57.628626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7917fd0>]}
[0m02:11:57.628895 [info ] [MainThread]: Found 10 models, 33 data tests, 1 source, 429 macros
[0m02:11:57.630631 [info ] [MainThread]: 
[0m02:11:57.631013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:11:57.632808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m02:11:57.633067 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk'
[0m02:11:57.647205 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m02:11:57.647371 [debug] [ThreadPool]: Using postgres connection "list_threat_risk"
[0m02:11:57.647567 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m02:11:57.647792 [debug] [ThreadPool]: On list_threat_risk: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk"} */

    select distinct nspname from pg_namespace
  
[0m02:11:57.647978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:57.648167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:57.653694 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m02:11:57.653825 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m02:11:57.654322 [debug] [ThreadPool]: On list_threat_risk: Close
[0m02:11:57.654860 [debug] [ThreadPool]: On list_threat_risk: Close
[0m02:11:57.655925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_staging)
[0m02:11:57.656158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_threat_risk, now list_threat_risk_marts)
[0m02:11:57.658333 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m02:11:57.659106 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m02:11:57.659292 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m02:11:57.659466 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m02:11:57.659635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:11:57.659802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:11:57.663479 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:11:57.663710 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m02:11:57.663850 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:11:57.664019 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m02:11:57.664207 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m02:11:57.664493 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m02:11:57.666047 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m02:11:57.666583 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m02:11:57.666699 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m02:11:57.666951 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m02:11:57.667295 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m02:11:57.667893 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m02:11:57.670100 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:57.670275 [debug] [MainThread]: On master: BEGIN
[0m02:11:57.670451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:11:57.673556 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:11:57.673728 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:57.673914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:11:57.676495 [debug] [MainThread]: SQL status: SELECT 5 in 0.002 seconds
[0m02:11:57.676976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa791da90>]}
[0m02:11:57.677221 [debug] [MainThread]: On master: ROLLBACK
[0m02:11:57.677425 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:57.677571 [debug] [MainThread]: On master: BEGIN
[0m02:11:57.677845 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:11:57.678012 [debug] [MainThread]: On master: COMMIT
[0m02:11:57.678152 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:57.678287 [debug] [MainThread]: On master: COMMIT
[0m02:11:57.678480 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:11:57.678634 [debug] [MainThread]: On master: Close
[0m02:11:57.678839 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:11:57.679027 [info ] [MainThread]: 
[0m02:11:57.682848 [debug] [Thread-1 (]: Began running node model.threat_risk.stg_kev
[0m02:11:57.683008 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_urlhaus
[0m02:11:57.683152 [debug] [Thread-3 (]: Began running node test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26
[0m02:11:57.683305 [debug] [Thread-4 (]: Began running node test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3
[0m02:11:57.683501 [info ] [Thread-1 (]: 1 of 43 START sql view model staging.stg_kev ................................... [RUN]
[0m02:11:57.683917 [info ] [Thread-2 (]: 2 of 43 START sql view model staging.stg_urlhaus ............................... [RUN]
[0m02:11:57.684216 [info ] [Thread-3 (]: 3 of 43 START test source_not_null_raw_urlhaus_events_event_id ................. [RUN]
[0m02:11:57.684616 [info ] [Thread-4 (]: 4 of 43 START test source_not_null_raw_urlhaus_events_ingested_at .............. [RUN]
[0m02:11:57.685025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now model.threat_risk.stg_kev)
[0m02:11:57.685278 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now model.threat_risk.stg_urlhaus)
[0m02:11:57.685558 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26'
[0m02:11:57.685829 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3'
[0m02:11:57.686037 [debug] [Thread-1 (]: Began compiling node model.threat_risk.stg_kev
[0m02:11:57.686250 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_urlhaus
[0m02:11:57.686447 [debug] [Thread-3 (]: Began compiling node test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26
[0m02:11:57.686681 [debug] [Thread-4 (]: Began compiling node test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3
[0m02:11:57.689159 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.stg_kev"
[0m02:11:57.689899 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus"
[0m02:11:57.693898 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"
[0m02:11:57.695296 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"
[0m02:11:57.696419 [debug] [Thread-1 (]: Began executing node model.threat_risk.stg_kev
[0m02:11:57.696577 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_urlhaus
[0m02:11:57.709013 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.stg_kev"
[0m02:11:57.709179 [debug] [Thread-4 (]: Began executing node test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3
[0m02:11:57.710319 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.stg_urlhaus"
[0m02:11:57.710471 [debug] [Thread-3 (]: Began executing node test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26
[0m02:11:57.715577 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"
[0m02:11:57.716664 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"
[0m02:11:57.716854 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m02:11:57.716993 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m02:11:57.717324 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: BEGIN
[0m02:11:57.717526 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: BEGIN
[0m02:11:57.717698 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"
[0m02:11:57.717845 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"
[0m02:11:57.718431 [debug] [Thread-3 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26: BEGIN
[0m02:11:57.718105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:57.718294 [debug] [Thread-4 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3: BEGIN
[0m02:11:57.717941 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:57.718563 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:11:57.718834 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:11:57.726598 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m02:11:57.726763 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m02:11:57.726888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:11:57.727075 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m02:11:57.727214 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m02:11:57.727372 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"
[0m02:11:57.727549 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m02:11:57.727742 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */

  create view "threat_risk"."staging"."stg_urlhaus__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.urlhaus_recent
),
clean as (
  select
    nullif(trim(url), '') as url,
    nullif(trim(url_status), '') as url_status,
    nullif(trim(host), '') as host,
    date_added,
    nullif(trim(threat), '') as threat,
    nullif(trim(tags), '') as tags,
    nullif(trim(urlhaus_link), '') as urlhaus_link,
    nullif(trim(reporter), '') as reporter,
    larted,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m02:11:57.727916 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"
[0m02:11:57.728100 [debug] [Thread-4 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingested_at
from "threat_risk"."raw"."urlhaus_events"
where ingested_at is null



      
    ) dbt_internal_test
[0m02:11:57.728275 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */

  create view "threat_risk"."staging"."stg_kev__dbt_tmp"
    
    
  as (
    with src as (
  select *
  from raw.kev
),
clean as (
  select
    nullif(trim(cve_id), '') as cve_id,
    nullif(trim(vendor_project), '') as vendor_project,
    nullif(trim(product), '') as product,
    nullif(trim(vulnerability_name), '') as vulnerability_name,
    date_added,
    short_description,
    required_action,
    due_date,
    notes,
    source_url,
    run_date,
    ingested_at
  from src
)
select * from clean
  );
[0m02:11:57.728553 [debug] [Thread-3 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "threat_risk"."raw"."urlhaus_events"
where event_id is null



      
    ) dbt_internal_test
[0m02:11:57.729306 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:57.731114 [debug] [Thread-4 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3: ROLLBACK
[0m02:11:57.731265 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:11:57.731372 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m02:11:57.731488 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m02:11:57.732043 [debug] [Thread-3 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26: ROLLBACK
[0m02:11:57.732168 [debug] [Thread-4 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3: Close
[0m02:11:57.734502 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m02:11:57.735583 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m02:11:57.735819 [debug] [Thread-3 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26: Close
[0m02:11:57.736188 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev" rename to "stg_kev__dbt_backup"
[0m02:11:57.736073 [info ] [Thread-4 (]: 4 of 43 PASS source_not_null_raw_urlhaus_events_ingested_at .................... [[32mPASS[0m in 0.05s]
[0m02:11:57.736566 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus" rename to "stg_urlhaus__dbt_backup"
[0m02:11:57.736914 [info ] [Thread-3 (]: 3 of 43 PASS source_not_null_raw_urlhaus_events_event_id ....................... [[32mPASS[0m in 0.05s]
[0m02:11:57.737376 [debug] [Thread-4 (]: Finished running node test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3
[0m02:11:57.737530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.737805 [debug] [Thread-3 (]: Finished running node test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26
[0m02:11:57.737925 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.738136 [debug] [Thread-4 (]: Began running node test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67
[0m02:11:57.739238 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m02:11:57.739459 [debug] [Thread-3 (]: Began running node test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286
[0m02:11:57.740430 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m02:11:57.740673 [info ] [Thread-4 (]: 5 of 43 START test source_not_null_raw_urlhaus_events_source ................... [RUN]
[0m02:11:57.740905 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
alter table "threat_risk"."staging"."stg_kev__dbt_tmp" rename to "stg_kev"
[0m02:11:57.741118 [info ] [Thread-3 (]: 6 of 43 START test source_unique_raw_urlhaus_events_event_id ................... [RUN]
[0m02:11:57.741386 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
alter table "threat_risk"."staging"."stg_urlhaus__dbt_tmp" rename to "stg_urlhaus"
[0m02:11:57.741640 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3, now test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67)
[0m02:11:57.741997 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26, now test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286)
[0m02:11:57.742773 [debug] [Thread-3 (]: Began compiling node test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286
[0m02:11:57.742429 [debug] [Thread-4 (]: Began compiling node test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67
[0m02:11:57.742583 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.742101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.752281 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m02:11:57.746344 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"
[0m02:11:57.751805 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m02:11:57.744963 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"
[0m02:11:57.752446 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m02:11:57.752911 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m02:11:57.753473 [debug] [Thread-4 (]: Began executing node test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67
[0m02:11:57.753596 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: COMMIT
[0m02:11:57.753718 [debug] [Thread-3 (]: Began executing node test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286
[0m02:11:57.753884 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: COMMIT
[0m02:11:57.755548 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"
[0m02:11:57.779709 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m02:11:57.780467 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"
[0m02:11:57.781048 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m02:11:57.783374 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."staging"."stg_kev__dbt_backup"
[0m02:11:57.783671 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"
[0m02:11:57.784520 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."staging"."stg_urlhaus__dbt_backup"
[0m02:11:57.784759 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"
[0m02:11:57.787273 [debug] [Thread-3 (]: On test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286: BEGIN
[0m02:11:57.786859 [debug] [Thread-4 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67: BEGIN
[0m02:11:57.787111 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus"
[0m02:11:57.786665 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.stg_kev"
[0m02:11:57.787917 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_kev"} */
drop view if exists "threat_risk"."staging"."stg_kev__dbt_backup" cascade
[0m02:11:57.787568 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:57.787738 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus"} */
drop view if exists "threat_risk"."staging"."stg_urlhaus__dbt_backup" cascade
[0m02:11:57.787422 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:57.789013 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m02:11:57.789149 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m02:11:57.791063 [debug] [Thread-1 (]: On model.threat_risk.stg_kev: Close
[0m02:11:57.791595 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus: Close
[0m02:11:57.792375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4379f10>]}
[0m02:11:57.792586 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:57.792769 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:57.793111 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6612790>]}
[0m02:11:57.793446 [info ] [Thread-1 (]: 1 of 43 OK created sql view model staging.stg_kev .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m02:11:57.793727 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"
[0m02:11:57.793965 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"
[0m02:11:57.794244 [info ] [Thread-2 (]: 2 of 43 OK created sql view model staging.stg_urlhaus .......................... [[32mCREATE VIEW[0m in 0.11s]
[0m02:11:57.794563 [debug] [Thread-1 (]: Finished running node model.threat_risk.stg_kev
[0m02:11:57.794775 [debug] [Thread-4 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select source
from "threat_risk"."raw"."urlhaus_events"
where source is null



      
    ) dbt_internal_test
[0m02:11:57.794956 [debug] [Thread-3 (]: On test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "threat_risk"."raw"."urlhaus_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:57.795202 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_urlhaus
[0m02:11:57.795623 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m02:11:57.795997 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m02:11:57.796332 [info ] [Thread-1 (]: 7 of 43 START test not_null_stg_kev_cve_id ..................................... [RUN]
[0m02:11:57.796824 [info ] [Thread-2 (]: 8 of 43 START test not_null_stg_kev_product .................................... [RUN]
[0m02:11:57.797177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_kev, now test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0)
[0m02:11:57.797446 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus, now test.threat_risk.not_null_stg_kev_product.9b2d2b4877)
[0m02:11:57.797685 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m02:11:57.797873 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m02:11:57.799630 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m02:11:57.799795 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:11:57.801170 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m02:11:57.801322 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m02:11:57.802111 [debug] [Thread-4 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67: ROLLBACK
[0m02:11:57.802531 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m02:11:57.804307 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m02:11:57.803281 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m02:11:57.803500 [debug] [Thread-4 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67: Close
[0m02:11:57.803046 [debug] [Thread-3 (]: On test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286: ROLLBACK
[0m02:11:57.805226 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m02:11:57.805572 [info ] [Thread-4 (]: 5 of 43 PASS source_not_null_raw_urlhaus_events_source ......................... [[32mPASS[0m in 0.06s]
[0m02:11:57.805868 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m02:11:57.806089 [debug] [Thread-3 (]: On test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286: Close
[0m02:11:57.806430 [debug] [Thread-4 (]: Finished running node test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67
[0m02:11:57.806607 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m02:11:57.806723 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m02:11:57.807017 [info ] [Thread-3 (]: 6 of 43 PASS source_unique_raw_urlhaus_events_event_id ......................... [[32mPASS[0m in 0.07s]
[0m02:11:57.807965 [debug] [Thread-3 (]: Finished running node test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286
[0m02:11:57.807545 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m02:11:57.807737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:57.807249 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m02:11:57.808145 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m02:11:57.808366 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:57.808675 [info ] [Thread-4 (]: 9 of 43 START test not_null_stg_kev_run_date ................................... [RUN]
[0m02:11:57.809744 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m02:11:57.809147 [info ] [Thread-3 (]: 10 of 43 START test not_null_stg_kev_vendor_project ............................ [RUN]
[0m02:11:57.810127 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m02:11:57.809949 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m02:11:57.810299 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m02:11:57.811987 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m02:11:57.814029 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m02:11:57.814641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m02:11:57.814929 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m02:11:57.815083 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m02:11:57.815207 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m02:11:57.815332 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m02:11:57.815490 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m02:11:57.816358 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m02:11:57.817188 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m02:11:57.817409 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m02:11:57.818025 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m02:11:57.818175 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m02:11:57.818399 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m02:11:57.818719 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m02:11:57.818525 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m02:11:57.818986 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:57.818858 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:57.822566 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m02:11:57.822720 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:57.822838 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:11:57.823461 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m02:11:57.823819 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m02:11:57.823715 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:57.824330 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m02:11:57.824643 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m02:11:57.824778 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m02:11:57.824943 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m02:11:57.825308 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m02:11:57.825786 [info ] [Thread-1 (]: 7 of 43 PASS not_null_stg_kev_cve_id ........................................... [[32mPASS[0m in 0.03s]
[0m02:11:57.826098 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m02:11:57.826510 [info ] [Thread-2 (]: 8 of 43 PASS not_null_stg_kev_product .......................................... [[32mPASS[0m in 0.03s]
[0m02:11:57.826856 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m02:11:57.827256 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m02:11:57.827572 [debug] [Thread-1 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m02:11:57.827890 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m02:11:57.828153 [info ] [Thread-1 (]: 11 of 43 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m02:11:57.828461 [info ] [Thread-2 (]: 12 of 43 START test not_null_stg_urlhaus_run_date .............................. [RUN]
[0m02:11:57.828820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41)
[0m02:11:57.829105 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93)
[0m02:11:57.829366 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:11:57.829600 [debug] [Thread-1 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m02:11:57.829837 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m02:11:57.830506 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m02:11:57.830648 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:11:57.835460 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m02:11:57.837400 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m02:11:57.837796 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m02:11:57.838335 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m02:11:57.839324 [info ] [Thread-4 (]: 9 of 43 PASS not_null_stg_kev_run_date ......................................... [[32mPASS[0m in 0.03s]
[0m02:11:57.839559 [debug] [Thread-1 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m02:11:57.839889 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m02:11:57.840027 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m02:11:57.840311 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m02:11:57.841328 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m02:11:57.842157 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m02:11:57.842553 [info ] [Thread-3 (]: 10 of 43 PASS not_null_stg_kev_vendor_project .................................. [[32mPASS[0m in 0.03s]
[0m02:11:57.842789 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m02:11:57.843532 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m02:11:57.843697 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m02:11:57.844111 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m02:11:57.843891 [info ] [Thread-4 (]: 13 of 43 START test not_null_stg_urlhaus_url ................................... [RUN]
[0m02:11:57.845108 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m02:11:57.844682 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m02:11:57.844892 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m02:11:57.844376 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m02:11:57.845257 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m02:11:57.845433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:57.845598 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:57.845776 [info ] [Thread-3 (]: 14 of 43 START test not_null_stg_urlhaus_url_status ............................ [RUN]
[0m02:11:57.847684 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m02:11:57.848343 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m02:11:57.848776 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m02:11:57.850516 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m02:11:57.850667 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m02:11:57.852134 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m02:11:57.852435 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m02:11:57.852651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m02:11:57.852799 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m02:11:57.854196 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m02:11:57.853879 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m02:11:57.854002 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m02:11:57.853632 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m02:11:57.854350 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m02:11:57.854569 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m02:11:57.854777 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m02:11:57.855213 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:57.855341 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m02:11:57.855819 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m02:11:57.856038 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:57.862991 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m02:11:57.863231 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m02:11:57.863474 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m02:11:57.864077 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m02:11:57.863802 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m02:11:57.864440 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m02:11:57.865960 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m02:11:57.867302 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m02:11:57.868067 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m02:11:57.869146 [info ] [Thread-2 (]: 12 of 43 PASS not_null_stg_urlhaus_run_date .................................... [[32mPASS[0m in 0.04s]
[0m02:11:57.870022 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m02:11:57.870842 [debug] [Thread-2 (]: Began running node model.threat_risk.stg_urlhaus_events
[0m02:11:57.871128 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m02:11:57.871438 [info ] [Thread-2 (]: 15 of 43 START sql view model staging.stg_urlhaus_events ....................... [RUN]
[0m02:11:57.872216 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m02:11:57.872567 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now model.threat_risk.stg_urlhaus_events)
[0m02:11:57.872995 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m02:11:57.873153 [debug] [Thread-2 (]: Began compiling node model.threat_risk.stg_urlhaus_events
[0m02:11:57.873561 [info ] [Thread-1 (]: 11 of 43 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown . [[32mPASS[0m in 0.04s]
[0m02:11:57.875286 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.stg_urlhaus_events"
[0m02:11:57.875675 [debug] [Thread-1 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m02:11:57.876223 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_product
[0m02:11:57.876569 [info ] [Thread-1 (]: 16 of 43 START sql table model marts.dim_product ............................... [RUN]
[0m02:11:57.876743 [debug] [Thread-2 (]: Began executing node model.threat_risk.stg_urlhaus_events
[0m02:11:57.877069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now model.threat_risk.dim_product)
[0m02:11:57.878807 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_product
[0m02:11:57.878568 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.stg_urlhaus_events"
[0m02:11:57.879874 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_product"
[0m02:11:57.880751 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus_events"
[0m02:11:57.881022 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus_events: BEGIN
[0m02:11:57.881184 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_product
[0m02:11:57.881343 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:57.881485 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m02:11:57.881652 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m02:11:57.890773 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.dim_product"
[0m02:11:57.891608 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m02:11:57.892151 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m02:11:57.893639 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m02:11:57.893929 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m02:11:57.894168 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m02:11:57.894410 [info ] [Thread-4 (]: 13 of 43 PASS not_null_stg_urlhaus_url ......................................... [[32mPASS[0m in 0.05s]
[0m02:11:57.894736 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m02:11:57.894942 [info ] [Thread-3 (]: 14 of 43 PASS not_null_stg_urlhaus_url_status .................................. [[32mPASS[0m in 0.05s]
[0m02:11:57.895866 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m02:11:57.895450 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m02:11:57.895650 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus_events"
[0m02:11:57.895166 [debug] [Thread-1 (]: On model.threat_risk.dim_product: BEGIN
[0m02:11:57.896721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:57.896258 [debug] [Thread-4 (]: Began running node model.threat_risk.fact_kev
[0m02:11:57.896508 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus_events"} */

  create view "threat_risk"."staging"."stg_urlhaus_events__dbt_tmp"
    
    
  as (
    

with src as (
  select
    event_id,
    event_time,
    ingested_at,
    source,
    url,
    feed,
    payload,
    _consumer_ingested_at,
    _kafka_topic,
    _kafka_partition,
    _kafka_offset,
    inserted_at
  from "threat_risk"."raw"."urlhaus_events"
)

select
  event_id,
  event_time,
  ingested_at,
  source,
  url,
  feed,
  payload,
  inserted_at
from src
  );
[0m02:11:57.896043 [debug] [Thread-3 (]: Began running node model.threat_risk.dim_vendor
[0m02:11:57.897058 [info ] [Thread-4 (]: 18 of 43 START sql table model marts.fact_kev .................................. [RUN]
[0m02:11:57.897860 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now model.threat_risk.fact_kev)
[0m02:11:57.897530 [info ] [Thread-3 (]: 17 of 43 START sql table model marts.dim_vendor ................................ [RUN]
[0m02:11:57.898047 [debug] [Thread-4 (]: Began compiling node model.threat_risk.fact_kev
[0m02:11:57.898251 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now model.threat_risk.dim_vendor)
[0m02:11:57.898463 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m02:11:57.899637 [debug] [Thread-4 (]: Writing injected SQL for node "model.threat_risk.fact_kev"
[0m02:11:57.899825 [debug] [Thread-3 (]: Began compiling node model.threat_risk.dim_vendor
[0m02:11:57.901015 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus_events"
[0m02:11:57.901316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:57.902413 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.dim_vendor"
[0m02:11:57.902629 [debug] [Thread-4 (]: Began executing node model.threat_risk.fact_kev
[0m02:11:57.902798 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus_events"} */
alter table "threat_risk"."staging"."stg_urlhaus_events" rename to "stg_urlhaus_events__dbt_backup"
[0m02:11:57.902985 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m02:11:57.904484 [debug] [Thread-4 (]: Writing runtime sql for node "model.threat_risk.fact_kev"
[0m02:11:57.904787 [debug] [Thread-3 (]: Began executing node model.threat_risk.dim_vendor
[0m02:11:57.904954 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */

  
    

  create  table "threat_risk"."marts"."dim_product__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  md5(coalesce(vendor_project,'')) as vendor_key,
  vendor_project,
  product
from (
  select distinct vendor_project, product
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null and product is not null
) p
  );
  
[0m02:11:57.905079 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.906476 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.dim_vendor"
[0m02:11:57.906766 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m02:11:57.907962 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus_events"
[0m02:11:57.911650 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: BEGIN
[0m02:11:57.912445 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:57.912318 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m02:11:57.911900 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus_events"} */
alter table "threat_risk"."staging"."stg_urlhaus_events__dbt_tmp" rename to "stg_urlhaus_events"
[0m02:11:57.912744 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: BEGIN
[0m02:11:57.913179 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:57.913341 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.914107 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus_events: COMMIT
[0m02:11:57.915028 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus_events"
[0m02:11:57.915504 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus_events: COMMIT
[0m02:11:57.916055 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m02:11:57.916328 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:57.917715 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."staging"."stg_urlhaus_events__dbt_backup"
[0m02:11:57.917952 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m02:11:57.918533 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */

  
    

  create  table "threat_risk"."marts"."fact_kev__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(cve_id,'')) as cve_key,
  md5(coalesce(vendor_project,'') || '|' || coalesce(product,'')) as product_key,
  run_date as date_day,
  cve_id,
  vulnerability_name,
  date_added,
  due_date,
  required_action,
  notes
from "threat_risk"."staging"."stg_kev"
where cve_id is not null
  );
  
[0m02:11:57.918324 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.stg_urlhaus_events"
[0m02:11:57.918100 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:57.918806 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.stg_urlhaus_events"} */
drop view if exists "threat_risk"."staging"."stg_urlhaus_events__dbt_backup" cascade
[0m02:11:57.918985 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m02:11:57.919264 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */

  
    

  create  table "threat_risk"."marts"."dim_vendor__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(vendor_project, '')) as vendor_key,
  vendor_project
from (
  select distinct vendor_project
  from "threat_risk"."staging"."stg_kev"
  where vendor_project is not null
) v
  );
  
[0m02:11:57.919939 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m02:11:57.920536 [debug] [Thread-2 (]: On model.threat_risk.stg_urlhaus_events: Close
[0m02:11:57.920828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65997d0>]}
[0m02:11:57.921164 [info ] [Thread-2 (]: 15 of 43 OK created sql view model staging.stg_urlhaus_events .................. [[32mCREATE VIEW[0m in 0.05s]
[0m02:11:57.921595 [debug] [Thread-2 (]: Finished running node model.threat_risk.stg_urlhaus_events
[0m02:11:57.921859 [debug] [Thread-2 (]: Began running node model.threat_risk.dim_date
[0m02:11:57.922191 [info ] [Thread-2 (]: 19 of 43 START sql table model marts.dim_date .................................. [RUN]
[0m02:11:57.922472 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.stg_urlhaus_events, now model.threat_risk.dim_date)
[0m02:11:57.922666 [debug] [Thread-2 (]: Began compiling node model.threat_risk.dim_date
[0m02:11:57.924052 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.dim_date"
[0m02:11:57.924615 [debug] [Thread-2 (]: Began executing node model.threat_risk.dim_date
[0m02:11:57.926437 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.dim_date"
[0m02:11:57.926663 [debug] [Thread-1 (]: SQL status: SELECT 641 in 0.020 seconds
[0m02:11:57.928300 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m02:11:57.928604 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product" rename to "dim_product__dbt_backup"
[0m02:11:57.928507 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m02:11:57.929650 [debug] [Thread-3 (]: SQL status: SELECT 251 in 0.009 seconds
[0m02:11:57.930089 [debug] [Thread-2 (]: On model.threat_risk.dim_date: BEGIN
[0m02:11:57.930295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.931394 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m02:11:57.931587 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:57.932666 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m02:11:57.932878 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor" rename to "dim_vendor__dbt_backup"
[0m02:11:57.933250 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
alter table "threat_risk"."marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m02:11:57.933704 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.933894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.935007 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m02:11:57.937653 [debug] [Thread-1 (]: On model.threat_risk.dim_product: COMMIT
[0m02:11:57.937900 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
alter table "threat_risk"."marts"."dim_vendor__dbt_tmp" rename to "dim_vendor"
[0m02:11:57.938060 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:57.938452 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m02:11:57.938218 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m02:11:57.938584 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.938767 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */

  
    

  create  table "threat_risk"."marts"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with dates as (
  select distinct run_date as d from "threat_risk"."staging"."stg_kev"
  union
  select distinct run_date as d from "threat_risk"."staging"."stg_urlhaus"
),
final as (
  select
    d as date_day,
    extract(year from d)::int as year,
    extract(month from d)::int as month,
    extract(day from d)::int as day
  from dates
)
select * from final
  );
  
[0m02:11:57.938930 [debug] [Thread-1 (]: On model.threat_risk.dim_product: COMMIT
[0m02:11:57.939456 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: COMMIT
[0m02:11:57.939795 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m02:11:57.939966 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: COMMIT
[0m02:11:57.941190 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:11:57.941373 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m02:11:57.942337 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."marts"."dim_product__dbt_backup"
[0m02:11:57.943313 [debug] [Thread-3 (]: Applying DROP to: "threat_risk"."marts"."dim_vendor__dbt_backup"
[0m02:11:57.944462 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_product"
[0m02:11:57.944796 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.dim_vendor"
[0m02:11:57.944974 [debug] [Thread-1 (]: On model.threat_risk.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_product"} */
drop table if exists "threat_risk"."marts"."dim_product__dbt_backup" cascade
[0m02:11:57.945167 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_vendor"} */
drop table if exists "threat_risk"."marts"."dim_vendor__dbt_backup" cascade
[0m02:11:57.946721 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:11:57.946859 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:11:57.947455 [debug] [Thread-1 (]: On model.threat_risk.dim_product: Close
[0m02:11:57.947957 [debug] [Thread-3 (]: On model.threat_risk.dim_vendor: Close
[0m02:11:57.948295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66fa9d0>]}
[0m02:11:57.948530 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6686fd0>]}
[0m02:11:57.948768 [info ] [Thread-1 (]: 16 of 43 OK created sql table model marts.dim_product .......................... [[32mSELECT 641[0m in 0.07s]
[0m02:11:57.949114 [info ] [Thread-3 (]: 17 of 43 OK created sql table model marts.dim_vendor ........................... [[32mSELECT 251[0m in 0.05s]
[0m02:11:57.949579 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_product
[0m02:11:57.949874 [debug] [Thread-3 (]: Finished running node model.threat_risk.dim_vendor
[0m02:11:57.950093 [debug] [Thread-1 (]: Began running node model.threat_risk.dim_url
[0m02:11:57.950476 [debug] [Thread-3 (]: Began running node model.threat_risk.fact_url_events
[0m02:11:57.950774 [info ] [Thread-1 (]: 20 of 43 START sql table model marts.dim_url ................................... [RUN]
[0m02:11:57.951194 [info ] [Thread-3 (]: 21 of 43 START sql table model marts.fact_url_events ........................... [RUN]
[0m02:11:57.951495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_product, now model.threat_risk.dim_url)
[0m02:11:57.951748 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_vendor, now model.threat_risk.fact_url_events)
[0m02:11:57.951916 [debug] [Thread-1 (]: Began compiling node model.threat_risk.dim_url
[0m02:11:57.952102 [debug] [Thread-3 (]: Began compiling node model.threat_risk.fact_url_events
[0m02:11:57.953411 [debug] [Thread-1 (]: Writing injected SQL for node "model.threat_risk.dim_url"
[0m02:11:57.954706 [debug] [Thread-3 (]: Writing injected SQL for node "model.threat_risk.fact_url_events"
[0m02:11:57.955340 [debug] [Thread-1 (]: Began executing node model.threat_risk.dim_url
[0m02:11:57.956925 [debug] [Thread-1 (]: Writing runtime sql for node "model.threat_risk.dim_url"
[0m02:11:57.957110 [debug] [Thread-3 (]: Began executing node model.threat_risk.fact_url_events
[0m02:11:57.958449 [debug] [Thread-3 (]: Writing runtime sql for node "model.threat_risk.fact_url_events"
[0m02:11:57.958722 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m02:11:57.958858 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.019 seconds
[0m02:11:57.959036 [debug] [Thread-1 (]: On model.threat_risk.dim_url: BEGIN
[0m02:11:57.959138 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m02:11:57.960335 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m02:11:57.960871 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date" rename to "dim_date__dbt_backup"
[0m02:11:57.960721 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: BEGIN
[0m02:11:57.960510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:57.961101 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:11:57.961250 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.962457 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m02:11:57.962613 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
alter table "threat_risk"."marts"."dim_date__dbt_tmp" rename to "dim_date"
[0m02:11:57.964845 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.964969 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:57.966777 [debug] [Thread-2 (]: On model.threat_risk.dim_date: COMMIT
[0m02:11:57.966988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:57.967173 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m02:11:57.967351 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m02:11:57.967927 [debug] [Thread-2 (]: On model.threat_risk.dim_date: COMMIT
[0m02:11:57.967758 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */

  
    

  create  table "threat_risk"."marts"."fact_url_events__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  run_date as date_day,
  url_status,
  threat,
  tags,
  date_added,
  reporter,
  larted
from "threat_risk"."staging"."stg_urlhaus"
where url is not null
  );
  
[0m02:11:57.967538 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m02:11:57.968220 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */

  
    

  create  table "threat_risk"."marts"."dim_url__dbt_tmp"
  
  
    as
  
  (
    select
  md5(coalesce(url,'')) as url_key,
  url,
  host
from (
  select distinct url, host
  from "threat_risk"."staging"."stg_urlhaus"
  where url is not null
) u
  );
  
[0m02:11:57.969721 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m02:11:57.970748 [debug] [Thread-2 (]: Applying DROP to: "threat_risk"."marts"."dim_date__dbt_backup"
[0m02:11:57.971039 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.dim_date"
[0m02:11:57.971191 [debug] [Thread-2 (]: On model.threat_risk.dim_date: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_date"} */
drop table if exists "threat_risk"."marts"."dim_date__dbt_backup" cascade
[0m02:11:57.971481 [debug] [Thread-4 (]: SQL status: SELECT 25417 in 0.053 seconds
[0m02:11:57.972727 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m02:11:57.972852 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:11:57.973007 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev" rename to "fact_kev__dbt_backup"
[0m02:11:57.973503 [debug] [Thread-2 (]: On model.threat_risk.dim_date: Close
[0m02:11:57.973846 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa444e990>]}
[0m02:11:57.973959 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.974222 [info ] [Thread-2 (]: 19 of 43 OK created sql table model marts.dim_date ............................. [[32mSELECT 1[0m in 0.05s]
[0m02:11:57.975578 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m02:11:57.975858 [debug] [Thread-2 (]: Finished running node model.threat_risk.dim_date
[0m02:11:57.976056 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
alter table "threat_risk"."marts"."fact_kev__dbt_tmp" rename to "fact_kev"
[0m02:11:57.976261 [debug] [Thread-2 (]: Began running node model.threat_risk.fct_urlhaus_threat_events
[0m02:11:57.976758 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:57.976648 [info ] [Thread-2 (]: 22 of 43 START sql incremental model marts.fct_urlhaus_threat_events ........... [RUN]
[0m02:11:57.977499 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: COMMIT
[0m02:11:57.977712 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_date, now model.threat_risk.fct_urlhaus_threat_events)
[0m02:11:57.977901 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m02:11:57.978061 [debug] [Thread-2 (]: Began compiling node model.threat_risk.fct_urlhaus_threat_events
[0m02:11:57.978225 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: COMMIT
[0m02:11:57.981564 [debug] [Thread-2 (]: Writing injected SQL for node "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:57.982202 [debug] [Thread-2 (]: Began executing node model.threat_risk.fct_urlhaus_threat_events
[0m02:11:57.982371 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m02:11:57.993453 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:57.994766 [debug] [Thread-2 (]: On model.threat_risk.fct_urlhaus_threat_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fct_urlhaus_threat_events"} */

    
  
    

  create temporary table "fct_urlhaus_threat_events__dbt_tmp021157991362"
  
  
    as
  
  (
    

with base as (
  select
    event_id,
    event_time,
    ingested_at,
    source,
    url,
    feed
  from "threat_risk"."staging"."stg_urlhaus_events"

  
    -- Lookback window handles late arrivals / replays
    where ingested_at >= (
      select coalesce(max(ingested_at), '1970-01-01'::timestamptz) from "threat_risk"."marts"."fct_urlhaus_threat_events"
    ) - interval '48 hours'
  
)

select * from base
  );
  
  
[0m02:11:57.994554 [debug] [Thread-4 (]: Applying DROP to: "threat_risk"."marts"."fact_kev__dbt_backup"
[0m02:11:57.995265 [debug] [Thread-4 (]: Using postgres connection "model.threat_risk.fact_kev"
[0m02:11:57.994953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:57.995444 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_kev"} */
drop table if exists "threat_risk"."marts"."fact_kev__dbt_backup" cascade
[0m02:11:57.997567 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:11:57.998809 [debug] [Thread-4 (]: On model.threat_risk.fact_kev: Close
[0m02:11:57.999084 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa439d9d0>]}
[0m02:11:57.999343 [info ] [Thread-4 (]: 18 of 43 OK created sql table model marts.fact_kev ............................. [[32mSELECT 25417[0m in 0.10s]
[0m02:11:57.999737 [debug] [Thread-4 (]: Finished running node model.threat_risk.fact_kev
[0m02:11:57.999936 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m02:11:58.000214 [info ] [Thread-4 (]: 23 of 43 START test not_null_dim_product_product ............................... [RUN]
[0m02:11:58.000503 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.threat_risk.fact_kev, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m02:11:58.000680 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m02:11:58.002239 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m02:11:58.002727 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m02:11:58.003586 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m02:11:58.004012 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m02:11:58.004171 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: BEGIN
[0m02:11:58.004303 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.007282 [debug] [Thread-2 (]: SQL status: SELECT 20404 in 0.012 seconds
[0m02:11:58.010790 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:58.012285 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m02:11:58.013368 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product.56a877bc84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."marts"."dim_product"
where product is null



      
    ) dbt_internal_test
[0m02:11:58.013256 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:58.013694 [debug] [Thread-2 (]: On model.threat_risk.fct_urlhaus_threat_events: BEGIN
[0m02:11:58.013992 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m02:11:58.014270 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:58.014109 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:58.015123 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: ROLLBACK
[0m02:11:58.014475 [debug] [Thread-2 (]: On model.threat_risk.fct_urlhaus_threat_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fct_urlhaus_threat_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_urlhaus_threat_events__dbt_tmp021157991362'
        
      order by ordinal_position

  
[0m02:11:58.015352 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: Close
[0m02:11:58.015671 [info ] [Thread-4 (]: 23 of 43 PASS not_null_dim_product_product ..................................... [[32mPASS[0m in 0.02s]
[0m02:11:58.015985 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m02:11:58.016216 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m02:11:58.016423 [info ] [Thread-4 (]: 24 of 43 START test not_null_dim_product_product_key ........................... [RUN]
[0m02:11:58.016677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.not_null_dim_product_product_key.f0e1d838d3)
[0m02:11:58.016872 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m02:11:58.019770 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m02:11:58.020229 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m02:11:58.021135 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m02:11:58.021510 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m02:11:58.024712 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m02:11:58.022978 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.008 seconds
[0m02:11:58.024861 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.026970 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:58.027434 [debug] [Thread-2 (]: On model.threat_risk.fct_urlhaus_threat_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fct_urlhaus_threat_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "threat_risk".INFORMATION_SCHEMA.columns
      where table_name = 'fct_urlhaus_threat_events'
        
        and table_schema = 'marts'
        
      order by ordinal_position

  
[0m02:11:58.029045 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.001 seconds
[0m02:11:58.033044 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:58.033288 [debug] [Thread-2 (]: On model.threat_risk.fct_urlhaus_threat_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fct_urlhaus_threat_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "threat_risk".INFORMATION_SCHEMA.columns
      where table_name = 'fct_urlhaus_threat_events'
        
        and table_schema = 'marts'
        
      order by ordinal_position

  
[0m02:11:58.033470 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m02:11:58.033713 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m02:11:58.033961 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "threat_risk"."marts"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m02:11:58.034555 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m02:11:58.035200 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m02:11:58.035332 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.002 seconds
[0m02:11:58.035658 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: Close
[0m02:11:58.043800 [debug] [Thread-2 (]: Writing runtime sql for node "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:58.044273 [info ] [Thread-4 (]: 24 of 43 PASS not_null_dim_product_product_key ................................. [[32mPASS[0m in 0.03s]
[0m02:11:58.044852 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m02:11:58.045162 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m02:11:58.045671 [info ] [Thread-4 (]: 25 of 43 START test not_null_dim_product_vendor_key ............................ [RUN]
[0m02:11:58.045419 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:58.046132 [debug] [Thread-2 (]: On model.threat_risk.fct_urlhaus_threat_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fct_urlhaus_threat_events"} */

      -- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into "threat_risk"."marts"."fct_urlhaus_threat_events" as DBT_INTERNAL_DEST
        using "fct_urlhaus_threat_events__dbt_tmp021157991362" as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
            )

    
    when matched then update set
        "event_id" = DBT_INTERNAL_SOURCE."event_id","event_time" = DBT_INTERNAL_SOURCE."event_time","ingested_at" = DBT_INTERNAL_SOURCE."ingested_at","source" = DBT_INTERNAL_SOURCE."source","url" = DBT_INTERNAL_SOURCE."url","feed" = DBT_INTERNAL_SOURCE."feed"
    

    when not matched then insert
        ("event_id", "event_time", "ingested_at", "source", "url", "feed")
    values
        ("event_id", "event_time", "ingested_at", "source", "url", "feed")


  
[0m02:11:58.045932 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.not_null_dim_product_vendor_key.78836999d2)
[0m02:11:58.046358 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m02:11:58.048544 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m02:11:58.049049 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m02:11:58.050006 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m02:11:58.050375 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m02:11:58.050567 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: BEGIN
[0m02:11:58.050708 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.054366 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:58.054568 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m02:11:58.054709 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_product"
where vendor_key is null



      
    ) dbt_internal_test
[0m02:11:58.055292 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m02:11:58.055950 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: ROLLBACK
[0m02:11:58.056195 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: Close
[0m02:11:58.056616 [info ] [Thread-4 (]: 25 of 43 PASS not_null_dim_product_vendor_key .................................. [[32mPASS[0m in 0.01s]
[0m02:11:58.057123 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m02:11:58.057336 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m02:11:58.057547 [info ] [Thread-4 (]: 26 of 43 START test not_null_dim_product_vendor_project ........................ [RUN]
[0m02:11:58.057787 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m02:11:58.057986 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m02:11:58.059767 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m02:11:58.060338 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m02:11:58.061293 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m02:11:58.061647 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m02:11:58.061798 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: BEGIN
[0m02:11:58.061928 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.065447 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m02:11:58.065674 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m02:11:58.065848 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_product"
where vendor_project is null



      
    ) dbt_internal_test
[0m02:11:58.066463 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m02:11:58.067147 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: ROLLBACK
[0m02:11:58.067367 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: Close
[0m02:11:58.067631 [info ] [Thread-4 (]: 26 of 43 PASS not_null_dim_product_vendor_project .............................. [[32mPASS[0m in 0.01s]
[0m02:11:58.067921 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m02:11:58.068197 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m02:11:58.068433 [info ] [Thread-4 (]: 27 of 43 START test unique_dim_product_product_key ............................. [RUN]
[0m02:11:58.068670 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m02:11:58.068831 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m02:11:58.070457 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m02:11:58.071005 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m02:11:58.072130 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m02:11:58.072694 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m02:11:58.072906 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: BEGIN
[0m02:11:58.073072 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.076546 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m02:11:58.076753 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m02:11:58.076962 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:58.078034 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:58.078646 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m02:11:58.078918 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: Close
[0m02:11:58.079235 [info ] [Thread-4 (]: 27 of 43 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.01s]
[0m02:11:58.079526 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m02:11:58.079757 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m02:11:58.079970 [info ] [Thread-4 (]: 28 of 43 START test not_null_dim_vendor_vendor_key ............................. [RUN]
[0m02:11:58.080243 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_product_product_key.1753236bd0, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m02:11:58.080427 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m02:11:58.082138 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m02:11:58.082605 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m02:11:58.084772 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m02:11:58.085256 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m02:11:58.085421 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: BEGIN
[0m02:11:58.085574 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.089002 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m02:11:58.089190 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m02:11:58.089388 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_vendor"
where vendor_key is null



      
    ) dbt_internal_test
[0m02:11:58.090046 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m02:11:58.090709 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: ROLLBACK
[0m02:11:58.090977 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: Close
[0m02:11:58.091269 [info ] [Thread-4 (]: 28 of 43 PASS not_null_dim_vendor_vendor_key ................................... [[32mPASS[0m in 0.01s]
[0m02:11:58.091599 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m02:11:58.091860 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m02:11:58.092093 [info ] [Thread-4 (]: 29 of 43 START test not_null_dim_vendor_vendor_project ......................... [RUN]
[0m02:11:58.092391 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m02:11:58.092644 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m02:11:58.094298 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m02:11:58.094775 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m02:11:58.095662 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m02:11:58.096169 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m02:11:58.096348 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: BEGIN
[0m02:11:58.096652 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.100271 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:58.100522 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m02:11:58.100716 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_vendor"
where vendor_project is null



      
    ) dbt_internal_test
[0m02:11:58.101254 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m02:11:58.101884 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: ROLLBACK
[0m02:11:58.102122 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: Close
[0m02:11:58.102426 [info ] [Thread-4 (]: 29 of 43 PASS not_null_dim_vendor_vendor_project ............................... [[32mPASS[0m in 0.01s]
[0m02:11:58.102768 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m02:11:58.103001 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m02:11:58.103211 [info ] [Thread-4 (]: 30 of 43 START test unique_dim_vendor_vendor_key ............................... [RUN]
[0m02:11:58.103438 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m02:11:58.103620 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m02:11:58.105371 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m02:11:58.105893 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m02:11:58.106884 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m02:11:58.107332 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m02:11:58.107541 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: BEGIN
[0m02:11:58.107722 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.111406 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:58.111696 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m02:11:58.111899 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_key is not null
group by vendor_key
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:58.112789 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:58.113412 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: ROLLBACK
[0m02:11:58.113652 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: Close
[0m02:11:58.114088 [info ] [Thread-4 (]: 30 of 43 PASS unique_dim_vendor_vendor_key ..................................... [[32mPASS[0m in 0.01s]
[0m02:11:58.113799 [debug] [Thread-2 (]: SQL status: MERGE 20404 in 0.068 seconds
[0m02:11:58.115096 [debug] [Thread-2 (]: On model.threat_risk.fct_urlhaus_threat_events: COMMIT
[0m02:11:58.114496 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m02:11:58.115264 [debug] [Thread-2 (]: Using postgres connection "model.threat_risk.fct_urlhaus_threat_events"
[0m02:11:58.115723 [debug] [Thread-2 (]: On model.threat_risk.fct_urlhaus_threat_events: COMMIT
[0m02:11:58.115473 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m02:11:58.115965 [info ] [Thread-4 (]: 31 of 43 START test unique_dim_vendor_vendor_project ........................... [RUN]
[0m02:11:58.116178 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m02:11:58.116421 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m02:11:58.118712 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m02:11:58.119443 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m02:11:58.120477 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m02:11:58.121056 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m02:11:58.121301 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: BEGIN
[0m02:11:58.121453 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.125206 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:58.125410 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m02:11:58.125573 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_project as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_project is not null
group by vendor_project
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:58.126416 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:11:58.127068 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: ROLLBACK
[0m02:11:58.127292 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: Close
[0m02:11:58.127592 [info ] [Thread-4 (]: 31 of 43 PASS unique_dim_vendor_vendor_project ................................. [[32mPASS[0m in 0.01s]
[0m02:11:58.128094 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m02:11:58.128294 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m02:11:58.128684 [info ] [Thread-4 (]: 32 of 43 START test not_null_fact_kev_cve_id ................................... [RUN]
[0m02:11:58.128544 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m02:11:58.128948 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m02:11:58.129512 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m02:11:58.129347 [debug] [Thread-2 (]: On model.threat_risk.fct_urlhaus_threat_events: Close
[0m02:11:58.131952 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4420350>]}
[0m02:11:58.131595 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m02:11:58.132266 [info ] [Thread-2 (]: 22 of 43 OK created sql incremental model marts.fct_urlhaus_threat_events ...... [[32mMERGE 20404[0m in 0.15s]
[0m02:11:58.132745 [debug] [Thread-2 (]: Finished running node model.threat_risk.fct_urlhaus_threat_events
[0m02:11:58.132988 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m02:11:58.133501 [info ] [Thread-2 (]: 33 of 43 START test not_null_fact_kev_date_day ................................. [RUN]
[0m02:11:58.133178 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m02:11:58.133780 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.threat_risk.fct_urlhaus_threat_events, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m02:11:58.135050 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m02:11:58.134895 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m02:11:58.136462 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m02:11:58.136906 [debug] [Thread-1 (]: SQL status: SELECT 42290 in 0.169 seconds
[0m02:11:58.137139 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m02:11:58.138443 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m02:11:58.138592 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m02:11:58.140647 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: BEGIN
[0m02:11:58.141831 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.141660 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m02:11:58.140816 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url" rename to "dim_url__dbt_backup"
[0m02:11:58.142820 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m02:11:58.143003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:58.143190 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: BEGIN
[0m02:11:58.146742 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m02:11:58.147260 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
alter table "threat_risk"."marts"."dim_url__dbt_tmp" rename to "dim_url"
[0m02:11:58.147117 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:58.146999 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:58.147575 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m02:11:58.147714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:58.147998 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."marts"."fact_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m02:11:58.148654 [debug] [Thread-1 (]: On model.threat_risk.dim_url: COMMIT
[0m02:11:58.150483 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m02:11:58.150633 [debug] [Thread-1 (]: On model.threat_risk.dim_url: COMMIT
[0m02:11:58.150987 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m02:11:58.151190 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m02:11:58.151530 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_kev"
where date_day is null



      
    ) dbt_internal_test
[0m02:11:58.151934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:11:58.152968 [debug] [Thread-1 (]: Applying DROP to: "threat_risk"."marts"."dim_url__dbt_backup"
[0m02:11:58.153201 [debug] [Thread-1 (]: Using postgres connection "model.threat_risk.dim_url"
[0m02:11:58.153344 [debug] [Thread-1 (]: On model.threat_risk.dim_url: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.dim_url"} */
drop table if exists "threat_risk"."marts"."dim_url__dbt_backup" cascade
[0m02:11:58.154729 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:11:58.155507 [debug] [Thread-1 (]: On model.threat_risk.dim_url: Close
[0m02:11:58.154979 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m02:11:58.154851 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:11:58.155782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ede7d0>]}
[0m02:11:58.156391 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: ROLLBACK
[0m02:11:58.156895 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: ROLLBACK
[0m02:11:58.157171 [info ] [Thread-1 (]: 20 of 43 OK created sql table model marts.dim_url .............................. [[32mSELECT 42290[0m in 0.20s]
[0m02:11:58.157526 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: Close
[0m02:11:58.157754 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: Close
[0m02:11:58.157937 [debug] [Thread-1 (]: Finished running node model.threat_risk.dim_url
[0m02:11:58.158209 [info ] [Thread-4 (]: 32 of 43 PASS not_null_fact_kev_cve_id ......................................... [[32mPASS[0m in 0.03s]
[0m02:11:58.158517 [info ] [Thread-2 (]: 33 of 43 PASS not_null_fact_kev_date_day ....................................... [[32mPASS[0m in 0.02s]
[0m02:11:58.158831 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb
[0m02:11:58.159213 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m02:11:58.159447 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m02:11:58.160117 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b
[0m02:11:58.159923 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125
[0m02:11:58.159609 [info ] [Thread-1 (]: 34 of 43 START test not_null_fct_urlhaus_threat_events_event_id ................ [RUN]
[0m02:11:58.160876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.threat_risk.dim_url, now test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb)
[0m02:11:58.160563 [info ] [Thread-4 (]: 35 of 43 START test not_null_fct_urlhaus_threat_events_ingested_at ............. [RUN]
[0m02:11:58.160268 [info ] [Thread-2 (]: 36 of 43 START test not_null_fct_urlhaus_threat_events_url ..................... [RUN]
[0m02:11:58.161045 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb
[0m02:11:58.161250 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8, now test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125)
[0m02:11:58.161437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_date_day.64362f7a33, now test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b)
[0m02:11:58.163547 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b
[0m02:11:58.163376 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125
[0m02:11:58.163161 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"
[0m02:11:58.164940 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"
[0m02:11:58.166406 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"
[0m02:11:58.167104 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb
[0m02:11:58.167207 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b
[0m02:11:58.169112 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"
[0m02:11:58.168309 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"
[0m02:11:58.167550 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125
[0m02:11:58.170147 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"
[0m02:11:58.170428 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"
[0m02:11:58.170751 [debug] [Thread-2 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b: BEGIN
[0m02:11:58.171092 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:58.170897 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"
[0m02:11:58.171244 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"
[0m02:11:58.171495 [debug] [Thread-1 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb: BEGIN
[0m02:11:58.171956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:58.171816 [debug] [Thread-4 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125: BEGIN
[0m02:11:58.172303 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.176891 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:58.177183 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"
[0m02:11:58.177411 [debug] [Thread-2 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."fct_urlhaus_threat_events"
where url is null



      
    ) dbt_internal_test
[0m02:11:58.177554 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:58.177818 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"
[0m02:11:58.178086 [debug] [Thread-1 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "threat_risk"."marts"."fct_urlhaus_threat_events"
where event_id is null



      
    ) dbt_internal_test
[0m02:11:58.177982 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:58.178314 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"
[0m02:11:58.178506 [debug] [Thread-4 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingested_at
from "threat_risk"."marts"."fct_urlhaus_threat_events"
where ingested_at is null



      
    ) dbt_internal_test
[0m02:11:58.181028 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:11:58.181185 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:11:58.181313 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:11:58.183111 [debug] [Thread-4 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125: ROLLBACK
[0m02:11:58.182605 [debug] [Thread-2 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b: ROLLBACK
[0m02:11:58.182024 [debug] [Thread-1 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb: ROLLBACK
[0m02:11:58.183347 [debug] [Thread-4 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125: Close
[0m02:11:58.183561 [debug] [Thread-2 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b: Close
[0m02:11:58.183685 [debug] [Thread-1 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb: Close
[0m02:11:58.184594 [info ] [Thread-1 (]: 34 of 43 PASS not_null_fct_urlhaus_threat_events_event_id ...................... [[32mPASS[0m in 0.02s]
[0m02:11:58.184265 [info ] [Thread-2 (]: 36 of 43 PASS not_null_fct_urlhaus_threat_events_url ........................... [[32mPASS[0m in 0.02s]
[0m02:11:58.183947 [info ] [Thread-4 (]: 35 of 43 PASS not_null_fct_urlhaus_threat_events_ingested_at ................... [[32mPASS[0m in 0.02s]
[0m02:11:58.184898 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb
[0m02:11:58.185194 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b
[0m02:11:58.185461 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125
[0m02:11:58.186193 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m02:11:58.185978 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m02:11:58.185680 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4
[0m02:11:58.186949 [info ] [Thread-1 (]: 37 of 43 START test unique_fct_urlhaus_threat_events_event_id .................. [RUN]
[0m02:11:58.186671 [info ] [Thread-2 (]: 38 of 43 START test not_null_dim_url_url ....................................... [RUN]
[0m02:11:58.186373 [info ] [Thread-4 (]: 39 of 43 START test not_null_dim_url_url_key ................................... [RUN]
[0m02:11:58.187785 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125, now test.threat_risk.not_null_dim_url_url_key.89914b0872)
[0m02:11:58.187560 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b, now test.threat_risk.not_null_dim_url_url.2b67971659)
[0m02:11:58.187249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb, now test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4)
[0m02:11:58.187962 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m02:11:58.188188 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_url_url.2b67971659
[0m02:11:58.188404 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4
[0m02:11:58.190208 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m02:11:58.191821 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m02:11:58.193308 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"
[0m02:11:58.194125 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m02:11:58.194406 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_url_url.2b67971659
[0m02:11:58.195257 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m02:11:58.195431 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4
[0m02:11:58.197535 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m02:11:58.198572 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"
[0m02:11:58.199004 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m02:11:58.199546 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m02:11:58.199704 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: BEGIN
[0m02:11:58.200174 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.200017 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: BEGIN
[0m02:11:58.199919 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"
[0m02:11:58.200679 [debug] [Thread-1 (]: On test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4: BEGIN
[0m02:11:58.200465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:58.200860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:58.205620 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:58.205834 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m02:11:58.206003 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url_key.89914b0872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."dim_url"
where url_key is null



      
    ) dbt_internal_test
[0m02:11:58.206961 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:58.207168 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m02:11:58.207335 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url.2b67971659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."dim_url"
where url is null



      
    ) dbt_internal_test
[0m02:11:58.207798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m02:11:58.208005 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"
[0m02:11:58.208154 [debug] [Thread-1 (]: On test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."fct_urlhaus_threat_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:58.208873 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:11:58.209528 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: ROLLBACK
[0m02:11:58.209657 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:11:58.209890 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: Close
[0m02:11:58.210334 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: ROLLBACK
[0m02:11:58.210696 [info ] [Thread-4 (]: 39 of 43 PASS not_null_dim_url_url_key ......................................... [[32mPASS[0m in 0.02s]
[0m02:11:58.211025 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: Close
[0m02:11:58.211265 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m02:11:58.211599 [info ] [Thread-2 (]: 38 of 43 PASS not_null_dim_url_url ............................................. [[32mPASS[0m in 0.02s]
[0m02:11:58.211867 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m02:11:58.212200 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m02:11:58.212425 [info ] [Thread-4 (]: 40 of 43 START test unique_dim_url_url ......................................... [RUN]
[0m02:11:58.212751 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m02:11:58.213015 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url_key.89914b0872, now test.threat_risk.unique_dim_url_url.4c561dc36d)
[0m02:11:58.213251 [info ] [Thread-2 (]: 41 of 43 START test unique_dim_url_url_key ..................................... [RUN]
[0m02:11:58.213545 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m02:11:58.213813 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url.2b67971659, now test.threat_risk.unique_dim_url_url_key.d67ee5b979)
[0m02:11:58.215545 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m02:11:58.215715 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m02:11:58.215894 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m02:11:58.216680 [debug] [Thread-1 (]: On test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4: ROLLBACK
[0m02:11:58.218201 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m02:11:58.218366 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m02:11:58.218633 [debug] [Thread-1 (]: On test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4: Close
[0m02:11:58.219929 [info ] [Thread-1 (]: 37 of 43 PASS unique_fct_urlhaus_threat_events_event_id ........................ [[32mPASS[0m in 0.03s]
[0m02:11:58.219731 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m02:11:58.219530 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m02:11:58.220503 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4
[0m02:11:58.221675 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m02:11:58.222239 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m02:11:58.222486 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: BEGIN
[0m02:11:58.222762 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.222670 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m02:11:58.223167 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: BEGIN
[0m02:11:58.225861 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:11:58.229126 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m02:11:58.229606 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m02:11:58.230203 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url.4c561dc36d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:58.230772 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:58.230923 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m02:11:58.231071 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url_key.d67ee5b979"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url_key is not null
group by url_key
having count(*) > 1



      
    ) dbt_internal_test
[0m02:11:58.239257 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m02:11:58.239448 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m02:11:58.240076 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: ROLLBACK
[0m02:11:58.240590 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: ROLLBACK
[0m02:11:58.240902 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: Close
[0m02:11:58.241075 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: Close
[0m02:11:58.241361 [info ] [Thread-4 (]: 40 of 43 PASS unique_dim_url_url ............................................... [[32mPASS[0m in 0.03s]
[0m02:11:58.241827 [info ] [Thread-2 (]: 41 of 43 PASS unique_dim_url_url_key ........................................... [[32mPASS[0m in 0.03s]
[0m02:11:58.242119 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m02:11:58.242433 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m02:11:58.349728 [debug] [Thread-3 (]: SQL status: SELECT 259527 in 0.382 seconds
[0m02:11:58.351220 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m02:11:58.351437 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events" rename to "fact_url_events__dbt_backup"
[0m02:11:58.351858 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:58.352770 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m02:11:58.352968 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
alter table "threat_risk"."marts"."fact_url_events__dbt_tmp" rename to "fact_url_events"
[0m02:11:58.353276 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:11:58.353820 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: COMMIT
[0m02:11:58.354024 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m02:11:58.354199 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: COMMIT
[0m02:11:58.357480 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m02:11:58.358539 [debug] [Thread-3 (]: Applying DROP to: "threat_risk"."marts"."fact_url_events__dbt_backup"
[0m02:11:58.358823 [debug] [Thread-3 (]: Using postgres connection "model.threat_risk.fact_url_events"
[0m02:11:58.359008 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "model.threat_risk.fact_url_events"} */
drop table if exists "threat_risk"."marts"."fact_url_events__dbt_backup" cascade
[0m02:11:58.360737 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m02:11:58.361255 [debug] [Thread-3 (]: On model.threat_risk.fact_url_events: Close
[0m02:11:58.361563 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b5aed9-a3ea-466f-b1c9-cf790e8672f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa43fe3d0>]}
[0m02:11:58.361875 [info ] [Thread-3 (]: 21 of 43 OK created sql table model marts.fact_url_events ...................... [[32mSELECT 259527[0m in 0.41s]
[0m02:11:58.362192 [debug] [Thread-3 (]: Finished running node model.threat_risk.fact_url_events
[0m02:11:58.362730 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m02:11:58.362989 [info ] [Thread-1 (]: 42 of 43 START test not_null_fact_url_events_date_day .......................... [RUN]
[0m02:11:58.362855 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m02:11:58.363230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4, now test.threat_risk.not_null_fact_url_events_date_day.d658eee263)
[0m02:11:58.363454 [info ] [Thread-4 (]: 43 of 43 START test not_null_fact_url_events_url_key ........................... [RUN]
[0m02:11:58.363756 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m02:11:58.363974 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_url_url.4c561dc36d, now test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d)
[0m02:11:58.365635 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m02:11:58.365823 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m02:11:58.367339 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m02:11:58.367608 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m02:11:58.368416 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m02:11:58.368563 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m02:11:58.370365 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m02:11:58.370883 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m02:11:58.371112 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: BEGIN
[0m02:11:58.371254 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m02:11:58.371514 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: BEGIN
[0m02:11:58.371379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:58.371643 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:11:58.376280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:58.376455 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m02:11:58.376600 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_url_events"
where date_day is null



      
    ) dbt_internal_test
[0m02:11:58.377011 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m02:11:58.377146 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m02:11:58.377282 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."fact_url_events"
where url_key is null



      
    ) dbt_internal_test
[0m02:11:58.395072 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m02:11:58.395876 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: ROLLBACK
[0m02:11:58.395268 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.018 seconds
[0m02:11:58.396476 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: ROLLBACK
[0m02:11:58.396565 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: Close
[0m02:11:58.397051 [info ] [Thread-1 (]: 42 of 43 PASS not_null_fact_url_events_date_day ................................ [[32mPASS[0m in 0.03s]
[0m02:11:58.396807 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: Close
[0m02:11:58.397644 [info ] [Thread-4 (]: 43 of 43 PASS not_null_fact_url_events_url_key ................................. [[32mPASS[0m in 0.03s]
[0m02:11:58.397327 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m02:11:58.397966 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m02:11:58.398938 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:58.399121 [debug] [MainThread]: On master: BEGIN
[0m02:11:58.399262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:11:58.402526 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:11:58.402723 [debug] [MainThread]: On master: COMMIT
[0m02:11:58.402862 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:58.402991 [debug] [MainThread]: On master: COMMIT
[0m02:11:58.403181 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:11:58.403317 [debug] [MainThread]: On master: Close
[0m02:11:58.403501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:11:58.403744 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_date_day.d658eee263' was properly closed.
[0m02:11:58.403898 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url_key.d67ee5b979' was properly closed.
[0m02:11:58.404043 [debug] [MainThread]: Connection 'model.threat_risk.fact_url_events' was properly closed.
[0m02:11:58.404183 [debug] [MainThread]: Connection 'test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d' was properly closed.
[0m02:11:58.404395 [info ] [MainThread]: 
[0m02:11:58.404572 [info ] [MainThread]: Finished running 33 data tests, 3 view models, 6 table models, 1 incremental model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m02:11:58.406397 [debug] [MainThread]: Command end result
[0m02:11:58.423059 [info ] [MainThread]: 
[0m02:11:58.423290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:11:58.423582 [info ] [MainThread]: 
[0m02:11:58.423807 [info ] [MainThread]: Done. PASS=43 WARN=0 ERROR=0 SKIP=0 TOTAL=43
[0m02:11:58.424247 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.008649, "process_user_time": 1.184326, "process_kernel_time": 0.100027, "process_mem_max_rss": "125632", "process_out_blocks": "4285", "process_in_blocks": "0"}
[0m02:11:58.424470 [debug] [MainThread]: Command `dbt build` succeeded at 02:11:58.424434 after 1.01 seconds
[0m02:11:58.424652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8da3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb81610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f5c390>]}
[0m02:11:58.424820 [debug] [MainThread]: Flushing usage events
[0m02:44:34.894780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8aa2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8aa28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8aa2890>]}


============================== 02:44:34.897781 | c66c8a6f-890f-4d90-8396-d04502a9c504 ==============================
[0m02:44:34.897781 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:44:34.898105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:44:34.948119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c66c8a6f-890f-4d90-8396-d04502a9c504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d05f10>]}
[0m02:44:34.965070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c66c8a6f-890f-4d90-8396-d04502a9c504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7b773d0>]}
[0m02:44:34.965423 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:44:34.986908 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:44:35.035994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:44:35.036229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:44:35.052749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c66c8a6f-890f-4d90-8396-d04502a9c504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7952b50>]}
[0m02:44:35.106164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c66c8a6f-890f-4d90-8396-d04502a9c504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7608250>]}
[0m02:44:35.106519 [info ] [MainThread]: Found 10 models, 33 data tests, 1 source, 429 macros
[0m02:44:35.106746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c66c8a6f-890f-4d90-8396-d04502a9c504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7a84810>]}
[0m02:44:35.108285 [info ] [MainThread]: 
[0m02:44:35.108642 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:44:35.110953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk_marts'
[0m02:44:35.111275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_threat_risk_staging'
[0m02:44:35.128102 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m02:44:35.128284 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m02:44:35.128490 [debug] [ThreadPool]: On list_threat_risk_marts: BEGIN
[0m02:44:35.128692 [debug] [ThreadPool]: On list_threat_risk_staging: BEGIN
[0m02:44:35.128887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:35.129088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:35.135564 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m02:44:35.135747 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m02:44:35.135972 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_marts"
[0m02:44:35.136202 [debug] [ThreadPool]: Using postgres connection "list_threat_risk_staging"
[0m02:44:35.136397 [debug] [ThreadPool]: On list_threat_risk_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_marts"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m02:44:35.136612 [debug] [ThreadPool]: On list_threat_risk_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "list_threat_risk_staging"} */
select
      'threat_risk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'threat_risk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m02:44:35.138941 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m02:44:35.139080 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m02:44:35.139727 [debug] [ThreadPool]: On list_threat_risk_staging: ROLLBACK
[0m02:44:35.140278 [debug] [ThreadPool]: On list_threat_risk_marts: ROLLBACK
[0m02:44:35.140651 [debug] [ThreadPool]: On list_threat_risk_staging: Close
[0m02:44:35.140773 [debug] [ThreadPool]: On list_threat_risk_marts: Close
[0m02:44:35.144163 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:35.144507 [debug] [MainThread]: On master: BEGIN
[0m02:44:35.144682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:35.148720 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.148988 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:35.149192 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:44:35.152676 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m02:44:35.153255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c66c8a6f-890f-4d90-8396-d04502a9c504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d04b90>]}
[0m02:44:35.153488 [debug] [MainThread]: On master: ROLLBACK
[0m02:44:35.153720 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:35.153858 [debug] [MainThread]: On master: BEGIN
[0m02:44:35.154142 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:44:35.154306 [debug] [MainThread]: On master: COMMIT
[0m02:44:35.154448 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:35.154587 [debug] [MainThread]: On master: COMMIT
[0m02:44:35.154807 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:44:35.154966 [debug] [MainThread]: On master: Close
[0m02:44:35.155240 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:44:35.155494 [info ] [MainThread]: 
[0m02:44:35.159938 [debug] [Thread-1 (]: Began running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m02:44:35.160135 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m02:44:35.160282 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m02:44:35.160466 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m02:44:35.160642 [info ] [Thread-1 (]: 1 of 33 START test accepted_values_stg_urlhaus_url_status__online__offline__unknown  [RUN]
[0m02:44:35.161109 [info ] [Thread-2 (]: 2 of 33 START test not_null_dim_product_product ................................ [RUN]
[0m02:44:35.161445 [info ] [Thread-3 (]: 3 of 33 START test not_null_dim_product_product_key ............................ [RUN]
[0m02:44:35.161706 [info ] [Thread-4 (]: 4 of 33 START test not_null_dim_product_vendor_key ............................. [RUN]
[0m02:44:35.162082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_threat_risk_marts, now test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41)
[0m02:44:35.162335 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_threat_risk_staging, now test.threat_risk.not_null_dim_product_product.56a877bc84)
[0m02:44:35.162595 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.threat_risk.not_null_dim_product_product_key.f0e1d838d3'
[0m02:44:35.162851 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.threat_risk.not_null_dim_product_vendor_key.78836999d2'
[0m02:44:35.163131 [debug] [Thread-1 (]: Began compiling node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m02:44:35.163370 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m02:44:35.163603 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m02:44:35.163813 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m02:44:35.170516 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m02:44:35.173791 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m02:44:35.175396 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m02:44:35.177274 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m02:44:35.179186 [debug] [Thread-1 (]: Began executing node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m02:44:35.179382 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m02:44:35.179544 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m02:44:35.179679 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m02:44:35.185442 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m02:44:35.186607 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m02:44:35.188239 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m02:44:35.189174 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m02:44:35.190660 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m02:44:35.190816 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m02:44:35.191207 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m02:44:35.191525 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m02:44:35.191702 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: BEGIN
[0m02:44:35.192687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:35.192242 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: BEGIN
[0m02:44:35.192487 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m02:44:35.191998 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: BEGIN
[0m02:44:35.193904 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:44:35.193636 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:44:35.193167 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:44:35.198707 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m02:44:35.199082 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"
[0m02:44:35.199968 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        url_status as value_field,
        count(*) as n_records

    from "threat_risk"."staging"."stg_urlhaus"
    group by url_status

)

select *
from all_values
where value_field not in (
    'online','offline','unknown'
)



      
    ) dbt_internal_test
[0m02:44:35.201021 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m02:44:35.201236 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m02:44:35.201445 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m02:44:35.201677 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product.56a877bc84"
[0m02:44:35.202001 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"
[0m02:44:35.202282 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"
[0m02:44:35.202539 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product.56a877bc84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."marts"."dim_product"
where product is null



      
    ) dbt_internal_test
[0m02:44:35.202791 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_key.78836999d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_product"
where vendor_key is null



      
    ) dbt_internal_test
[0m02:44:35.203055 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "threat_risk"."marts"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m02:44:35.204053 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:44:35.204244 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:44:35.204389 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:44:35.206466 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: ROLLBACK
[0m02:44:35.207267 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: ROLLBACK
[0m02:44:35.208047 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m02:44:35.208475 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_product.56a877bc84: Close
[0m02:44:35.208706 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_product_vendor_key.78836999d2: Close
[0m02:44:35.209021 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_product_product_key.f0e1d838d3: Close
[0m02:44:35.209330 [info ] [Thread-2 (]: 2 of 33 PASS not_null_dim_product_product ...................................... [[32mPASS[0m in 0.05s]
[0m02:44:35.209693 [info ] [Thread-4 (]: 4 of 33 PASS not_null_dim_product_vendor_key ................................... [[32mPASS[0m in 0.05s]
[0m02:44:35.210690 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_product.56a877bc84
[0m02:44:35.211051 [info ] [Thread-3 (]: 3 of 33 PASS not_null_dim_product_product_key .................................. [[32mPASS[0m in 0.05s]
[0m02:44:35.211310 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_key.78836999d2
[0m02:44:35.211618 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m02:44:35.211983 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_product_product_key.f0e1d838d3
[0m02:44:35.212297 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m02:44:35.212586 [info ] [Thread-2 (]: 5 of 33 START test not_null_dim_product_vendor_project ......................... [RUN]
[0m02:44:35.212993 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m02:44:35.213293 [info ] [Thread-4 (]: 6 of 33 START test not_null_dim_url_url ........................................ [RUN]
[0m02:44:35.213701 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product.56a877bc84, now test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15)
[0m02:44:35.214009 [info ] [Thread-3 (]: 7 of 33 START test not_null_dim_url_url_key .................................... [RUN]
[0m02:44:35.214409 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_key.78836999d2, now test.threat_risk.not_null_dim_url_url.2b67971659)
[0m02:44:35.214694 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m02:44:35.215088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_product_key.f0e1d838d3, now test.threat_risk.not_null_dim_url_url_key.89914b0872)
[0m02:44:35.215356 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_dim_url_url.2b67971659
[0m02:44:35.217302 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m02:44:35.217602 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m02:44:35.219469 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m02:44:35.221115 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m02:44:35.221750 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m02:44:35.222867 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m02:44:35.223067 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_dim_url_url.2b67971659
[0m02:44:35.223657 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m02:44:35.224588 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m02:44:35.224885 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m02:44:35.225818 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m02:44:35.225989 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m02:44:35.226596 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: BEGIN
[0m02:44:35.226945 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m02:44:35.228251 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: BEGIN
[0m02:44:35.227939 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:44:35.228081 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m02:44:35.227715 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: ROLLBACK
[0m02:44:35.228382 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:44:35.228674 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: BEGIN
[0m02:44:35.228973 [debug] [Thread-1 (]: On test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41: Close
[0m02:44:35.229290 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:44:35.229631 [info ] [Thread-1 (]: 1 of 33 PASS accepted_values_stg_urlhaus_url_status__online__offline__unknown .. [[32mPASS[0m in 0.07s]
[0m02:44:35.230209 [debug] [Thread-1 (]: Finished running node test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41
[0m02:44:35.230486 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m02:44:35.230856 [info ] [Thread-1 (]: 8 of 33 START test not_null_dim_vendor_vendor_key .............................. [RUN]
[0m02:44:35.231222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.accepted_values_stg_urlhaus_url_status__online__offline__unknown.f20df3aa41, now test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba)
[0m02:44:35.231489 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m02:44:35.233267 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m02:44:35.233629 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m02:44:35.233939 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"
[0m02:44:35.234170 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_product"
where vendor_project is null



      
    ) dbt_internal_test
[0m02:44:35.234348 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m02:44:35.235882 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m02:44:35.236040 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:44:35.236315 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m02:44:35.236452 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m02:44:35.237659 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url.2b67971659"
[0m02:44:35.237331 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_dim_url_url_key.89914b0872"
[0m02:44:35.237471 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m02:44:35.237064 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: ROLLBACK
[0m02:44:35.237817 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url.2b67971659"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."dim_url"
where url is null



      
    ) dbt_internal_test
[0m02:44:35.238002 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_url_url_key.89914b0872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."dim_url"
where url_key is null



      
    ) dbt_internal_test
[0m02:44:35.238186 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: BEGIN
[0m02:44:35.238407 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15: Close
[0m02:44:35.238750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:35.239143 [info ] [Thread-2 (]: 5 of 33 PASS not_null_dim_product_vendor_project ............................... [[32mPASS[0m in 0.03s]
[0m02:44:35.239610 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15
[0m02:44:35.239895 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m02:44:35.240175 [info ] [Thread-2 (]: 9 of 33 START test not_null_dim_vendor_vendor_project .......................... [RUN]
[0m02:44:35.240482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_product_vendor_project.11c5bb4b15, now test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393)
[0m02:44:35.240741 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m02:44:35.242586 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m02:44:35.242778 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:44:35.242983 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:44:35.243194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.243868 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: ROLLBACK
[0m02:44:35.244445 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: ROLLBACK
[0m02:44:35.244621 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m02:44:35.244828 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"
[0m02:44:35.246479 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_key
from "threat_risk"."marts"."dim_vendor"
where vendor_key is null



      
    ) dbt_internal_test
[0m02:44:35.245335 [debug] [Thread-4 (]: On test.threat_risk.not_null_dim_url_url.2b67971659: Close
[0m02:44:35.246292 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m02:44:35.245105 [debug] [Thread-3 (]: On test.threat_risk.not_null_dim_url_url_key.89914b0872: Close
[0m02:44:35.246850 [info ] [Thread-4 (]: 6 of 33 PASS not_null_dim_url_url .............................................. [[32mPASS[0m in 0.03s]
[0m02:44:35.247292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:44:35.247578 [info ] [Thread-3 (]: 7 of 33 PASS not_null_dim_url_url_key .......................................... [[32mPASS[0m in 0.03s]
[0m02:44:35.247940 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m02:44:35.248157 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_dim_url_url.2b67971659
[0m02:44:35.248765 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: ROLLBACK
[0m02:44:35.248994 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_dim_url_url_key.89914b0872
[0m02:44:35.249187 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: BEGIN
[0m02:44:35.249421 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m02:44:35.249754 [debug] [Thread-1 (]: On test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba: Close
[0m02:44:35.249898 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m02:44:35.250121 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:44:35.250339 [info ] [Thread-4 (]: 10 of 33 START test not_null_fact_kev_cve_id ................................... [RUN]
[0m02:44:35.250696 [info ] [Thread-1 (]: 8 of 33 PASS not_null_dim_vendor_vendor_key .................................... [[32mPASS[0m in 0.02s]
[0m02:44:35.251039 [info ] [Thread-3 (]: 11 of 33 START test not_null_fact_kev_date_day ................................. [RUN]
[0m02:44:35.251539 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url.2b67971659, now test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8)
[0m02:44:35.251838 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba
[0m02:44:35.252512 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m02:44:35.252296 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m02:44:35.252071 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_url_url_key.89914b0872, now test.threat_risk.not_null_fact_kev_date_day.64362f7a33)
[0m02:44:35.252724 [info ] [Thread-1 (]: 12 of 33 START test not_null_fact_url_events_date_day .......................... [RUN]
[0m02:44:35.255307 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m02:44:35.255568 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m02:44:35.255726 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m02:44:35.255959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_key.385212c4ba, now test.threat_risk.not_null_fact_url_events_date_day.d658eee263)
[0m02:44:35.286231 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m02:44:35.285798 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"
[0m02:44:35.286021 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m02:44:35.285382 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m02:44:35.287809 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m02:44:35.288071 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."marts"."dim_vendor"
where vendor_project is null



      
    ) dbt_internal_test
[0m02:44:35.289046 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m02:44:35.289936 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m02:44:35.290307 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m02:44:35.290481 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:44:35.291345 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m02:44:35.292261 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m02:44:35.292446 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m02:44:35.293112 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: ROLLBACK
[0m02:44:35.293802 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m02:44:35.293955 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: BEGIN
[0m02:44:35.294624 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:44:35.294351 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: BEGIN
[0m02:44:35.294475 [debug] [Thread-2 (]: On test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393: Close
[0m02:44:35.294140 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m02:44:35.294940 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:44:35.295363 [info ] [Thread-2 (]: 9 of 33 PASS not_null_dim_vendor_vendor_project ................................ [[32mPASS[0m in 0.05s]
[0m02:44:35.295683 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: BEGIN
[0m02:44:35.296388 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393
[0m02:44:35.296596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:35.296849 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m02:44:35.297513 [info ] [Thread-2 (]: 13 of 33 START test not_null_fact_url_events_url_key ........................... [RUN]
[0m02:44:35.298265 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_dim_vendor_vendor_project.fffca61393, now test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d)
[0m02:44:35.298835 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.299279 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"
[0m02:44:35.299047 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m02:44:35.300040 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."marts"."fact_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m02:44:35.302017 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m02:44:35.302389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m02:44:35.302558 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m02:44:35.302946 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"
[0m02:44:35.303182 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m02:44:35.303313 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"
[0m02:44:35.303542 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_date_day.d658eee263"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_url_events"
where date_day is null



      
    ) dbt_internal_test
[0m02:44:35.304519 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m02:44:35.304730 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_kev_date_day.64362f7a33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_day
from "threat_risk"."marts"."fact_kev"
where date_day is null



      
    ) dbt_internal_test
[0m02:44:35.305333 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m02:44:35.305539 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: BEGIN
[0m02:44:35.305783 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:44:35.306651 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:44:35.307371 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: ROLLBACK
[0m02:44:35.307513 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:44:35.307797 [debug] [Thread-4 (]: On test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8: Close
[0m02:44:35.308775 [info ] [Thread-4 (]: 10 of 33 PASS not_null_fact_kev_cve_id ......................................... [[32mPASS[0m in 0.06s]
[0m02:44:35.308372 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: ROLLBACK
[0m02:44:35.309260 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8
[0m02:44:35.309814 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb
[0m02:44:35.309646 [debug] [Thread-3 (]: On test.threat_risk.not_null_fact_kev_date_day.64362f7a33: Close
[0m02:44:35.309980 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.310189 [info ] [Thread-4 (]: 14 of 33 START test not_null_fct_urlhaus_threat_events_event_id ................ [RUN]
[0m02:44:35.311052 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_cve_id.5017fad5b8, now test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb)
[0m02:44:35.310808 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"
[0m02:44:35.310587 [info ] [Thread-3 (]: 11 of 33 PASS not_null_fact_kev_date_day ....................................... [[32mPASS[0m in 0.06s]
[0m02:44:35.311678 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fact_kev_date_day.64362f7a33
[0m02:44:35.311449 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_key
from "threat_risk"."marts"."fact_url_events"
where url_key is null



      
    ) dbt_internal_test
[0m02:44:35.311223 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb
[0m02:44:35.311886 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125
[0m02:44:35.314078 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"
[0m02:44:35.314493 [info ] [Thread-3 (]: 15 of 33 START test not_null_fct_urlhaus_threat_events_ingested_at ............. [RUN]
[0m02:44:35.315257 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_kev_date_day.64362f7a33, now test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125)
[0m02:44:35.315527 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125
[0m02:44:35.317624 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"
[0m02:44:35.317876 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb
[0m02:44:35.319178 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"
[0m02:44:35.319328 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m02:44:35.320073 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: ROLLBACK
[0m02:44:35.320271 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125
[0m02:44:35.320595 [debug] [Thread-1 (]: On test.threat_risk.not_null_fact_url_events_date_day.d658eee263: Close
[0m02:44:35.321526 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"
[0m02:44:35.321694 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"
[0m02:44:35.321837 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m02:44:35.322115 [info ] [Thread-1 (]: 12 of 33 PASS not_null_fact_url_events_date_day ................................ [[32mPASS[0m in 0.07s]
[0m02:44:35.322524 [debug] [Thread-4 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb: BEGIN
[0m02:44:35.322750 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"
[0m02:44:35.323276 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: ROLLBACK
[0m02:44:35.323542 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fact_url_events_date_day.d658eee263
[0m02:44:35.324161 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b
[0m02:44:35.323878 [debug] [Thread-3 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125: BEGIN
[0m02:44:35.323713 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:44:35.324272 [debug] [Thread-2 (]: On test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d: Close
[0m02:44:35.324459 [info ] [Thread-1 (]: 16 of 33 START test not_null_fct_urlhaus_threat_events_url ..................... [RUN]
[0m02:44:35.324675 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:44:35.325129 [info ] [Thread-2 (]: 13 of 33 PASS not_null_fact_url_events_url_key ................................. [[32mPASS[0m in 0.03s]
[0m02:44:35.325343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_url_events_date_day.d658eee263, now test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b)
[0m02:44:35.325841 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d
[0m02:44:35.327754 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b
[0m02:44:35.328105 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m02:44:35.330840 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"
[0m02:44:35.331128 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m02:44:35.331373 [info ] [Thread-2 (]: 17 of 33 START test not_null_stg_kev_cve_id .................................... [RUN]
[0m02:44:35.331516 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m02:44:35.331999 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"
[0m02:44:35.332237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fact_url_events_url_key.1fd764f61d, now test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0)
[0m02:44:35.332447 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b
[0m02:44:35.332552 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"
[0m02:44:35.334058 [debug] [Thread-3 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingested_at
from "threat_risk"."marts"."fct_urlhaus_threat_events"
where ingested_at is null



      
    ) dbt_internal_test
[0m02:44:35.332907 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m02:44:35.333873 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"
[0m02:44:35.332723 [debug] [Thread-4 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "threat_risk"."marts"."fct_urlhaus_threat_events"
where event_id is null



      
    ) dbt_internal_test
[0m02:44:35.335613 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m02:44:35.335758 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:44:35.336390 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"
[0m02:44:35.337484 [debug] [Thread-1 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b: BEGIN
[0m02:44:35.337220 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m02:44:35.337339 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:44:35.337068 [debug] [Thread-3 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125: ROLLBACK
[0m02:44:35.337622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:35.338509 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m02:44:35.339068 [debug] [Thread-4 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb: ROLLBACK
[0m02:44:35.339299 [debug] [Thread-3 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125: Close
[0m02:44:35.339779 [debug] [Thread-4 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb: Close
[0m02:44:35.340092 [info ] [Thread-3 (]: 15 of 33 PASS not_null_fct_urlhaus_threat_events_ingested_at ................... [[32mPASS[0m in 0.02s]
[0m02:44:35.340321 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m02:44:35.341519 [info ] [Thread-4 (]: 14 of 33 PASS not_null_fct_urlhaus_threat_events_event_id ...................... [[32mPASS[0m in 0.03s]
[0m02:44:35.342333 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb
[0m02:44:35.342017 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: BEGIN
[0m02:44:35.341810 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125
[0m02:44:35.342529 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m02:44:35.342721 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:44:35.342929 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m02:44:35.343077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m02:44:35.343272 [info ] [Thread-4 (]: 18 of 33 START test not_null_stg_kev_product ................................... [RUN]
[0m02:44:35.344400 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fct_urlhaus_threat_events_event_id.ffb41112bb, now test.threat_risk.not_null_stg_kev_product.9b2d2b4877)
[0m02:44:35.344176 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"
[0m02:44:35.343760 [info ] [Thread-3 (]: 19 of 33 START test not_null_stg_kev_run_date .................................. [RUN]
[0m02:44:35.344554 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m02:44:35.344748 [debug] [Thread-1 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."marts"."fct_urlhaus_threat_events"
where url is null



      
    ) dbt_internal_test
[0m02:44:35.344951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fct_urlhaus_threat_events_ingested_at.e4eeaf8125, now test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe)
[0m02:44:35.347183 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m02:44:35.346958 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.346648 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m02:44:35.348777 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m02:44:35.348950 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:44:35.349129 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"
[0m02:44:35.350034 [debug] [Thread-1 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b: ROLLBACK
[0m02:44:35.350197 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m02:44:35.350368 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m02:44:35.350488 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cve_id
from "threat_risk"."staging"."stg_kev"
where cve_id is null



      
    ) dbt_internal_test
[0m02:44:35.350717 [debug] [Thread-1 (]: On test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b: Close
[0m02:44:35.351615 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m02:44:35.352458 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m02:44:35.352794 [info ] [Thread-1 (]: 16 of 33 PASS not_null_fct_urlhaus_threat_events_url ........................... [[32mPASS[0m in 0.03s]
[0m02:44:35.353768 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b
[0m02:44:35.353602 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m02:44:35.354373 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: BEGIN
[0m02:44:35.354186 [debug] [Thread-1 (]: Began running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m02:44:35.354032 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m02:44:35.354520 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:44:35.354723 [info ] [Thread-1 (]: 20 of 33 START test not_null_stg_kev_vendor_project ............................ [RUN]
[0m02:44:35.355028 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: BEGIN
[0m02:44:35.355486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_fct_urlhaus_threat_events_url.44a286cf5b, now test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89)
[0m02:44:35.355716 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:44:35.355903 [debug] [Thread-1 (]: Began compiling node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m02:44:35.359546 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m02:44:35.359879 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m02:44:35.360009 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.360461 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"
[0m02:44:35.360321 [debug] [Thread-1 (]: Began executing node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m02:44:35.360215 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"
[0m02:44:35.360597 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_kev"
where run_date is null



      
    ) dbt_internal_test
[0m02:44:35.361748 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m02:44:35.361899 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m02:44:35.362072 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_product.9b2d2b4877"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product
from "threat_risk"."staging"."stg_kev"
where product is null



      
    ) dbt_internal_test
[0m02:44:35.363062 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: ROLLBACK
[0m02:44:35.363307 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m02:44:35.363703 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: BEGIN
[0m02:44:35.363837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:35.363603 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0: Close
[0m02:44:35.364296 [info ] [Thread-2 (]: 17 of 33 PASS not_null_stg_kev_cve_id .......................................... [[32mPASS[0m in 0.03s]
[0m02:44:35.364706 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0
[0m02:44:35.364976 [debug] [Thread-2 (]: Began running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m02:44:35.365265 [info ] [Thread-2 (]: 21 of 33 START test not_null_stg_urlhaus_run_date .............................. [RUN]
[0m02:44:35.366120 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_cve_id.2f20f2bcb0, now test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93)
[0m02:44:35.366323 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:44:35.366996 [debug] [Thread-2 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m02:44:35.367124 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m02:44:35.367742 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: ROLLBACK
[0m02:44:35.369451 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m02:44:35.369641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m02:44:35.370264 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: ROLLBACK
[0m02:44:35.370599 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe: Close
[0m02:44:35.370771 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"
[0m02:44:35.370979 [debug] [Thread-2 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m02:44:35.371097 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_kev_product.9b2d2b4877: Close
[0m02:44:35.371374 [info ] [Thread-3 (]: 19 of 33 PASS not_null_stg_kev_run_date ........................................ [[32mPASS[0m in 0.03s]
[0m02:44:35.371613 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_project
from "threat_risk"."staging"."stg_kev"
where vendor_project is null



      
    ) dbt_internal_test
[0m02:44:35.372724 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m02:44:35.373046 [info ] [Thread-4 (]: 18 of 33 PASS not_null_stg_kev_product ......................................... [[32mPASS[0m in 0.03s]
[0m02:44:35.373255 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe
[0m02:44:35.373967 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_kev_product.9b2d2b4877
[0m02:44:35.374511 [debug] [Thread-4 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m02:44:35.374360 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m02:44:35.374170 [debug] [Thread-3 (]: Began running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m02:44:35.374666 [info ] [Thread-4 (]: 23 of 33 START test not_null_stg_urlhaus_url_status ............................ [RUN]
[0m02:44:35.375341 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_product.9b2d2b4877, now test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd)
[0m02:44:35.375093 [info ] [Thread-3 (]: 22 of 33 START test not_null_stg_urlhaus_url ................................... [RUN]
[0m02:44:35.374872 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: BEGIN
[0m02:44:35.375807 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:44:35.375661 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_run_date.5518d7c0fe, now test.threat_risk.not_null_stg_urlhaus_url.8004f29367)
[0m02:44:35.375487 [debug] [Thread-4 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m02:44:35.376063 [debug] [Thread-3 (]: Began compiling node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m02:44:35.378712 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m02:44:35.380591 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m02:44:35.380790 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m02:44:35.381244 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m02:44:35.382185 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: ROLLBACK
[0m02:44:35.382695 [debug] [Thread-4 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m02:44:35.382826 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"
[0m02:44:35.382970 [debug] [Thread-3 (]: Began executing node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m02:44:35.383228 [debug] [Thread-1 (]: On test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89: Close
[0m02:44:35.384218 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m02:44:35.384433 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select run_date
from "threat_risk"."staging"."stg_urlhaus"
where run_date is null



      
    ) dbt_internal_test
[0m02:44:35.385485 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m02:44:35.386004 [info ] [Thread-1 (]: 20 of 33 PASS not_null_stg_kev_vendor_project .................................. [[32mPASS[0m in 0.03s]
[0m02:44:35.387150 [debug] [Thread-1 (]: Finished running node test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89
[0m02:44:35.386765 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m02:44:35.387749 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: BEGIN
[0m02:44:35.387588 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m02:44:35.387369 [debug] [Thread-1 (]: Began running node test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26
[0m02:44:35.387891 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:44:35.388070 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: BEGIN
[0m02:44:35.388254 [info ] [Thread-1 (]: 24 of 33 START test source_not_null_raw_urlhaus_events_event_id ................ [RUN]
[0m02:44:35.388825 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:44:35.389297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_kev_vendor_project.464f7a6e89, now test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26)
[0m02:44:35.390300 [debug] [Thread-1 (]: Began compiling node test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26
[0m02:44:35.392163 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"
[0m02:44:35.393103 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m02:44:35.393762 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"
[0m02:44:35.394106 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url_status
from "threat_risk"."staging"."stg_urlhaus"
where url_status is null



      
    ) dbt_internal_test
[0m02:44:35.394263 [debug] [Thread-1 (]: Began executing node test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26
[0m02:44:35.394444 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m02:44:35.395530 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"
[0m02:44:35.395867 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"
[0m02:44:35.396313 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.not_null_stg_urlhaus_url.8004f29367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "threat_risk"."staging"."stg_urlhaus"
where url is null



      
    ) dbt_internal_test
[0m02:44:35.396985 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"
[0m02:44:35.397372 [debug] [Thread-1 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26: BEGIN
[0m02:44:35.397799 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m02:44:35.398238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:35.399445 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: ROLLBACK
[0m02:44:35.400398 [debug] [Thread-2 (]: On test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93: Close
[0m02:44:35.400804 [info ] [Thread-2 (]: 21 of 33 PASS not_null_stg_urlhaus_run_date .................................... [[32mPASS[0m in 0.03s]
[0m02:44:35.403238 [debug] [Thread-2 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93
[0m02:44:35.404485 [debug] [Thread-2 (]: Began running node test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3
[0m02:44:35.404841 [info ] [Thread-2 (]: 25 of 33 START test source_not_null_raw_urlhaus_events_ingested_at ............. [RUN]
[0m02:44:35.405663 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_run_date.c419682d93, now test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3)
[0m02:44:35.406181 [debug] [Thread-2 (]: Began compiling node test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3
[0m02:44:35.405890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:44:35.408578 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"
[0m02:44:35.408325 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"
[0m02:44:35.408764 [debug] [Thread-1 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from "threat_risk"."raw"."urlhaus_events"
where event_id is null



      
    ) dbt_internal_test
[0m02:44:35.409968 [debug] [Thread-2 (]: Began executing node test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3
[0m02:44:35.411770 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"
[0m02:44:35.411990 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m02:44:35.412197 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:44:35.412994 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: ROLLBACK
[0m02:44:35.413665 [debug] [Thread-1 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26: ROLLBACK
[0m02:44:35.413832 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"
[0m02:44:35.414328 [debug] [Thread-4 (]: On test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd: Close
[0m02:44:35.414457 [debug] [Thread-1 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26: Close
[0m02:44:35.414634 [debug] [Thread-2 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3: BEGIN
[0m02:44:35.415263 [info ] [Thread-1 (]: 24 of 33 PASS source_not_null_raw_urlhaus_events_event_id ...................... [[32mPASS[0m in 0.03s]
[0m02:44:35.414995 [info ] [Thread-4 (]: 23 of 33 PASS not_null_stg_urlhaus_url_status .................................. [[32mPASS[0m in 0.04s]
[0m02:44:35.415792 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:44:35.416212 [debug] [Thread-1 (]: Finished running node test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26
[0m02:44:35.416464 [debug] [Thread-4 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd
[0m02:44:35.417297 [debug] [Thread-4 (]: Began running node test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286
[0m02:44:35.417070 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.021 seconds
[0m02:44:35.416862 [debug] [Thread-1 (]: Began running node test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67
[0m02:44:35.418619 [info ] [Thread-1 (]: 26 of 33 START test source_not_null_raw_urlhaus_events_source .................. [RUN]
[0m02:44:35.418371 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: ROLLBACK
[0m02:44:35.417540 [info ] [Thread-4 (]: 27 of 33 START test source_unique_raw_urlhaus_events_event_id .................. [RUN]
[0m02:44:35.419350 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url_status.36094b12bd, now test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286)
[0m02:44:35.419015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.source_not_null_raw_urlhaus_events_event_id.4d5545ab26, now test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67)
[0m02:44:35.419473 [debug] [Thread-3 (]: On test.threat_risk.not_null_stg_urlhaus_url.8004f29367: Close
[0m02:44:35.419630 [debug] [Thread-4 (]: Began compiling node test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286
[0m02:44:35.419775 [debug] [Thread-1 (]: Began compiling node test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67
[0m02:44:35.420066 [info ] [Thread-3 (]: 22 of 33 PASS not_null_stg_urlhaus_url ......................................... [[32mPASS[0m in 0.04s]
[0m02:44:35.420231 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.423295 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"
[0m02:44:35.424810 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"
[0m02:44:35.425088 [debug] [Thread-3 (]: Finished running node test.threat_risk.not_null_stg_urlhaus_url.8004f29367
[0m02:44:35.425301 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"
[0m02:44:35.426111 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m02:44:35.426486 [debug] [Thread-4 (]: Began executing node test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286
[0m02:44:35.426759 [debug] [Thread-2 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingested_at
from "threat_risk"."raw"."urlhaus_events"
where ingested_at is null



      
    ) dbt_internal_test
[0m02:44:35.426622 [debug] [Thread-1 (]: Began executing node test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67
[0m02:44:35.427009 [info ] [Thread-3 (]: 28 of 33 START test unique_dim_product_product_key ............................. [RUN]
[0m02:44:35.429550 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.not_null_stg_urlhaus_url.8004f29367, now test.threat_risk.unique_dim_product_product_key.1753236bd0)
[0m02:44:35.429198 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"
[0m02:44:35.429340 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:44:35.428180 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"
[0m02:44:35.429730 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m02:44:35.431938 [debug] [Thread-2 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3: ROLLBACK
[0m02:44:35.432258 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"
[0m02:44:35.434262 [debug] [Thread-1 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67: BEGIN
[0m02:44:35.433974 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"
[0m02:44:35.434083 [debug] [Thread-2 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3: Close
[0m02:44:35.433721 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m02:44:35.434410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:35.434702 [debug] [Thread-4 (]: On test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286: BEGIN
[0m02:44:35.435106 [info ] [Thread-2 (]: 25 of 33 PASS source_not_null_raw_urlhaus_events_ingested_at ................... [[32mPASS[0m in 0.03s]
[0m02:44:35.435870 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:44:35.436134 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m02:44:35.436351 [debug] [Thread-2 (]: Finished running node test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3
[0m02:44:35.437569 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m02:44:35.437829 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m02:44:35.440211 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.440379 [info ] [Thread-2 (]: 29 of 33 START test unique_dim_url_url ......................................... [RUN]
[0m02:44:35.440667 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"
[0m02:44:35.440979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m02:44:35.441198 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m02:44:35.441341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.source_not_null_raw_urlhaus_events_ingested_at.fbe25572a3, now test.threat_risk.unique_dim_url_url.4c561dc36d)
[0m02:44:35.442076 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m02:44:35.441714 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"
[0m02:44:35.441897 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: BEGIN
[0m02:44:35.441533 [debug] [Thread-4 (]: On test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "threat_risk"."raw"."urlhaus_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:44:35.443869 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m02:44:35.444163 [debug] [Thread-1 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select source
from "threat_risk"."raw"."urlhaus_events"
where source is null



      
    ) dbt_internal_test
[0m02:44:35.444398 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:44:35.445021 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m02:44:35.446049 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m02:44:35.446562 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m02:44:35.446780 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: BEGIN
[0m02:44:35.447043 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:44:35.448612 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.449049 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_product_product_key.1753236bd0"
[0m02:44:35.450256 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m02:44:35.450962 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.451158 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_dim_url_url.4c561dc36d"
[0m02:44:35.451380 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url.4c561dc36d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m02:44:35.451551 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:44:35.452358 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m02:44:35.452619 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_product_product_key.1753236bd0: Close
[0m02:44:35.453002 [info ] [Thread-3 (]: 28 of 33 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.02s]
[0m02:44:35.453284 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m02:44:35.453524 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_product_product_key.1753236bd0
[0m02:44:35.454164 [debug] [Thread-1 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67: ROLLBACK
[0m02:44:35.454403 [debug] [Thread-3 (]: Began running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m02:44:35.454596 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m02:44:35.454794 [info ] [Thread-3 (]: 30 of 33 START test unique_dim_url_url_key ..................................... [RUN]
[0m02:44:35.455010 [debug] [Thread-1 (]: On test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67: Close
[0m02:44:35.455612 [debug] [Thread-4 (]: On test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286: ROLLBACK
[0m02:44:35.455838 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_product_product_key.1753236bd0, now test.threat_risk.unique_dim_url_url_key.d67ee5b979)
[0m02:44:35.456154 [info ] [Thread-1 (]: 26 of 33 PASS source_not_null_raw_urlhaus_events_source ........................ [[32mPASS[0m in 0.04s]
[0m02:44:35.456498 [debug] [Thread-4 (]: On test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286: Close
[0m02:44:35.456649 [debug] [Thread-3 (]: Began compiling node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m02:44:35.456976 [debug] [Thread-1 (]: Finished running node test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67
[0m02:44:35.457270 [info ] [Thread-4 (]: 27 of 33 PASS source_unique_raw_urlhaus_events_event_id ........................ [[32mPASS[0m in 0.04s]
[0m02:44:35.459127 [debug] [Thread-3 (]: Writing injected SQL for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m02:44:35.459433 [debug] [Thread-1 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m02:44:35.459802 [debug] [Thread-4 (]: Finished running node test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286
[0m02:44:35.460299 [info ] [Thread-1 (]: 31 of 33 START test unique_dim_vendor_vendor_key ............................... [RUN]
[0m02:44:35.460621 [debug] [Thread-3 (]: Began executing node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m02:44:35.460849 [debug] [Thread-4 (]: Began running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m02:44:35.461055 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m02:44:35.461215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.threat_risk.source_not_null_raw_urlhaus_events_source.b19ca54d67, now test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68)
[0m02:44:35.462258 [debug] [Thread-3 (]: Writing runtime sql for node "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m02:44:35.462455 [info ] [Thread-4 (]: 32 of 33 START test unique_dim_vendor_vendor_project ........................... [RUN]
[0m02:44:35.463131 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: ROLLBACK
[0m02:44:35.463310 [debug] [Thread-1 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m02:44:35.463670 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.threat_risk.source_unique_raw_urlhaus_events_event_id.b2983b7286, now test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96)
[0m02:44:35.464025 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m02:44:35.464150 [debug] [Thread-2 (]: On test.threat_risk.unique_dim_url_url.4c561dc36d: Close
[0m02:44:35.465832 [debug] [Thread-1 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m02:44:35.466055 [debug] [Thread-4 (]: Began compiling node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m02:44:35.466266 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: BEGIN
[0m02:44:35.466607 [info ] [Thread-2 (]: 29 of 33 PASS unique_dim_url_url ............................................... [[32mPASS[0m in 0.03s]
[0m02:44:35.469322 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_dim_url_url.4c561dc36d
[0m02:44:35.468913 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:44:35.469070 [debug] [Thread-1 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m02:44:35.468627 [debug] [Thread-4 (]: Writing injected SQL for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m02:44:35.469498 [debug] [Thread-2 (]: Began running node test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4
[0m02:44:35.470702 [debug] [Thread-1 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m02:44:35.471837 [debug] [Thread-4 (]: Began executing node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m02:44:35.471513 [info ] [Thread-2 (]: 33 of 33 START test unique_fct_urlhaus_threat_events_event_id .................. [RUN]
[0m02:44:35.473077 [debug] [Thread-4 (]: Writing runtime sql for node "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m02:44:35.473389 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m02:44:35.473651 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.threat_risk.unique_dim_url_url.4c561dc36d, now test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4)
[0m02:44:35.474151 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: BEGIN
[0m02:44:35.474644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:35.474489 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m02:44:35.474332 [debug] [Thread-2 (]: Began compiling node test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4
[0m02:44:35.474944 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: BEGIN
[0m02:44:35.476635 [debug] [Thread-2 (]: Writing injected SQL for node "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"
[0m02:44:35.476793 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m02:44:35.476970 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:44:35.477392 [debug] [Thread-3 (]: Using postgres connection "test.threat_risk.unique_dim_url_url_key.d67ee5b979"
[0m02:44:35.477629 [debug] [Thread-2 (]: Began executing node test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4
[0m02:44:35.477977 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_url_url_key.d67ee5b979"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_url"
where url_key is not null
group by url_key
having count(*) > 1



      
    ) dbt_internal_test
[0m02:44:35.480117 [debug] [Thread-2 (]: Writing runtime sql for node "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"
[0m02:44:35.480423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m02:44:35.480798 [debug] [Thread-1 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"
[0m02:44:35.481063 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"
[0m02:44:35.481219 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.481355 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_key as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_key is not null
group by vendor_key
having count(*) > 1



      
    ) dbt_internal_test
[0m02:44:35.481562 [debug] [Thread-2 (]: On test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4: BEGIN
[0m02:44:35.481814 [debug] [Thread-4 (]: Using postgres connection "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"
[0m02:44:35.482271 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:44:35.482554 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    vendor_project as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."dim_vendor"
where vendor_project is not null
group by vendor_project
having count(*) > 1



      
    ) dbt_internal_test
[0m02:44:35.482932 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:44:35.483698 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: ROLLBACK
[0m02:44:35.483822 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:44:35.484125 [debug] [Thread-1 (]: On test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68: Close
[0m02:44:35.485754 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: ROLLBACK
[0m02:44:35.486144 [info ] [Thread-1 (]: 31 of 33 PASS unique_dim_vendor_vendor_key ..................................... [[32mPASS[0m in 0.02s]
[0m02:44:35.486531 [debug] [Thread-4 (]: On test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96: Close
[0m02:44:35.486690 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.487337 [debug] [Thread-2 (]: Using postgres connection "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"
[0m02:44:35.487148 [info ] [Thread-4 (]: 32 of 33 PASS unique_dim_vendor_vendor_project ................................. [[32mPASS[0m in 0.02s]
[0m02:44:35.486863 [debug] [Thread-1 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68
[0m02:44:35.487519 [debug] [Thread-2 (]: On test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "threat_risk", "target_name": "dev", "node_id": "test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "threat_risk"."marts"."fct_urlhaus_threat_events"
where event_id is not null
group by event_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:44:35.487772 [debug] [Thread-4 (]: Finished running node test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96
[0m02:44:35.488947 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m02:44:35.489537 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: ROLLBACK
[0m02:44:35.489804 [debug] [Thread-3 (]: On test.threat_risk.unique_dim_url_url_key.d67ee5b979: Close
[0m02:44:35.490121 [info ] [Thread-3 (]: 30 of 33 PASS unique_dim_url_url_key ........................................... [[32mPASS[0m in 0.03s]
[0m02:44:35.490410 [debug] [Thread-3 (]: Finished running node test.threat_risk.unique_dim_url_url_key.d67ee5b979
[0m02:44:35.492946 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m02:44:35.493598 [debug] [Thread-2 (]: On test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4: ROLLBACK
[0m02:44:35.493952 [debug] [Thread-2 (]: On test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4: Close
[0m02:44:35.494291 [info ] [Thread-2 (]: 33 of 33 PASS unique_fct_urlhaus_threat_events_event_id ........................ [[32mPASS[0m in 0.02s]
[0m02:44:35.494602 [debug] [Thread-2 (]: Finished running node test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4
[0m02:44:35.495519 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:35.495703 [debug] [MainThread]: On master: BEGIN
[0m02:44:35.495860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:44:35.499514 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:44:35.499765 [debug] [MainThread]: On master: COMMIT
[0m02:44:35.499913 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:35.500102 [debug] [MainThread]: On master: COMMIT
[0m02:44:35.500351 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:44:35.500543 [debug] [MainThread]: On master: Close
[0m02:44:35.500778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:35.500947 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_vendor_vendor_key.3de6f52c68' was properly closed.
[0m02:44:35.501100 [debug] [MainThread]: Connection 'test.threat_risk.unique_fct_urlhaus_threat_events_event_id.9c126292e4' was properly closed.
[0m02:44:35.501353 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_url_url_key.d67ee5b979' was properly closed.
[0m02:44:35.501563 [debug] [MainThread]: Connection 'test.threat_risk.unique_dim_vendor_vendor_project.ceb940ca96' was properly closed.
[0m02:44:35.501837 [info ] [MainThread]: 
[0m02:44:35.502083 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m02:44:35.503629 [debug] [MainThread]: Command end result
[0m02:44:35.528434 [info ] [MainThread]: 
[0m02:44:35.528776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:44:35.529068 [info ] [MainThread]: 
[0m02:44:35.529235 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 TOTAL=33
[0m02:44:35.529700 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.65214115, "process_user_time": 1.034743, "process_kernel_time": 0.11997, "process_mem_max_rss": "122908", "process_out_blocks": "4136", "process_in_blocks": "0"}
[0m02:44:35.529907 [debug] [MainThread]: Command `dbt test` succeeded at 02:44:35.529870 after 0.65 seconds
[0m02:44:35.530087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad8a1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d86cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d86c50>]}
[0m02:44:35.530366 [debug] [MainThread]: Flushing usage events
